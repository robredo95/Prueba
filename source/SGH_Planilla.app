.head 0 +  Application Description: Sistema de Gestion Hospitalaria - Módulo de Planilla
.head 1 -  Outline Version - 4.0.27
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400800000
0020: 0000000000F60000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFF000000 00000000008C0200 00E0010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730B6672
0080: 6D506572736F6E61 6C
.enddata
.data DT_MAKERUNDLG
0000: 0000000018433A5C 5347485C69636F6E 735C434C4F434B30 332E49434F1B433A
0020: 5C5347485C62696E 5C5347485F506C61 6E696C6C612E6578 651D433A5C534748
0040: 5C62696E5C636F6E 74726F6C5F6D6564 69636F2E646C6C1D 433A5C5347485C62
0060: 696E5C636F6E7472 6F6C5F6D65646963 6F2E617063000101 010131433A5C4365
0080: 6E747572615C696E 63656873615F6D65 6469636F5C617070 735C636F6E74726F
00A0: 6C5F6D656469636F 2E72756E31433A5C 43656E747572615C 696E63656873615F
00C0: 6D656469636F5C61 7070735C636F6E74 726F6C5F6D656469 636F2E646C6C3143
00E0: 3A5C43656E747572 615C696E63656873 615F6D656469636F 5C617070735C636F
0100: 6E74726F6C5F6D65 6469636F2E617063 000001010131433A 5C43656E74757261
0120: 5C696E6365687361 5F6D656469636F5C 617070735C636F6E 74726F6C5F6D6564
0140: 69636F2E61706431 433A5C43656E7475 72615C696E636568 73615F6D65646963
0160: 6F5C617070735C63 6F6E74726F6C5F6D 656469636F2E646C 6C31433A5C43656E
0180: 747572615C696E63 656873615F6D6564 69636F5C61707073 5C636F6E74726F6C
01A0: 5F6D656469636F2E 6170630000010101 31433A5C43656E74 7572615C696E6365
01C0: 6873615F6D656469 636F5C617070735C 636F6E74726F6C5F 6D656469636F2E61
01E0: 706C31433A5C4365 6E747572615C696E 63656873615F6D65 6469636F5C617070
0200: 735C636F6E74726F 6C5F6D656469636F 2E646C6C31433A5C 43656E747572615C
0220: 696E63656873615F 6D656469636F5C61 7070735C636F6E74 726F6C5F6D656469
0240: 636F2E6170630000 010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0038B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: Leitz.apl
.head 2 -  File Include: Pagelist.apl
.head 2 -  File Include: Qcktabs.apl
.head 2 -  File Include: qckdvc.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd/mm/yyyy
.head 3 -  Date/Time: dd/
.head 3 -  Number: ###000000
.head 3 -  Number: ###00000
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 2 -  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 4266152339
0000: 1E00000011000000 0000000000000000 02000001000000D1 000000E0010D0000
0020: 00FF3F
.enddata
.head 3 -  : AppConfig
.head 4 -  Class: lcConfiguration
.head 2 +  Internal Functions
.head 3 +  Function: costo_mayor
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: n1
.head 5 -  Number: n2
.head 5 -  Number: n3
.head 5 -  Number: n4
.head 5 -  Number: n5
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: mayor
.head 4 +  Actions
.head 5 -  Set mayor = n1
.head 5 +  If n2>=mayor
.head 6 -  Set mayor = n2
.head 5 +  If n3>=mayor
.head 6 -  Set mayor = n3
.head 5 +  If n4>=mayor
.head 6 -  Set mayor = n4
.head 5 +  If n5>=mayor
.head 6 -  Set mayor = n5
.head 5 -  Return mayor
.head 3 +  Function: GetIHSS
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: pSueldo
.head 5 -  String: pFormaPago
.head 5 -  Boolean: pEsQuincena
.head 5 -  Number: pTecho
.head 5 -  Number: pPorcentaje
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nIHSS
.head 5 -  Number: nSueldo
.head 4 +  Actions
.head 5 -  Set nSueldo = pSueldo
.head 5 +  If pSueldo >= pTecho
.head 6 -  Set nSueldo = pTecho
.head 5 +  If pFormaPago='MENSUAL'
.head 6 -  Set nIHSS = nSueldo * pPorcentaje
.head 5 +  Else
.head 6 +  If pEsQuincena = TRUE
.head 7 -  Set nIHSS = nSueldo * pPorcentaje
.head 6 +  Else
.head 7 -  Set nIHSS = 0
.head 5 -  Return nIHSS
.head 3 +  Function: NumToLetras
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nNum
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNumero
.head 5 -  String: sBillones
.head 5 -  String: sMilesMillones
.head 5 -  String: sMillones
.head 5 -  String: sMiles
.head 5 -  String: sCienes
.head 5 -  String: sCentavos
.head 5 -  String: sTemporal
.head 4 +  Actions
.head 5 -  Set sNumero=SalFmtFormatNumber( nNum, "000000000000000.00")
.head 5 -  Set sBillones=SalStrMidX( sNumero, 0, 3 )
.head 5 -  Set sMilesMillones=SalStrMidX( sNumero, 3, 3 )
.head 5 -  Set sMillones=SalStrMidX( sNumero, 6, 3 )
.head 5 -  Set sMiles=SalStrMidX( sNumero, 9, 3 )
.head 5 -  Set sCienes=SalStrMidX( sNumero, 12, 3 )
.head 5 -  Set sCentavos=SalStrMidX( sNumero, 16, 2 )
.head 5 -  Set sNumero=''
.head 5 -  ! Billones
.head 5 -  Set sTemporal=NumToLetras999( sBillones )
.head 5 +  If sTemporal!=""
.head 6 +  If sTemporal="UN"
.head 7 -  Set sNumero = sTemporal || " BILLON "
.head 6 +  Else
.head 7 -  Set sNumero = sTemporal || " BILLONES "
.head 5 -  ! Miles de Millones
.head 5 -  Set sTemporal=NumToLetras999( sMilesMillones )
.head 5 +  If sTemporal!=''
.head 6 +  If sTemporal="UN"
.head 7 -  Set sNumero = sNumero || " MIL "
.head 6 +  Else
.head 7 -  Set sNumero = sNumero || sTemporal || " MIL "
.head 6 +  If sMillones="000"
.head 7 -  Set sNumero = sNumero || " MILLONES "
.head 5 -  ! Millones
.head 5 -  Set sTemporal=NumToLetras999( sMillones )
.head 5 +  If sTemporal!=''
.head 6 +  If sTemporal="UN"
.head 7 -  Set sNumero = sNumero || sTemporal || " MILLON "
.head 6 +  Else
.head 7 -  Set sNumero = sNumero || sTemporal || " MILLONES "
.head 5 -  ! Miles
.head 5 -  Set sTemporal=NumToLetras999( sMiles )
.head 5 +  If sTemporal!=''
.head 6 +  If sTemporal="UN"
.head 7 -  Set sNumero = sNumero ||  " MIL "
.head 6 +  Else
.head 7 -  Set sNumero = sNumero || sTemporal || " MIL "
.head 5 -  ! Cienes
.head 5 -  Set sTemporal=NumToLetras999( sCienes )
.head 5 +  If sTemporal!=''
.head 6 -  Set sNumero = sNumero ||  sTemporal
.head 5 +  If sNumero = "UN"
.head 6 -  Set sNumero = sNumero || " LEMPIRA"
.head 5 +  Else
.head 6 -  Set sNumero = sNumero || " LEMPIRAS"
.head 5 +  If sCentavos="00"
.head 6 -  Set sNumero= sNumero || " EXACTOS"
.head 5 +  Else
.head 6 -  Set sTemporal=NumToLetras999( '0' || sCentavos )
.head 6 +  If sTemporal="UN"
.head 7 -  Set sNumero= sNumero || " CON " || sTemporal || " CENTAVO"
.head 6 +  Else
.head 7 -  Set sNumero= sNumero || " CON " || sTemporal || " CENTAVOS"
.head 5 -  Return sNumero
.head 3 +  Function: NumToLetras999
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sNum
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nNumero
.head 5 -  String: sTemporal
.head 4 +  Actions
.head 5 -  Set sTemporal=''
.head 5 +  If sNum="000"
.head 6 -  Return ""
.head 5 +  Else
.head 6 +  If SalStrLength( sNum )=1
.head 7 -  Set nNumero=SalStrToNumber(sNum)
.head 7 +  Select Case nNumero
.head 8 -  Case 0
.head 8 +  Case 1
.head 9 -  Return "UN"
.head 8 +  Case 2
.head 9 -  Return "DOS"
.head 8 +  Case 3
.head 9 -  Return "TRES"
.head 8 +  Case 4
.head 9 -  Return "CUATRO"
.head 8 +  Case 5
.head 9 -  Return "CINCO"
.head 8 +  Case 6
.head 9 -  Return "SEIS"
.head 8 +  Case 7
.head 9 -  Return "SIETE"
.head 8 +  Case 8
.head 9 -  Return "OCHO"
.head 8 +  Case 9
.head 9 -  Return "NUEVE"
.head 5 -  Set nNumero=SalStrToNumber( SalStrMidX( sNum, 0, 1 ))
.head 5 +  Select Case nNumero
.head 6 +  Case 0
.head 7 -  Set sTemporal=sTemporal
.head 7 -  Break
.head 6 +  Case 1
.head 7 +  If SalStrMidX( sNum, 1, 2 )="00"
.head 8 -  Set sTemporal="CIEN"
.head 7 +  Else
.head 8 -  Set sTemporal="CIENTO "
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set sTemporal="DOSCIENTOS "
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Set sTemporal="TRESCIENTOS "
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  Set sTemporal="CUATROCIENTOS "
.head 7 -  Break
.head 6 +  Case 5
.head 7 -  Set sTemporal="QUINIENTOS "
.head 7 -  Break
.head 6 +  Case 6
.head 7 -  Set sTemporal="SEISCIENTOS "
.head 7 -  Break
.head 6 +  Case 7
.head 7 -  Set sTemporal="SETECIENTOS "
.head 7 -  Break
.head 6 +  Case 8
.head 7 -  Set sTemporal="OCHOCIENTOS "
.head 7 -  Break
.head 6 +  Case 9
.head 7 -  Set sTemporal="NOVECIENTOS "
.head 7 -  Break
.head 5 +  If SalStrMidX( sNum, 1, 2 ) ="00"
.head 6 -  Return sTemporal
.head 5 -  Set nNumero=SalStrToNumber( SalStrMidX( sNum, 1, 2 ))
.head 5 +  Select Case nNumero
.head 6 -  Case 0
.head 6 -  Case 1
.head 6 -  Case 2
.head 6 -  Case 3
.head 6 -  Case 4
.head 6 -  Case 5
.head 6 -  Case 6
.head 6 -  Case 7
.head 6 -  Case 8
.head 6 +  Case 9
.head 7 -  Set sTemporal=sTemporal  || NumToLetras999( SalStrMidX( sNum, 2, 2 ) )
.head 7 -  Return sTemporal
.head 6 +  Case 10
.head 7 -  Return (sTemporal || " DIEZ")
.head 6 +  Case 11
.head 7 -  Return (sTemporal || " ONCE")
.head 6 +  Case 12
.head 7 -  Return (sTemporal || " DOCE")
.head 6 +  Case 13
.head 7 -  Return (sTemporal || " TRECE")
.head 6 +  Case 14
.head 7 -  Return (sTemporal || " CATORCE")
.head 6 +  Case 15
.head 7 -  Return (sTemporal || " QUINCE")
.head 6 -  Case 16
.head 6 -  Case 17
.head 6 -  Case 18
.head 6 +  Case 19
.head 7 -  Set sTemporal=sTemporal || " DIECI" || NumToLetras999( SalStrMidX( sNum, 2, 2 ) )
.head 7 -  Return sTemporal
.head 6 +  Case 20
.head 7 -  Return (sTemporal || "  VEINTE" )
.head 6 +  Case 30
.head 7 -  Return (sTemporal || "  TREINTA" )
.head 6 +  Case 40
.head 7 -  Return (sTemporal || "  CUARENTA" )
.head 6 +  Case 50
.head 7 -  Return (sTemporal || "  CINCUENTA" )
.head 6 +  Case 60
.head 7 -  Return (sTemporal || "  SESENTA" )
.head 6 +  Case 70
.head 7 -  Return (sTemporal || "  SETENTA" )
.head 6 +  Case 80
.head 7 -  Return (sTemporal || "  OCHENTA" )
.head 6 +  Case 90
.head 7 -  Return (sTemporal || "  NOVENTA" )
.head 5 -  Set nNumero=SalStrToNumber( SalStrMidX( sNum, 1, 1 ))
.head 5 +  Select Case nNumero
.head 6 +  Case 2
.head 7 -  Set sTemporal=sTemporal || " VEINTI" || NumToLetras999( SalStrMidX( sNum, 2, 2 ) )
.head 7 -  Return sTemporal
.head 6 +  Case 3
.head 7 -  Set sTemporal=sTemporal || " TREINTA Y " || NumToLetras999( SalStrMidX( sNum, 2, 2 ) )
.head 7 -  Return sTemporal
.head 6 +  Case 4
.head 7 -  Set sTemporal=sTemporal || " CUARENTA Y " || NumToLetras999( SalStrMidX( sNum, 2, 2 ) )
.head 7 -  Return sTemporal
.head 6 +  Case 5
.head 7 -  Set sTemporal=sTemporal || " CINCUENTA Y " || NumToLetras999( SalStrMidX( sNum, 2, 2 ) )
.head 7 -  Return sTemporal
.head 6 +  Case 6
.head 7 -  Set sTemporal=sTemporal || " SESENTA Y " || NumToLetras999( SalStrMidX( sNum, 2, 2 ) )
.head 7 -  Return sTemporal
.head 6 +  Case 7
.head 7 -  Set sTemporal=sTemporal || " SETENTA Y " || NumToLetras999( SalStrMidX( sNum, 2, 2 ) )
.head 7 -  Return sTemporal
.head 6 +  Case 8
.head 7 -  Set sTemporal=sTemporal || " OCHENTA Y " || NumToLetras999( SalStrMidX( sNum, 2, 2 ) )
.head 7 -  Return sTemporal
.head 6 +  Case 9
.head 7 -  Set sTemporal=sTemporal || " NOVENTA Y " || NumToLetras999( SalStrMidX( sNum, 2, 2 ) )
.head 7 -  Return sTemporal
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 2801688929
0000: 730500009F020000 0000000000000000 0200000C00FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F15003C00 000E63006D62436F
0040: 6E63617400656E61 646F5A0000E00003 000000C102040000 00FF7F0472000002
0060: 00F0010000000F80 010000FE00010800 0000010D00FC0000 FF8701800D000800
0080: 010000077062004D 656E6F731E0000EC 000100D9010D00FF 7F01088015000002
00A0: 0000100015636D42 61730065436F6469 676F4640696C7472 616452B000000003
00C0: 0067020400FFFF8D 0400010DFD00FF07 1100000002F700FF 1F01801533000300
00E0: 19FC636DFF1F4368 61C87252000003DE 0002FD00FF370400 01F60D00FFDF11DC
0100: 000200FF7F01CC80 150004000013636C 73436243FFDF52EC 000300D9010D00FF
0120: 7F0D7200000200FF FFCD110002FD00FF C701800D00000500 0000127062004368
0140: 426F727261720043 6869717569746F44 1E0000010000CF01 0DFE00FF43018004
0160: 000000060000000D 66726D00536F6C6F 4E6F6D621072651E 000001003D000304
0180: FA0000FF8F018015 0100070000000D63 FA6D426F5200F403 0000EE0200FFBF04
01A0: B100010D00FFFFE6 110002FE00FF6301 8015008608000B63 6CF76F67000300CF
01C0: 010DFE00FF930D00 0002FB00FF6F1100 EE0200FF3F018000 6100000009000000
01E0: 000B5F5F4572726F 728C4261560100F6 0D00EC010D00FFBF 0DB9000100FFFFE0
0200: 1A00000001FE00FF 832700000001FB00 FF0F34000000EE02 00FF3F3800B80000
0220: 0200FFFFE03C0000 0002FE00FF034000 00000304FB00FF0F 44000000EE0200FF
0240: 3F4800B800000200 FFFFE04C00000003 FE00FF8350000000 03FB00FF0F540000
0260: 00EE0100FF3F0180 060D000A00000000 065F5F466C61671E A200000100006701
0280: 0D00FFFF2101801A 00000B000000000B 6351756900636B54 61626C6538A20000
02A0: 02000067010D00FF FFCD0D0001FD00FF 07
.enddata
.head 3 +  Combo Box Class: cmbConcatenado
.head 4 -  Window Location and Size
.head 5 -  Left:  
.head 5 -  Top:   
.head 5 -  Width:  4.917"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 2.429"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Clase generica usada concatenar
dos campos de una tabla ejemplo:
CUENTA CONTABLE y la DESCRIPCION así:
COD_CUENTA||DESCRIPCION

Cuando se elige un valor del combo box, este es
guardado en la instancia	sCodigos
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  !
.head 5 -  String: sComboActual
.head 5 -  String: sArreglo[*]
.head 5 -  Number: nArreglo
.head 5 -  !
.head 4 +  Instance Variables
.head 5 -  !
.head 5 -  String: sTabla
.head 5 -  String: sCodigo1
.head 5 -  String: sCodigo2
.head 5 -  !
.head 5 -  ! este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 5 -  !
.head 4 -  Functions
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 -  !
.head 5 -  !
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sCodigo1||","||
sCodigo2||" from "||sTabla)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_Validate
.head 6 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 7 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 7 -  Call SalSetFocus(hWndItem)
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Return TRUE
.head 5 +  On SAM_Click
.head 6 -  !
.head 6 -  Set nArreglo=SalStrTokenize(MyValue,'','	',sArreglo)
.head 6 +  If nArreglo=0
.head 7 -  Set sCodigos=''
.head 6 +  Else
.head 7 +  If nCaso=1
.head 8 -  Set nCodigo=SalStrToNumber(sArreglo[0])
.head 7 +  Else
.head 8 -  Set sCodigos=sArreglo[0]
.head 6 -  !
.head 6 -  Call SalSendMsg(hWndItem,SAM_Validate,0,0)
.head 5 -  !
.head 5 -  !
.head 3 +  Functional Class: c_empleados
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: cod_empleado
.head 5 -  Number: sueldo
.head 5 -  Date/Time: fecha_ingreso
.head 4 -  Functions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field: dfNumero
.head 3 -  Spin Field:
.head 3 -  Multiline Field: mlBase
.head 3 -  Pushbutton: pbBase
.head 3 -  Radio Button: cQuickRadio
.head 3 -  Option Button:
.head 3 -  ActiveX:
.head 3 -  Check Box:
.head 3 -  Child Table: cFlatChildTable
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box: clsList
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column: clsDatos
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cQuickGraph
.head 2 +  Application Actions
.head 3 +  On SAM_AppStartup
.head 4 -  Call AppConfig.LoadConfiguration()
.head 4 +  If SalModalDialog( dlgLogin,hWndNULL,sGlobalDB)
.head 5 -  Call CargarSeguridad(sNombreUsuario,bArraySeg,'derechos_planilla')
.head 5 -  Set nBaseEs=31
.head 5 -  Call SalCreateWindow(frmPrincipal,hWndNULL)
.head 3 +  ! On SAM_SqlError
.head 4 -  Call ProcesarErrorMSQ(  )
.head 4 -  Return FALSE
.head 1 -  !
.head 1 -  !
.head 1 +  Form Window: frmMedicos
.head 2 -  Class: frmSoloNombre
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.225"
.head 4 -  Top:    0.292"
.head 4 -  Width:  10.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.857"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.5"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pbAgregar
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbBorrar
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbGrabar
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSalir
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.583"
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 5
.head 4 -  Class ChildKey: 0
.head 4 -  Class: frmSoloNombre
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  9.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCodigor
.head 6 -  Class Child Ref Key: 25
.head 6 -  Class ChildKey: 0
.head 6 -  Class: frmSoloNombre
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNombrer
.head 6 -  Class Child Ref Key: 26
.head 6 -  Class ChildKey: 0
.head 6 -  Class: frmSoloNombre
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  5.183"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cmbEspecialidad
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsCbCodigo
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Especialidad
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.35"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set cmbEspecialidad.nCaso=1
.head 8 -  Set cmbEspecialidad.sTabla='ESPECIALIDAD'
.head 8 -  Set cmbEspecialidad.sNombre='NOMBRE'
.head 8 -  Set cmbEspecialidad.sCodigo='COD_ESPECIALIDAD'
.head 5 +  Column: colCod
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On MU_REVISAR
.head 8 -  Return TRUE
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete
.head 6 -  Set frmMedicos.sTitulos='Medicos'
.head 6 -  Call SalSendClassMessage(SAM_CreateComplete,0,0)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Set sTabla='MEDICOS'
.head 4 -  Set sNombre='NOMBRE'
.head 4 -  Set sCodigo='COD_MEDICO'
.head 4 -  Set nNumeroTabla=4
.head 4 -  Set hWndTabla=tbl1
.head 4 -  Set sMensajes_Otros='Medico ya Existe'
.head 4 -  !
.head 3 +  On MU_GRABAR
.head 4 -  ! Call SalSendClassMessage( MU_GRABAR, 0, 0 )
.head 4 -  Call SalSetFocus(tbl1)
.head 4 -  Call SqlPrepare(hSql1,"insert into medicos (COD_MEDICO,NOMBRE,COD_ESPECIALIDAD)
		values(:tbl1.colCodigor,:tbl1.colNombrer,:tbl1.cmbEspecialidad.nCodigo)")
.head 4 -  Call SalTblDoInserts( tbl1,hSql1,TRUE)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SqlPrepare(hSql1,"update medicos set  nombre=:tbl1.colNombrer, cod_especialidad=:tbl1.cmbEspecialidad.nCodigo
			where cod_medico=:tbl1.colCodigor")
.head 4 -  Call SalTblDoUpdates( tbl1,hSql1,TRUE)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SqlPrepare(hSql1,"delete from medicos  where cod_medico =:tbl1.colCodigor")
.head 4 -  Call SalTblDoDeletes( tbl1,hSql1,ROW_MarkDeleted)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 3 +  On MU_ACTUALIZAR
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblPopulate(tbl1,hSql1,"select A.cod_medico ,A.nombre , B.NOMBRE,B.cod_especialidad
from medicos A, ESPECIALIDAD B where A.COD_ESPECIALIDAD=B.COD_ESPECIALIDAD
order by A.NOMBRE",TBL_FillAll)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg( hWndForm, MU_ACTUALIZAR, 0, 0 )
.head 1 +  Form Window: frmOcupaciones
.head 2 -  Class: frmSoloNombre
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ocupaciones
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.85"
.head 4 -  Top:    0.49"
.head 4 -  Width:  8.783"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.024"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.512"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pbAgregar
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbBorrar
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbGrabar
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSalir
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 5
.head 4 -  Class ChildKey: 0
.head 4 -  Class: frmSoloNombre
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  8.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 500
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCodigor
.head 6 -  Class Child Ref Key: 25
.head 6 -  Class ChildKey: 0
.head 6 -  Class: frmSoloNombre
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Yes
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNombrer
.head 6 -  Class Child Ref Key: 26
.head 6 -  Class ChildKey: 0
.head 6 -  Class: frmSoloNombre
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  5.583"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete
.head 6 -  Set frmOcupaciones.sTitulos='Tipos de Ocupaciones'
.head 6 -  Call SalSendClassMessage(SAM_CreateComplete,0,0)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Set sTabla='OCUPACIONES'
.head 4 -  Set sNombre='NOMBRE'
.head 4 -  Set sCodigo='COD_OCUPACION'
.head 4 -  Set nNumeroTabla=32
.head 4 -  Set hWndTabla=tbl1
.head 4 -  Set sMensajes_Otros='Ocupación ya Existe'
.head 4 -  !
.head 3 +  ! On MU_GRABAR
.head 4 -  Call SalSendClassMessage( MU_GRABAR, 0, 0 )
.head 3 +  ! On MU_ACTUALIZAR
.head 4 -  Call SalSendClassMessage( MU_ACTUALIZAR, 0, 0 )
.head 1 +  ! Form Window: frmSalidas
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Mantenimiento de Salida de Medicamentos
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    0.688"
.head 4 -  Width:  8.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.071"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -    Description: 
.head 2 -    Named Menus 
.head 2 +    Menu 
.head 3 +    Popup Menu: Tablita
.head 4 -    Enabled when: 
.head 4 -    Status Text: 
.head 4 -    Menu Item Name: 
.head 4 +    Menu Item: (Inserta Fila)
.head 5 -    Keyboard Accelerator: Ins
.head 5 -    Status Text: 
.head 5 +    Menu Settings 
.head 6 -    Enabled when: 
.head 6 -    Checked when: 
.head 5 +    Menu Actions 
.head 6 -    Call SalSendMsg(pbAgregar,SAM_Click,0,0)
.head 5 -    Menu Item Name: 
.head 4 +    Menu Item: (Marca para Borrar Fila)
.head 5 -    Keyboard Accelerator: -
.head 5 -    Status Text: 
.head 5 +    Menu Settings 
.head 6 -    Enabled when: 
.head 6 -    Checked when: 
.head 5 +    Menu Actions 
.head 6 -    Call SalSendMsg(pbBorrar,SAM_Click,0,0)
.head 5 -    Menu Item Name: 
.head 2 +    Tool Bar 
.head 3 +    Contents 
.head 4 +    Pushbutton: pb1
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pb2
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -    Set pb2.nOpcionh=1
.head 7 -    Set pb2.hWndCampo=dfCodigo
.head 6 +    On SAM_Click
.head 7 -    Call SalSendClassMessage(SAM_Click,0,0)
.head 7 -    Call SalEnableWindow(pb4)
.head 7 -    Set dfFechaIngreso=FechaHoy(1)
.head 7 -    Call SalDisableWindow(dfCant)
.head 7 -    Call SalDisableWindow(dfCosto)
.head 7 -    Call SalDisableWindow(dfTotalSalida)
.head 7 -    Set cmbBodega.nCodigo=1
.head 7 -    Call cmbBodega.Actualizar()
.head 4 +    Pushbutton: pb3
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -    Set pb3.nOpcionh=1
.head 7 -    Set pb3.sTitulo=' La Salida'
.head 4 +    Pushbutton: pb4
.head 5 +    Message Actions 
.head 6 +    On SAM_Create
.head 7 -    Set pb4.nOpcion=3
.head 7 -    Set pb4.sTitulo=' La Salida'
.head 7 -    Set pb4.hWndTabla=tbl1
.head 4 +    Pushbutton: pb5
.head 5 +    Message Actions 
.head 6 +    On SAM_Click
.head 7 -    Set sRegresa=''
.head 7 -    Call SalModalDialog( dlgConsultaSalida, hWndForm,2,sRegresa )
.head 7 +    If sRegresa!=''
.head 8 -    Set dfCodigo=sRegresa
.head 8 -    Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 2 +    Contents 
.head 3 -    Background Text: # Salida
.head 3 +    Data Field: dfCodigo
.head 4 +    Message Actions 
.head 5 +    On SAM_Validate
.head 6 -    Call SqlExists("Select	COD_SALIDA
from	SALIDA_MEDI
where	COD_SALIDA=:dfCodigo",bExists)
.head 6 +    If bExists
.head 7 -    Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 7 -    Call SalEnableWindow(pb4)
.head 7 -  ! Call SalDisableWindow(dfFechaIngreso)
.head 3 -    Background Text: Fecha Salida
.head 3 +    Data Field: dfFechaIngreso
.head 4 -    Message Actions 
.head 3 -    Background Text: Bodega
.head 3 +    Combo Box: cmbBodega
.head 4 -    List Initialization 
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 -    Set cmbBodega.nCaso=1
.head 6 -    Set cmbBodega.sTabla='BODEGAS'
.head 6 -    Set cmbBodega.sNombre='NOMBRE'
.head 6 -    Set cmbBodega.sCodigo='COD_BODEGA'
.head 3 -    Background Text: Medicamentos
.head 3 +    Child Table: tbl1
.head 4 +    Contents 
.head 5 +    Column: colUnico
.head 6 -    List Values 
.head 6 -    Message Actions 
.head 5 +    Column: colCodigo
.head 6 -    List Values 
.head 6 +    Message Actions 
.head 7 +    On SAM_Validate
.head 8 -    Call SqlExists("select	DESP,COSTO
from	MEDICAMENTOS
where	COD_MEDICAMENTO=:tbl1.colCodigo
into	:tbl1.colMedicamento,:tbl1.colCosto",bExists)
.head 8 -    Call SqlClearImmediate()
.head 8 +    If not bExists
.head 9 -    Call SalMessageBox("Medicamento no existe","ERROR",MB_Ok)
.head 9 -    Set tbl1.colMedicamento=''
.head 9 -    Set tbl1.colCodigo=''
.head 8 +    Else 
.head 9 -    Call SqlImmediate("select	B.NOMBRE
from	MEDICAMENTOS A,TIPOS_PRESEN B
where	A.COD_MEDICAMENTO=:tbl1.colCodigo	and
	B.COD_PRESEN=A.COD_PRESEN
into	:tbl1.colUnidad")
.head 9 -    Call SqlClearImmediate()
.head 5 +    Column: colMedicamento
.head 6 -    List Values 
.head 6 +    Message Actions 
.head 7 +    On SAM_Create
.head 8 -    Set colMedicamento.nCaso=2
.head 8 -    Set colMedicamento.sTabla='MEDICAMENTOS'
.head 8 -    Set colMedicamento.sNombre='DESP'
.head 8 -    Set colMedicamento.sCodigo='COD_MEDICAMENTO'
.head 7 +    On SAM_Validate
.head 8 -    Set tbl1.colCodigo=''
.head 8 +    If SalSendClassMessage(SAM_Validate,0,0)
.head 9 -    Set tbl1.colCodigo=tbl1.colMedicamento.sCodigos
.head 9 -    Call SqlImmediate("select	B.NOMBRE,A.COSTO
from	MEDICAMENTOS A,TIPOS_PRESEN B
where	A.COD_MEDICAMENTO=:tbl1.colCodigo	and
	B.COD_PRESEN=A.COD_PRESEN
into	:tbl1.colUnidad,:tbl1.colCosto")
.head 9 -    Call SqlClearImmediate()
.head 5 +    Column: colUnidad
.head 6 -    List Values 
.head 6 -    Message Actions 
.head 5 +    Column: colCant
.head 6 -    List Values 
.head 6 +    Message Actions 
.head 7 +    On SAM_Validate
.head 8 -    Call SqlImmediate("select	EXISTENCIA
from	MEDICAMENTOS
where	COD_MEDICAMENTO=:tbl1.colCodigo
into	:nFila")
.head 8 -    Call SqlClearImmediate()
.head 8 +    If nFila<tbl1.colCant
.head 9 -    Call SalMessageBox("Cantidad a sacar excede la existencia en inventario que es de "||
SalNumberToStrX(nFila,0),"ERROR",MB_Ok)
.head 9 -    Set tbl1.colCant=NUMBER_Null
.head 8 -    Set tbl1.colSubTotal=tbl1.colCant*tbl1.colCosto
.head 8 -    Set dfCant=SalTblColumnSum(tbl1,5,0,0)
.head 8 -    Set dfCosto=SalTblColumnSum(tbl1,6,0,0)
.head 8 -    Set dfTotalSalida=dfCant*dfCosto
.head 5 +    Column: colCosto
.head 6 -    List Values 
.head 6 +    Message Actions 
.head 7 +    On SAM_Validate
.head 8 -    Set dfCant=SalTblColumnSum(tbl1,5,0,0)
.head 8 -    Set dfCosto=SalTblColumnSum(tbl1,6,0,0)
.head 8 -    Set dfTotalSalida=dfCant*dfCosto
.head 5 +    Column: colDestino
.head 6 -    List Values 
.head 6 +    Message Actions 
.head 7 +    On SAM_Create
.head 8 -    Set colDestino.nCaso=2
.head 8 -    Set colDestino.sTabla='DESTINOS'
.head 8 -    Set colDestino.sNombre='NOMBRE'
.head 8 -    Set colDestino.sCodigo='COD_DESTINO'
.head 5 +    Column: colSubTotal
.head 6 -    List Values 
.head 6 +    Message Actions 
.head 7 +    On MU_REVISAR
.head 8 -    Return TRUE
.head 4 -    Functions 
.head 4 -    Window Variables 
.head 4 -    Message Actions 
.head 3 +    Pushbutton: pbAgregar
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 -    Set pbAgregar.hWndFila=tbl1.colCodigo
.head 6 -    Set pbAgregar.hWndTabla=tbl1
.head 5 +    On SAM_Click
.head 6 -    Call SalSendClassMessage(SAM_Click,0,0)
.head 6 -    Set tbl1.colUnico=Identity(15)
.head 3 +    Pushbutton: pbBorrar
.head 4 +    Message Actions 
.head 5 +    On SAM_Create
.head 6 -    Set pbBorrar.hWndFila=tbl1.colCodigo
.head 6 -    Set pbBorrar.hWndTabla=tbl1
.head 3 -    Background Text: Totales ==>
.head 3 +    Data Field: dfCant
.head 4 +    Message Actions 
.head 5 +    On MU_REVISAR
.head 6 -    Return TRUE
.head 3 +    Data Field: dfCosto
.head 4 +    Message Actions 
.head 5 +    On MU_REVISAR
.head 6 -    Return TRUE
.head 3 -    Background Text: Observaciones
.head 3 +    Multiline Field: ml1
.head 4 +    Message Actions 
.head 5 +    On MU_REVISAR
.head 6 -    Return TRUE
.head 3 +    Data Field: dfTotalSalida
.head 4 +    Message Actions 
.head 5 +    On MU_REVISAR
.head 6 -    Return TRUE
.head 2 +    Functions 
.head 3 +    Function: ActualizaExistencias
.head 4 -    Description: 
.head 4 -    Returns 
.head 4 +    Parameters 
.head 5 -    Number: nCaso
.head 4 -    Static Variables 
.head 4 -    Local variables 
.head 4 +    Actions 
.head 5 -    Set nFila=-1
.head 5 +    While SalTblFindNextRow(tbl1,nFila,0,0)
.head 6 -    Call SalTblSetContext(tbl1,nFila)
.head 6 +    If tbl1.colCant!=NUMBER_Null and tbl1.colCant>0
.head 7 +    If nCaso=1
.head 8 +    If SalTblQueryRowFlags(tbl1,nFila,ROW_New)
.head 9 +    If not	SqlPrepareAndExecute(hSql1,"
update	MEDICAMENTOS
	set	EXISTENCIA=
		EXISTENCIA	-	:tbl1.colCant
where	COD_MEDICAMENTO=:tbl1.colCodigo")
.head 10 -    Return FALSE
.head 7 +    Else 
.head 8 +    If SalTblQueryRowFlags(tbl1,nFila,ROW_MarkDeleted)
.head 9 +    If not	SqlPrepareAndExecute(hSql1,"
update	MEDICAMENTOS
	set	EXISTENCIA=
		EXISTENCIA	+	:tbl1.colCant
where	COD_MEDICAMENTO=:tbl1.colCodigo")
.head 10 -    Return FALSE
.head 5 -    Return TRUE
.head 2 -    Window Parameters 
.head 2 +    Window Variables 
.head 3 -    String: sRegresa
.head 2 +    Message Actions 
.head 3 +    On SAM_CreateComplete
.head 4 -    Call DeshabilitarTodo(  )
.head 4 -    Call SalDisableWindow(pb4)
.head 4 -    Set dfFechaIngreso=FechaHoy(1)
.head 3 +    On MU_ACTUALIZAR
.head 4 -    Call SalWaitCursor(TRUE)
.head 4 -    Call SqlPrepareAndExecute(hSql1,"
select	COD_BODEGA,FECHA,OBS
from	SALIDA_MEDI
where	COD_SALIDA=:dfCodigo
into	:cmbBodega.nCodigo,:dfFechaIngreso,:ml1")
.head 4 -    Call SqlFetchNext(hSql1,nSiguiente)
.head 4 -    Call cmbBodega.Actualizar()
.head 4 -  !
.head 4 -    Call SalTblPopulate(tbl1,hSql1,"
select	A.COD_VARIA,A.COD_MEDICAMENTO,
	B.DESP,C.NOMBRE,A.CANT,A.COSTO,A.CANT*A.COSTO
from	VARIAS_SALIDAS	A,MEDICAMENTOS B,TIPOS_PRESEN C
where	A.COD_SALIDA=:dfCodigo	and
	B.COD_MEDICAMENTO=A.COD_MEDICAMENTO and
	C.COD_PRESEN=B.COD_PRESEN",TBL_FillAll)
.head 4 -  !
.head 4 -    Call DeshabilitarTodo(  )
.head 4 -    Call SalEnableWindow(tbl1)
.head 4 -    Call SalWaitCursor(FALSE)
.head 4 -    Set dfCant=SalTblColumnSum(tbl1,5,0,0)
.head 4 -    Set dfCosto=SalTblColumnSum(tbl1,6,0,0)
.head 4 -    Set dfTotalSalida=dfCant*dfCosto
.head 4 -    Call SalDisableWindow(dfCant)
.head 4 -    Call SalDisableWindow(dfCosto)
.head 4 -    Call SalDisableWindow(dfTotalSalida)
.head 4 -  !
.head 4 -    Call SalEnableWindow(pbBorrar)
.head 4 -    Call SalEnableWindow(pbAgregar)
.head 4 -    Call SalEnableWindow(pb4)
.head 4 -  !
.head 3 +    On MU_BORRAR
.head 4 +    If not	ActualizaExistencias(2)	or


not	SqlPrepare(hSql1,"delete from	
	VARIAS_SALIDAS
	where	COD_SALIDA=:dfCodigo")	or

not	SqlPrepareAndExecute(hSql1,"
	delete from	SALIDA_MEDI
	where	COD_SALIDA=:dfCodigo")
.head 5 -    Call SqlPrepareAndExecute(hSql1,"rollback")
.head 4 +    Else 
.head 5 -    Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -    Call SalEnableWindow(pb4)
.head 3 +    On MU_GRABAR
.head 4 -    Call SqlExists("select	COD_SALIDA from SALIDA_MEDI
where	COD_SALIDA=:dfCodigo",bExists)	
.head 4 +    If not bExists
.head 5 +    If not SqlPrepareAndExecute(hSql1,"
insert into	SALIDA_MEDI(COD_SALIDA,COD_BODEGA,FECHA,OBS)
values(:dfCodigo,:cmbBodega.nCodigo,:dfFechaIngreso,:ml1)")	or

not 	ActualizaExistencias(1)	or

not	SqlPrepare(hSql1,"insert into	
VARIAS_SALIDAS(COD_VARIA,COD_MEDICAMENTO,COD_SALIDA,CANT,COSTO)
values(:tbl1.colUnico,:tbl1.colCodigo,:dfCodigo,:tbl1.colCant,:tbl1.colCosto)")	or

not	SalTblDoInserts(tbl1,hSql1,TRUE)

.head 6 -    Call SqlPrepareAndExecute(hSql1,"rollback")
.head 5 +    Else 
.head 6 -    Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -    Call SalDisableWindow(pb4)
.head 4 +    Else 
.head 5 +    If 
not 	ActualizaExistencias(1)	or

not	SqlPrepare(hSql1,"insert into	
VARIAS_SALIDAS(COD_VARIA,COD_MEDICAMENTO,COD_SALIDA,CANT,COSTO)
values(:tbl1.colUnico,:tbl1.colCodigo,:dfCodigo,:tbl1.colCant,:tbl1.colCosto)")	or

not	SalTblDoInserts(tbl1,hSql1,TRUE)	or




not	ActualizaExistencias(2)	or
not	SqlPrepare(hSql1,"delete from	
	VARIAS_SALIDAS
	where	COD_VARIA=:tbl1.colUnico") or
not	SalTblDoDeletes(tbl1,hSql1,ROW_MarkDeleted)

.head 6 -    Call SqlPrepareAndExecute(hSql1,"rollback")
.head 5 +    Else 
.head 6 -    Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -    Call SalDisableWindow(pb4)
.head 1 -  !
.head 1 -  !
.head 1 +  Form Window: frmConsultas
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Consultas del Sistema
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.867"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.071"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: Consultas
.head 4 -  Resource Id: 1757
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  ! Menu Item: Listado de Atenciones Medicas
.head 5 -    Keyboard Accelerator: (none)
.head 5 -    Status Text: 
.head 5 +    Menu Settings 
.head 6 -    Enabled when: bArraySeg[5]
.head 6 -    Checked when: 
.head 5 +    Menu Actions 
.head 6 -    Call SalModalDialog( dlgConsultaAtencion, hWndForm,1,sRegresa )
.head 5 -    Menu Item Name: 
.head 4 +  ! Menu Item: Morbilidad por Doctores
.head 5 -    Keyboard Accelerator: (none)
.head 5 -    Status Text: 
.head 5 +    Menu Settings 
.head 6 -    Enabled when: 
.head 6 -    Checked when: 
.head 5 +    Menu Actions 
.head 6 -    Call SalModalDialog( dlgConsultaMorbiDoc, hWndForm )
.head 5 -    Menu Item Name: 
.head 4 +  ! Menu Item: Morbilidad por Deptos
.head 5 -    Keyboard Accelerator: (none)
.head 5 -    Status Text: 
.head 5 +    Menu Settings 
.head 6 -    Enabled when: 
.head 6 -    Checked when: 
.head 5 +    Menu Actions 
.head 6 -    Call SalModalDialog( dlgConsultaMorbiDepto, hWndForm )
.head 5 -    Menu Item Name: 
.head 4 +  ! Menu Item: Incapacitados/Hospitalizado por Depto
.head 5 -    Keyboard Accelerator: (none)
.head 5 -    Status Text: 
.head 5 +    Menu Settings 
.head 6 -    Enabled when: bArraySeg[6]
.head 6 -    Checked when: 
.head 5 +    Menu Actions 
.head 6 -    Call SalModalDialog( dlgConsultaIncap, hWndForm )
.head 5 -    Menu Item Name: 
.head 4 +  ! Menu Item: Morbilidad Totales
.head 5 -    Keyboard Accelerator: (none)
.head 5 -    Status Text: 
.head 5 +    Menu Settings 
.head 6 -    Enabled when: bArraySeg[7]
.head 6 -    Checked when: 
.head 5 +    Menu Actions 
.head 6 -    Call SalModalDialog( dlgConsultaMorbilidadTot, hWndForm )
.head 5 -    Menu Item Name: 
.head 4 +  ! Menu Item: Consultas por Doctores
.head 5 -    Keyboard Accelerator: (none)
.head 5 -    Status Text: 
.head 5 +    Menu Settings 
.head 6 -    Enabled when: bArraySeg[8]
.head 6 -    Checked when: 
.head 5 +    Menu Actions 
.head 6 -    Call SalModalDialog( dlgConsultaDoctores, hWndForm )
.head 5 -    Menu Item Name: 
.head 4 +  Menu Item: Listado de  Medicamentos
.head 5 -  Resource Id: 1760
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: bArraySeg[11]
.head 6 -  Checked when:
.head 5 -  Menu Actions
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Movimientos de  Medicamentos
.head 5 -  Resource Id: 1761
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: bArraySeg[11]
.head 6 -  Checked when:
.head 5 -  Menu Actions
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Listado de SubGrupos
.head 5 -  Resource Id: 1763
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 -  Menu Actions
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Listado de Proveedores
.head 5 -  Resource Id: 1764
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalCreateWindow( frmImprimir, hWndForm,
"Listado de Proveedores",
strRepPath || "\\GRUPOS.QRP",
":n1,:s1",
" A.COD_GRUPO,A.NOMBRE",
"select A.COD_GRUPO,A.NOMBRE from GRUPOS_MED A	
into
:n1,:s1"," ",FALSE)
.head 5 -  Menu Item Name:
.head 3 +  Popup Menu: Reportes
.head 4 -  Resource Id: 1765
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Popup Menu: Pacientes de Maquilas
.head 5 -  Resource Id: 1766
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.56"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 -  Contents
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sRegresa
.head 3 -  Number: nRegresa2
.head 3 -  Number: nRegresa3
.head 2 -  Message Actions
.head 1 -  !
.head 1 +  ! frmSoloNombre: frmDestinos
.winattr class Form Window:
.head 2 -  Class: frmSoloNombre
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.1"
.head 4 -  Top:    0.917"
.head 4 -  Width:  6.6"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.313"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -    Description: 
.head 2 -    Named Menus 
.head 2 -    Menu 
.head 2 +    Tool Bar 
.head 3 +    Contents 
.head 4 +    Pushbutton: pbAgregar
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbBorrar
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbGrabar
.head 5 -    Message Actions 
.head 4 +    Pushbutton: pbSalir
.head 5 -    Message Actions 
.head 2 +    Contents 
.head 3 +    Child Table: tbl1
.head 4 +    Contents 
.head 5 +    Column: colCodigo
.head 6 -    List Values 
.head 6 -    Message Actions 
.head 5 +    Column: colNombre
.head 6 -    List Values 
.head 6 -    Message Actions 
.head 4 -    Functions 
.head 4 -    Window Variables 
.head 4 +    Message Actions 
.head 5 +    On SAM_CreateComplete
.head 6 -    Set frmDestinos.sTitulos='Destinos'
.head 6 -    Call SalSendClassMessage(SAM_CreateComplete,0,0)
.head 2 -    Functions 
.head 2 -    Window Parameters 
.head 2 -    Window Variables 
.head 2 +    Message Actions 
.head 3 +    On SAM_Create
.head 4 -  !
.head 4 -    Set sTabla='DESTINOS'
.head 4 -    Set sNombre='NOMBRE'
.head 4 -    Set sCodigo='COD_DESTINO'
.head 4 -    Set nNumeroTabla=4
.head 4 -    Set hWndTabla=tbl1
.head 4 -    Set sMensajes_Otros='Destino ya Existe'
.head 4 -  !
.head 3 +  ! On MU_GRABAR
.head 4 -    Call SalSendClassMessage( MU_GRABAR, 0, 0 )
.head 3 +  ! On MU_ACTUALIZAR
.head 4 -    Call SalSendClassMessage( MU_ACTUALIZAR, 0, 0 )
.head 3 -  !
.head 3 +    On SAM_CreateComplete
.head 4 -    Call SalWaitCursor(TRUE)
.head 4 -    Call SalTblPopulate(hWndTabla,hSql6,"select "||sCodigo||","||sNombre||",TIPO"
||" from "||sTabla||" 
order by NOMBRE",TBL_FillAll)
.head 4 -    Call SalSendMsg(hWndTabla,SAM_CreateComplete,0,0)
.head 4 -    Call SalWaitCursor(FALSE)
.head 3 +    On MU_GRABAR
.head 4 -    Call SalSetFocus(hWndTabla)
.head 4 +    If SqlPrepare(hSql1,"insert into "||sTabla||"("||sCodigo||","||sNombre||")
		values(:hWndTabla.colCodigor,:hWndTabla.colNombrer)")	and
SalTblDoInserts( hWndTabla,hSql1,TRUE)	and
SqlPrepare(hSql1,"update "||sTabla||" set "||sNombre||"=:hWndTabla.colNombrer
			where "||sCodigo||"=:hWndTabla.colCodigor")	and
SalTblDoUpdates( hWndTabla,hSql1,TRUE)	and
SqlPrepare(hSql1,"delete from "||sTabla||" where "||sCodigo||"=:hWndTabla.colCodigor")	and
SalTblDoDeletes( hWndTabla,hSql1,ROW_MarkDeleted)
.head 5 -  ! viendo la base de datos que es para establecer los inicios de transaccion
.head 5 +    Select Case nBaseEs
.head 6 -    Case 8
.head 6 -    Case 28
.head 6 -    Case 31
.head 6 +    Case 4	! es SYBASE,ORACLE7,ORACLE,MSSQLSERVER
.head 7 -    Call SqlPrepareAndExecute(hSql1,"commit tran")
.head 7 -    Break 
.head 6 +    Case 1	! es SQLBASE
.head 7 -    Call SqlPrepareAndExecute(hSql1,"commit")
.head 7 -    Break 
.head 5 -  !
.head 4 +    Else 
.head 5 -  ! viendo la base de datos que es para establecer los inicios de transaccion
.head 5 +    Select Case nBaseEs
.head 6 -    Case 8
.head 6 -    Case 28
.head 6 -    Case 31
.head 6 +    Case 4	! es SYBASE,ORACLE7,ORACLE,MSSQLSERVER
.head 7 -    Call SqlPrepareAndExecute(hSql1,"rollback tran")
.head 7 -    Break 
.head 6 +    Case 1	! es SQLBASE
.head 7 -    Call SqlPrepareAndExecute(hSql1,"rollback")
.head 7 -    Break 
.head 5 -  !
.head 4 -  !
.head 4 -    Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 3 +    On MU_ACTUALIZAR
.head 4 -    Call SalSendMsg(hWndForm,SAM_CreateComplete,0,0)
.head 3 +    On SAM_Destroy
.head 4 -    Call SalBringWindowToTop( hWndForm)
.head 1 +  Form Window: frmPrincipal
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Pantalla Principal de Planillas
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   0.55"
.head 4 -  Top:    0.458"
.head 4 -  Width:  12.217"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.607"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Jade
.head 3 -  Background Color: White
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: &Planilla
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 4 -  Resource Id: 60454
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Planillas Mensuales/Quincenales
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60455
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: bArraySeg[1]
.head 6 -  Checked when:
.head 5 -  Menu Actions
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Planillas Adicionales
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60456
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: bArraySeg[2]
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalCreateWindow(frmPlanillaAdi, hWndForm)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Personal
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60457
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: bArraySeg[3]
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalCreateWindow(frmPersonal, hWndForm)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Puestos
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60458
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: bArraySeg[4]
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalCreateWindow(frmPuestos, hWndForm)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Ocupaciones
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60459
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: bArraySeg[5]
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalCreateWindow(frmOcupaciones, hWndForm)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Ingreso/Deducciones
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60460
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: bArraySeg[6]
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalCreateWindow(frmIngDed, hWndForm)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 3 +  Windows Menu: &Sistema
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 4 -  Resource Id: 60461
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Derechos
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60462
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: bArraySeg[8]
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalCreateWindow(frmDerechos, hWndForm)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Usuarios
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60463
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: bArraySeg[9]
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalCreateWindow(frmUsuarios, hWndForm)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Cambio Contraseña
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60464
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalCreateWindow(frmCambioContrasena, hWndForm)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: Salir
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60465
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: Salir del sistema
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalQuit()
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 3 +  Windows Menu: &Utilerias
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 4 -  Resource Id: 60466
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Calculadora
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60467
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalLoadApp('C:\\Windows\\calc.exe',' ')
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 +  Popup Menu: Microsoft Office
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 60468
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: MS Word
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 6 -  Resource Id: 60469
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalLoadApp('C:\\Program Files\\Microsoft Office\\Office\\winword.exe', ' ')
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: MS Excel
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 6 -  Resource Id: 60470
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalLoadApp('C:\\Program Files\\Microsoft Office\\Office\\excel.exe', ' ')
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: MS Power Point
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 6 -  Resource Id: 60471
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalLoadApp('C:\\Program Files\\Microsoft Office\\Office\\Powerpnt.exe', ' ')
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 6 -  Menu Item Name:
.head 3 +  Windows Menu: &Ayuda
.head 4 -  Resource Id: 60472
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 +  Menu Item Name:
.head 5 -  ! Menu Actions
.head 4 +  Menu Item: Acerda de...
.head 5 -  Resource Id: 60473
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalMessageBox( "Version 3.0 - 29/Oct/2014 ", "Acerca de...",0 )
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Left
.head 4 -  Visible? Yes
.head 4 -  Size: 1.667"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pbPersonal
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbBase
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Personal
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.148"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: C:\SGH\icons\User.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: 3D Highlight Color
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow( frmPersonal, hWndForm )
.head 4 +  Pushbutton: pbPuestos
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Puestos
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    1.071"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: C:\SGH\icons\GroupP.bmp
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Highlight Color
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow( frmPuestos, hWndForm )
.head 4 +  Pushbutton: pbOcupaciones
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Ocupaciones
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    1.988"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: C:\SGH\icons\GroupO.bmp
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Highlight Color
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow( frmOcupaciones, hWndForm )
.head 4 +  Pushbutton: pbIngDed
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Ing. / Ded.
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    2.905"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: C:\SGH\icons\CoinsAdd.bmp
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Highlight Color
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow( frmIngDed, hWndForm )
.head 4 +  Pushbutton: pbPlanillas
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Planilla
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    3.821"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: C:\SGH\icons\SpreadSheet.bmp
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Highlight Color
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow( frmPlanilla, hWndForm )
.head 4 +  Pushbutton: pbPlanillasAdicionales
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Planilla Adicional
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    4.738"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: C:\SGH\icons\SpreadSheetAdd.bmp
.head 5 -  Picture Transparent Color: Green
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: White
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow( frmPlanillaAdi, hWndForm )
.head 4 +  Pushbutton: pb4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Salir
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    6.155"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Picture: picBetesdaLogo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.017"
.head 5 -  Top:    1.25"
.head 5 -  Width:  12.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.1"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name: C:\SGH\icons\LOGO_FINAL_BETESDA.bmp
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: White
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Teal
.head 4 -  Background Color: System Window Color
.head 4 -  Message Actions
.head 3 +  Data Field: dfUsuario
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.817"
.head 6 -  Top:    0.786"
.head 6 -  Width:  4.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial Unicode MS
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Underline
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: White
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfLeyenda
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.017"
.head 6 -  Top:    6.226"
.head 6 -  Width:  10.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Monotype Corsiva
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Italic
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: White
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Modulo de Planilla
.head 4 -  Resource Id: 32687
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.017"
.head 5 -  Top:    0.452"
.head 5 -  Width:  10.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.512"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Arial Unicode MS
.head 4 -  Font Size: 20
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: White
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nLargo
.head 3 -  Number: nAncho
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 3 -  String: sNombreUsuarioUpper
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SqlSetResultSet( hSql1, TRUE )
.head 4 -  Call SalCenterWindow( picBetesdaLogo )
.head 4 -  Call SalGetWindowLoc( picBetesdaLogo, nX, nY)
.head 4 -  Call SalSetWindowLoc( dfUsuario, nX, nY - 0.5)
.head 4 -  Call SalStrUpper(sNombreUsuario, sNombreUsuarioUpper)
.head 4 -  Set dfUsuario = "BIENVENIDO: " || sNombreUsuarioUpper  || "!"
.head 4 -  Call SalShowWindow( dfUsuario )
.head 4 -  ! !
.head 4 -  Set dfLeyenda="By Leitz Digital"
.head 4 -  Call SalGetWindowSize (picBetesdaLogo, nAncho, nLargo)
.head 4 -  Call SalSetWindowLoc( dfLeyenda, nX , nY + nLargo + 0.05)
.head 4 -  Call SalShowWindow( dfLeyenda)
.head 4 -  ! !
.head 4 -  Call SalShowWindow (picBetesdaLogo)
.head 4 -  ! !
.head 4 -  Call SalStatusSetText ( hWndForm, 'Conectado la Base de Datos ==> ' || SqlDatabase || '...' )
.head 4 -  ! !
.head 4 -  Call SqlSetResultSet( hSql2, TRUE )
.head 4 -  Call SqlSetResultSet( hSql3, TRUE )
.head 4 -  Call SqlSetResultSet( hSql4, TRUE )
.head 4 -  Call SqlSetResultSet( hSql5, TRUE )
.head 4 -  Call DeshabilitarTodo(  )
.head 4 -  Call SalEnableWindow(pb4)
.head 4 +  If bArraySeg[1]
.head 5 -  Call SalEnableWindow(pbPlanillas)
.head 4 +  If bArraySeg[2]
.head 5 -  Call SalEnableWindow(pbPlanillasAdicionales)
.head 4 +  If bArraySeg[3]
.head 5 -  Call SalEnableWindow(pbPersonal)
.head 4 +  If bArraySeg[4]
.head 5 -  Call SalEnableWindow(pbPuestos)
.head 4 +  If bArraySeg[5]
.head 5 -  Call SalEnableWindow(pbOcupaciones)
.head 4 +  If bArraySeg[6]
.head 5 -  Call SalEnableWindow(pbIngDed)
.head 1 +  Form Window: frmCatServic
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Categorias de Servicios
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.2"
.head 4 -  Top:    0.344"
.head 4 -  Width:  10.45"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.798"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Gray
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: Tablita
.head 4 -  Resource Id: 57846
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: (Inserta Fila)
.head 5 -  Resource Id: 57847
.head 5 -  Keyboard Accelerator: Ins
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(pbAgregar,SAM_Click,0,0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: (Marca para Borrar Fila)
.head 5 -  Resource Id: 57848
.head 5 -  Keyboard Accelerator: -
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(pbBorrar,SAM_Click,0,0)
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.5"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbGrabar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbGrabar
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbGrabar.nOpcion=2
.head 7 -  Set pbGrabar.hWndTabla=tbl1
.head 4 +  Pushbutton: pbAgregar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMas
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalTblSetFocusCell( tbl1, SalTblInsertRow( tbl1, TBL_MaxRow ), tbl1.colCodigo, 0, 1 )
.head 4 +  Pushbutton: pbBorrar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMenos
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalStatusSetText(hWndForm,'                                                      ')
.head 7 -  Call SalTblQueryFocus(  tbl1,nFilas,hWndFila)
.head 7 +  If SalTblQueryRowFlags( tbl1,nFilas,ROW_MarkDeleted)
.head 8 -  Call SalTblSetRowFlags( tbl1,nFilas, ROW_MarkDeleted,FALSE)
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags( tbl1,nFilas, ROW_MarkDeleted,TRUE)
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  9.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCodigo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: CODIGO
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNombre
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: NOMBRE
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOrden
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ORDEN
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCuenta
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Cuenta Contable
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If not SqlExists( "select cod_cuenta from cuentas where cod_cuenta=:tbl1.colCuenta", bExists )
.head 9 -  Call SalMessageBox( "cuenta no existe", "Error", MB_Ok )
.head 9 -  Set tbl1.colCuenta=''
.head 8 -  Call SqlClearImmediate(  )
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFilas
.head 2 +  Message Actions
.head 3 +  On MU_GRABAR
.head 4 -  Call SalSetFocus(tbl1)
.head 4 -  Call SqlPrepare(hSql1,"insert into categ_servicios(cod_categoria,Nombre,Orden,cod_cuenta)
		values(:tbl1.colCodigo,:tbl1.colNombre,:tbl1.colOrden,:tbl1.colCuenta)")	
.head 4 -  !
.head 4 -  Call SalTblDoInserts( tbl1,hSql1,TRUE)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SqlPrepare(hSql1,"update categ_servicios set nombre=:tbl1.colNombre, orden=:tbl1.colOrden,
			cod_cuenta=:tbl1.colCuenta
			where cod_categoria=:tbl1.colCodigo")
.head 4 -  Call SalTblDoUpdates( tbl1,hSql1,TRUE)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SqlPrepare(hSql1,"delete from categ_servicios where cod_categoria=:tbl1.colCodigo")
.head 4 -  Call SalTblDoDeletes( tbl1,hSql1,ROW_MarkDeleted)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 3 +  On MU_ACTUALIZAR
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblPopulate(tbl1,hSql1,"select cod_categoria ,nombre ,orden,cod_cuenta from  categ_servicios 
order by NOMBRE",TBL_FillAll)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 1 +  Form Window: frmReporteGrafica
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ventana de Reportes
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   0.0"
.head 4 -  Top:    0.75"
.head 4 -  Width:  7.125"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.563"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: System Text Color
.head 3 -  Background Color: System Window Color
.head 2 -  Description: la funcion para imprimir debe recibir lo que se explica aqui: 
1) el título del reporte
2) el nombre del reporte(*.qrp) 
3) el nombre de las bind variables :s1,:n1
4) el nombre de los campos select nombre,edad ,...
5) el comando a ejecutar (SELECT)
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: &Reporte
.head 4 -  Resource Id: 22552
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Primera Página
.head 5 -  Resource Id: 22553
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdFirstPage)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Ultima página
.head 5 -  Resource Id: 22554
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdLastPage)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Siguiente página
.head 5 -  Resource Id: 22555
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdNextPage)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Página &Anterior
.head 5 -  Resource Id: 22556
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdPrevPage)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Ir a página...
.head 5 -  Resource Id: 22557
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdGoToPage)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Cerrar Reporte
.head 5 -  Resource Id: 22558
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportClose(hWndForm)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Menu Item Name:
.head 3 +  Popup Menu: &Impresión
.head 4 -  Resource Id: 22559
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Imprimir
.head 5 -  Resource Id: 22560
.head 5 -  Keyboard Accelerator: Ctrl+P
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdPrint)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Configurar impresora
.head 5 -  Resource Id: 22561
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdPrinterSetup)
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.49"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.188"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Picture: picGrafica
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.283"
.head 5 -  Top:    0.905"
.head 5 -  Width:  6.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sTituloListado	
.head 3 -  String: sReporte		
.head 3 -  String: sVarsEnlace	
.head 3 -  String: sVarsEntrada	
.head 3 -  String: sCmdSelect	
.head 3 -  String: sObservaciones
.head 2 +  Window Variables
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 3 -  String: s5
.head 3 -  String: s6
.head 3 -  String: s7
.head 3 -  String: s8
.head 3 -  String: s9
.head 3 -  String: s10
.head 3 -  String: s11
.head 3 -  String: s12
.head 3 -  String: s13
.head 3 -  String: s14
.head 3 -  String: s15
.head 3 -  String: s16
.head 3 -  String: s17
.head 3 -  String: s18
.head 3 -  String: s19
.head 3 -  String: s20
.head 3 -  String: s21
.head 3 -  !
.head 3 -  Number: n1
.head 3 -  Number: n2
.head 3 -  Number: n3
.head 3 -  Number: n4
.head 3 -  Number: n5
.head 3 -  Number: n6
.head 3 -  Number: n7
.head 3 -  Number: n8
.head 3 -  Number: n9
.head 3 -  Number: n10
.head 3 -  Number: n11
.head 3 -  Number: n12
.head 3 -  Number: n13
.head 3 -  Number: n14
.head 3 -  Number: n15
.head 3 -  Number: n16
.head 3 -  Number: n17
.head 3 -  Number: n18
.head 3 -  Number: n19
.head 3 -  Number: n20
.head 3 -  Number: n21
.head 3 -  Number: n22
.head 3 -  Number: n23
.head 3 -  Number: n24
.head 3 -  Number: n25
.head 3 -  Number: n26
.head 3 -  Number: n27
.head 3 -  Number: n28
.head 3 -  Number: n29
.head 3 -  Number: n30
.head 3 -  Number: n31
.head 3 -  Number: n32
.head 3 -  Number: n33
.head 3 -  Number: n34
.head 3 -  Number: n35
.head 3 -  Number: n36
.head 3 -  Number: n37
.head 3 -  Number: n38
.head 3 -  Number: n39
.head 3 -  Number: n40
.head 3 -  Number: n41
.head 3 -  Number: n42
.head 3 -  Number: n43
.head 3 -  Number: n44
.head 3 -  Number: n45
.head 3 -  Number: n46
.head 3 -  Number: n47
.head 3 -  Number: n48
.head 3 -  Number: n49
.head 3 -  Number: n50
.head 3 -  Number: n51
.head 3 -  Number: n52
.head 3 -  Number: n53
.head 3 -  Number: n54
.head 3 -  Number: n55
.head 3 -  Number: n56
.head 3 -  Number: n57
.head 3 -  Number: n58
.head 3 -  Number: n59
.head 3 -  Number: n60
.head 3 -  !
.head 3 -  Date/Time: dt1
.head 3 -  Date/Time: dt2
.head 3 -  Date/Time: dt3
.head 3 -  Date/Time: dt4
.head 3 -  Date/Time: dt5
.head 3 -  Date/Time: dt6
.head 3 -  Date/Time: dt7
.head 3 -  !
.head 3 -  Long String: ls1
.head 3 -  Long String: ls2
.head 3 -  Long String: ls3
.head 3 -  Long String: ls4
.head 3 -  Long String: ls5
.head 3 -  Long String: lsGrafica
.head 3 -  !
.head 3 -  Number: nError
.head 3 -  Boolean: bBien
.head 3 -  Sql Handle: hSqlReport
.head 3 -  Window Handle: hWndReporte
.head 3 -  !
.head 3 -  String: sDispositivo
.head 3 -  String: sDriver
.head 3 -  String: sPuerto
.head 3 -  !
.head 2 +  Message Actions
.head 3 +  ! On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SqlConnect( hSqlReport )
.head 4 -  Set bBien=TRUE
.head 4 -  !
.head 4 -  ! aqui estoy haciendo la pantalla que despliega el reporte en modo previo, y guardo en una variable de tipo
handle, el "handle" de este reporte, para luego utilizar al:
1) Utilizarlo al momento de querer inicializar cualquier variable que envio al reporte
2) Utilizarlo en la funcion de SalReportDlgOptions
.head 4 -  !
.head 4 -  Set hWndReporte=SalReportView( frmImprimir,frmImprimir, sReporte,sVarsEnlace, sVarsEntrada, nError )
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  !
.head 4 -  ! ahora proceso los diferentes errores que me retorna en el nError
.head 4 -  !
.head 4 +  If nError = RPT_ErrFileOpen
.head 5 -  Call SalMessageBox( 'No se pudo encontrar la plantilla: ' ||sReporte, sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 +  If nError = RPT_ErrMaxRpts
.head 5 -  Call SalMessageBox( 'El número de reportes ha llegado al máximo!  ', sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 +  If nError = RPT_ErrRptOpen
.head 5 -  Call SalMessageBox( 'El reporte no se pudo abrir para impresión.', sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 +  If nError = RPT_ErrRptWindow
.head 5 -  Call SalMessageBox( 'No se pudo abrir la ventana de reportes. ', sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 -  !
.head 4 -  ! si hubo algún de estos errores entonces no se podrá imprimir nada, por lo que termino
.head 4 -  !
.head 4 +  If NOT bBien
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( FALSE )		
.head 4 -  Set hWndReporte=SalReportView( frmReporteGrafica, frmReporteGrafica, sReporte, 
					sVarsEnlace, sVarsEntrada, nError )
.head 3 +  On SAM_ReportStart
.head 4 -  Call SalReportDlgOptions( hWndReporte,sTituloListado, sReporte, 'Se 			está imprimiendo...',sTituloListado )
.head 4 -  Call SalReportSetStringVar( hWndReporte, 'sTitulo', sTituloListado )
.head 4 -  Call SalPicSetFile(picGrafica,'GRAPH.WMF')
.head 4 -  Call SalPicGetString(picGrafica,PIC_FormatObject, lsGrafica)
.head 4 -  Call SalReportSetObjectVar( hWndReporte, 'lsGrafica',lsGrafica)
.head 3 +  ! On SAM_ReportFetchInit
.head 4 -  Call SalReportSetStringVar( hWndReporte, 'sTitulo', sTituloListado )
.head 4 -  Call SalReportSetStringVar( hWndReporte, 'sObservaciones', sObservaciones )
.head 4 +  If NOT SqlPrepare( hSqlReport, sCmdSelect )
.head 5 -  Return FALSE
.head 4 +  Else 
.head 5 +  If NOT SqlExecute( hSqlReport )
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Return TRUE
.head 3 +  ! On SAM_ReportFetchNext
.head 4 +  If SqlFetchNext( hSqlReport, nSiguiente )
.head 5 -  Return TRUE
.head 4 +  Else 
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  ! On SAM_Destroy
.head 4 -  Call SqlCommit(hSqlReport)
.head 4 -  Call SqlDisconnect( hSqlReport )
.head 4 -  Call SalBringWindowToTop( hWndForm )
.head 1 +  Form Window: frmPersonal
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Empleados
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    0.688"
.head 4 -  Width:  13.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.286"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: Opciones
.head 4 -  Resource Id: 54397
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Insertar
.head 5 -  Resource Id: 54398
.head 5 -  Keyboard Accelerator: Ins
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg( pbAIngDed, SAM_Click, 0, 0 )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Borrar
.head 5 -  Resource Id: 54399
.head 5 -  Keyboard Accelerator: Shift+Del
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg( pbBIngDed, SAM_Click, 0, 0 )
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.595"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strFilters[0] = 'Dynamic Link Libraries'

.head 7 -  Set strFilters[1] = '*.dll'
	 
.head 7 -  Set strFilters[2] = 'Executable Files'

.head 7 -  Set strFilters[3] = '*.exe'

.head 7 -  Set strFilters[4] = 'Initialization Files'

.head 7 -  Set strFilters[5] = '*.ini'

.head 4 +  Pushbutton: pbAgregar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMas
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbAgregar.nOpcionh=1
.head 7 -  Set pbAgregar.hWndCampo=dfCodEmpleado
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 7 -  Set dfFechaIngreso=FechaHoy(2)
.head 7 -  Call SqlPrepareAndExecute(hSql1,'select max(COD_EMPLEADO) FROM EMPLEADOS into
			 :dfCodEmpleado')
.head 7 -  Call SqlFetchNext(hSql1,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 7 +  If dfCodEmpleado=NUMBER_Null
.head 8 -  Set dfCodEmpleado=1
.head 7 +  Else
.head 8 -  Set dfCodEmpleado=dfCodEmpleado +1
.head 7 -  Call SalSetFocus( dfPrimerNom )
.head 7 -  Set rbActivo=TRUE
.head 4 +  Pushbutton: pbBorrar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMenos
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbBorrar.nOpcionh=1
.head 7 -  Set pbBorrar.sTitulo=' El Empleado'
.head 4 +  Pushbutton: pbGrabar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbGrabar
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbGrabar.nOpcion=3
.head 7 -  Set pbGrabar.sTitulo=' El Empleado '
.head 7 -  Set pbGrabar.hWndTabla=tbl1
.head 4 +  Pushbutton: pbBuscar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbBusqueda
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nRegresa=NUMBER_Null
.head 7 -  Call SalModalDialog( dlgConsultaEmpleados, hWndForm,nRegresa)
.head 7 +  If nRegresa!=NUMBER_Null
.head 8 -  Set dfCodEmpleado =nRegresa
.head 8 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 2 +  Contents
.head 3 -  Background Text: Codigo :
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28037
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.183"
.head 5 -  Top:    0.679"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCodEmpleado
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    0.655"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlExists("Select	COD_EMPLEADO
from	EMPLEADOS
where	COD_EMPLEADO=:dfCodEmpleado",bExists)
.head 6 -  Call SqlClearImmediate(  )
.head 6 +  If bExists
.head 7 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 3 -  Background Text: Fecha Ingreso
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28038
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.583"
.head 5 -  Top:    0.679"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFechaIngreso
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.983"
.head 6 -  Top:    0.679"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Identidad
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28039
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.783"
.head 5 -  Top:    0.679"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfIdentidad
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    0.679"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 3 +  Data Field: dfCuenta
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.45"
.head 6 -  Top:    1.865"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 3 -  Background Text: Primer Nombre
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28040
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.65"
.head 5 -  Top:    1.036"
.head 5 -  Width:  1.429"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.208"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPrimerNom
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    1.012"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Segundo Nombre
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28041
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.857"
.head 5 -  Top:    1.036"
.head 5 -  Width:  1.729"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSegundoNom
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    1.012"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 3 -  Background Text: Primer Apellido
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28042
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.683"
.head 5 -  Top:    1.345"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPrimerApe
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    1.345"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Segundo Apellido
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28043
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.857"
.head 5 -  Top:    1.369"
.head 5 -  Width:  1.729"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSegundoApe
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    1.345"
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 3 -  Group Box: Sexo
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28044
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.55"
.head 5 -  Top:    1.677"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbMasculino
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Masculino
.head 4 -  Window Location and Size
.head 5 -  Left:   0.95"
.head 5 -  Top:    1.844"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbFemenino
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Femenino
.head 4 -  Window Location and Size
.head 5 -  Left:   2.55"
.head 5 -  Top:    1.844"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.313"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Telefono 
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28045
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.95"
.head 5 -  Top:    1.865"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTelefonoCasa
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.85"
.head 6 -  Top:    1.844"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 3 -  Background Text: Dirección
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28046
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.55"
.head 5 -  Top:    2.281"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlDireccion
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: mlBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   0.55"
.head 6 -  Top:    2.427"
.head 6 -  Width:  6.733"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.729"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 3 -  Background Text: Ocupación
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28047
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.65"
.head 5 -  Top:    4.531"
.head 5 -  Width:  1.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbOcupacion
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cmbBaseCodigo
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.15"
.head 5 -  Top:    4.51"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.438"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set cmbOcupacion.nCaso=1
.head 6 -  Set cmbOcupacion.sTabla='OCUPACIONES'
.head 6 -  Set cmbOcupacion.sNombre='NOMBRE'
.head 6 -  Set cmbOcupacion.sCodigo='COD_OCUPACION'
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 546162546F704D61 7267696E00020030 0000546162466F72 6D50616765730002
0020: 0009000054616244 7261775374796C65 000B0057696E3935 5374796C65000054
0040: 616252696768744D 617267696E000200 3000005461624E61 6D6573000C004E61
0060: 6D6530096E616D65 3100005461624C61 62656C7300240047 656E6572616C6573
0080: 20092020496E6772 65736F732F446564 756363696F6E6573 2020000054616250
00A0: 616765436F756E74 0002003100005461 62426F74746F6D4D 617267696E000200
00C0: 3000005461624375 7272656E74000600 4E616D6530000054 61624C6566744D61
00E0: 7267696E00020030 0000000000000000 0000000000000000 000000000000
.enddata
.data CLASSPROPSSIZE
0000: FE00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.131"
.head 5 -  Width:  12.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 5.521"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Descripcion de funciones
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 42410
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.643"
.head 5 -  Top:    3.24"
.head 5 -  Width:  2.243"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Info. de Empleo
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28048
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.383"
.head 5 -  Top:    2.655"
.head 5 -  Width:  5.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Sueldo Mensual
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28049
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.883"
.head 5 -  Top:    3.012"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfsueldo
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.583"
.head 6 -  Top:    2.988"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Forma de Pago
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28050
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.983"
.head 5 -  Top:    3.345"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbFormaPago
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.583"
.head 5 -  Top:    3.321"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text: Depto.
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28051
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.683"
.head 5 -  Top:    3.929"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbDepto
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cmbBaseCodigo
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.383"
.head 5 -  Top:    3.905"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set cmbDepto.nCaso=1
.head 6 -  Set cmbDepto.sTabla='DEPTOS'
.head 6 -  Set cmbDepto.sNombre='NOMBRE'
.head 6 -  Set cmbDepto.sCodigo='COD_DEPTO'
.head 3 +  Combo Box: cmbPuesto
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cmbBaseCodigo
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.383"
.head 5 -  Top:    4.321"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set cmbPuesto.nCaso=1
.head 6 -  Set cmbPuesto.sTabla='PUESTOS'
.head 6 -  Set cmbPuesto.sNombre='NOMBRE'
.head 6 -  Set cmbPuesto.sCodigo='COD_PUESTO'
.head 3 -  Background Text: Puesto
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 28052
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.583"
.head 5 -  Top:    4.345"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Child Table: tbl1
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 6E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    0.821"
.head 6 -  Width:  10.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.083"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colIngDed
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Codigo
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set tbl1.colcmbIngDed.nCodigo=tbl1.colIngDed
.head 8 -  Call SqlImmediate( "select A.NOMBRE,A.TIPO from ING_DED A where 
A.COD_INGDED = :tbl1.colIngDed  into :tbl1.colcmbIngDed ,:tbl1.colTipo " )
.head 8 -  Call SqlClearImmediate()
.head 5 +  Column: colcmbIngDed
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsCbCodigo
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ingreso/Deducción
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set colcmbIngDed.nCaso=1
.head 8 -  Set colcmbIngDed.sTabla='ING_DED'
.head 8 -  Set colcmbIngDed.sNombre='NOMBRE'
.head 8 -  Set colcmbIngDed.sCodigo='COD_INGDED'
.head 7 +  On SAM_Validate
.head 8 -  Call SalSendClassMessage(SAM_Validate,0,0)
.head 8 -  Set tbl1.colIngDed=tbl1.colcmbIngDed.nCodigo
.head 8 -  Call SqlImmediate( "select A.TIPO from ING_DED A where 
A.COD_INGDED = :tbl1.colIngDed  into :tbl1.colTipo " )
.head 8 -  Call SqlClearImmediate()
.head 5 +  Column: colTipo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Tipo
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCantidad
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Cantidad
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #0
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On MU_REVISAR
.head 8 -  Return TRUE
.head 5 +  Column: colMonto
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Monto
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On MU_REVISAR
.head 8 -  Return TRUE
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbAIngDed
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 6E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChAgregarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.083"
.head 5 -  Top:    0.821"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbAIngDed.hWndFila=tbl1.colIngDed
.head 6 -  Set pbAIngDed.hWndTabla=tbl1
.head 3 +  Pushbutton: pbBIngDed
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 6E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChBorrarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.083"
.head 5 -  Top:    1.155"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbBIngDed.hWndFila=tbl1.colIngDed
.head 6 -  Set pbBIngDed.hWndTabla=tbl1
.head 3 -  Group Box: Estatus
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 30731
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    4.823"
.head 5 -  Width:  5.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbActivo
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Activo
.head 4 -  Window Location and Size
.head 5 -  Left:   1.883"
.head 5 -  Top:    5.073"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbInactivo
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Inactivo
.head 4 -  Window Location and Size
.head 5 -  Left:   3.783"
.head 5 -  Top:    5.073"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: No. Cuenta
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 62600
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.383"
.head 5 -  Top:    1.844"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlFunciones
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: mlBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:   0.586"
.head 6 -  Top:    3.406"
.head 6 -  Width:  6.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: picFOTO
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.786"
.head 5 -  Top:    0.49"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb8
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Obtener
.head 4 -  Window Location and Size
.head 5 -  Left:   11.686"
.head 5 -  Top:    1.49"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nindex = 1

.head 6 -  Call SalDlgOpenFile ( frmPersonal, 'Open File',strFilters, 6, nindex, strFile, strPath)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRegresa
.head 3 -  String: sexo
.head 3 -  Number: estatus
.head 3 -  String: strFilters[0:5]
	
.head 3 -  String: strFile
.head 3 -  String: strPath
.head 3 -  Boolean: bvar
.head 3 -  Number: nindex
.head 2 +  Message Actions
.head 3 +  On MU_ACTUALIZAR
.head 4 -  Call SqlPrepareAndExecute(hSql1,"
select	A.primer_nom,A.segundo_nom,A.primer_ape,A.segundo_ape,
	A.fecha_ingreso,A.identidad,A.sexo,A.telefono,A.direccion,A.sueldo_base,
	A.forma_pago,A.cod_ocupacion,A.cod_puesto,A.cod_depto,A.estado,A.cuenta
	
from	empleados A
where	A.COD_EMPLEADO=:dfCodEmpleado
into	:dfPrimerNom,:dfSegundoNom,:dfPrimerApe,:dfSegundoApe,:dfFechaIngreso,
	:dfIdentidad,:sexo,:dfTelefonoCasa,:mlDireccion,:dfsueldo,:cmbFormaPago,
	:cmbOcupacion.nCodigo,:cmbPuesto.nCodigo,:cmbDepto.nCodigo,:estatus,:dfCuenta")
.head 4 -  Call SqlFetchNext(hSql1,nSiguiente)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call cmbOcupacion.Actualizar()
.head 4 -  Call cmbPuesto.Actualizar()
.head 4 -  Call cmbDepto.Actualizar()
.head 4 +  If sexo='M'
.head 5 -  Set rbMasculino=TRUE
.head 4 +  Else
.head 5 -  Set rbFemenino=TRUE
.head 4 +  If estatus=0
.head 5 -  Set rbActivo=TRUE
.head 4 +  Else
.head 5 -  Set rbInactivo=TRUE
.head 4 -  Call SalTblPopulate(tbl1,hSql1,"
select	A.COD_INGDED,B.NOMBRE,B.TIPO,A.CANTIDAD,A.MONTO
               
from	INGDED_EMPLEADO A, ING_DED  B


where	A.COD_INGDED=B.COD_INGDED   and 
A.COD_EMPLEADO=:dfCodEmpleado    ORDER BY B.TIPO  ",TBL_FillAll)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 3 +  On MU_BORRAR
.head 4 -  Call SqlPrepareAndExecute(hSql1,"
delete from	empleados
where		COD_empleado=:dfCodEmpleado ") 
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 3 +  On MU_GRABAR
.head 4 +  If rbActivo=TRUE
.head 5 -  Set estatus=0
.head 4 +  Else
.head 5 -  Set estatus=1
.head 4 -  Call SqlExists("Select	COD_EMPLEADO
from	EMPLEADOS
where	COD_EMPLEADO=:dfCodEmpleado ",bExists)
.head 4 -  Call SqlClearImmediate(  )
.head 4 +  If bExists
.head 5 +  If rbMasculino=TRUE
.head 6 -  Set sexo='M'
.head 5 +  Else
.head 6 -  Set sexo='F'
.head 5 -  Call SqlPrepareAndExecute(hSql1,"
update	empleados
	set primer_nom=:dfPrimerNom,
	segundo_nom=:dfSegundoNom,
	primer_ape=:dfPrimerApe,
	segundo_ape=:dfSegundoApe ,
	cod_depto=:cmbDepto.nCodigo,
	cod_ocupacion=:cmbOcupacion.nCodigo,
	cod_puesto=:cmbPuesto.nCodigo,
	fecha_ingreso=:dfFechaIngreso,
	sueldo_base=:dfsueldo,
	forma_pago=:cmbFormaPago,
	direccion=:mlDireccion,
	telefono=:dfTelefonoCasa,
	sexo=:sexo,
	identidad=:dfIdentidad,
	estado=:estatus,
	cuenta=:dfCuenta		
where	COD_EMPLEADO=:dfCodEmpleado") 
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepare(hSql1,"insert 	
INGDED_EMPLEADO (
COD_EMPLEADO,COD_INGDED,CANTIDAD,MONTO)
values(:dfCodEmpleado,
:tbl1.colIngDed,:tbl1.colCantidad,:tbl1.colMonto)")
.head 5 -  Call SalTblDoInserts(tbl1,hSql1,TRUE) 
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepare(hSql1,"update INGDED_EMPLEADO 
set cantidad=:tbl1.colCantidad,monto=:tbl1.colMonto
where COD_EMPLEADO=:dfCodEmpleado and
COD_INGDED=:tbl1.colIngDed " ) 
.head 5 -  Call SalTblDoUpdates(tbl1,hSql1,TRUE)
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepare(hSql1,"delete from
INGDED_EMPLEADO where COD_EMPLEADO=:dfCodEmpleado and
COD_INGDED=:tbl1.colIngDed " )
.head 5 -  Call SalTblDoDeletes(tbl1,hSql1,ROW_MarkDeleted)
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 +  Else
.head 5 +  If rbMasculino=TRUE
.head 6 -  Set sexo='M'
.head 5 +  Else
.head 6 -  Set sexo='F'
.head 5 -  Call SqlPrepareAndExecute(hSql1,"
insert into EMPLEADOS 
( cod_empleado,  primer_nom,segundo_nom,primer_ape,segundo_ape,cod_depto,cod_ocupacion,cod_puesto,fecha_ingreso,sueldo_base,forma_pago,direccion,telefono,sexo,identidad,estado,cuenta)   values
(:dfCodEmpleado, :dfPrimerNom,:dfSegundoNom,:dfPrimerApe,:dfSegundoApe, 
:cmbDepto.nCodigo,:cmbOcupacion.nCodigo,:cmbPuesto.nCodigo,:dfFechaIngreso,
:dfsueldo,:cmbFormaPago,:mlDireccion,:dfTelefonoCasa,:sexo,:dfIdentidad,:estatus,:dfCuenta) ") 
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepare(hSql1,"insert 	
INGDED_EMPLEADO (
COD_EMPLEADO,COD_INGDED,CANTIDAD,MONTO)
values(:dfCodEmpleado,
:tbl1.colIngDed,:tbl1.colCantidad,:tbl1.colMonto)")
.head 5 -  Call SalTblDoInserts(tbl1,hSql1,TRUE) 
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalListAdd( cmbFormaPago, 'QUINCENAL' )
.head 4 -  Call SalListAdd( cmbFormaPago, 'MENSUAL' )
.head 4 -  Set rbActivo=TRUE
.head 1 +  Form Window: frmPresen
.head 2 -  Class: frmSoloNombre
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.85"
.head 4 -  Top:    0.49"
.head 4 -  Width:  7.333"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.024"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.512"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pbAgregar
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbBorrar
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbGrabar
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSalir
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.683"
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 5
.head 4 -  Class ChildKey: 0
.head 4 -  Class: frmSoloNombre
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 500
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCodigor
.head 6 -  Class Child Ref Key: 25
.head 6 -  Class ChildKey: 0
.head 6 -  Class: frmSoloNombre
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Yes
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNombrer
.head 6 -  Class Child Ref Key: 26
.head 6 -  Class ChildKey: 0
.head 6 -  Class: frmSoloNombre
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete
.head 6 -  Set frmPresen.sTitulos='Tipos de Presentación'
.head 6 -  Call SalSendClassMessage(SAM_CreateComplete,0,0)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Set sTabla='TIPOS_PRESEN'
.head 4 -  Set sNombre='NOMBRE'
.head 4 -  Set sCodigo='COD_PRESEN'
.head 4 -  Set nNumeroTabla=6
.head 4 -  Set hWndTabla=tbl1
.head 4 -  Set sMensajes_Otros='Tipo de Presentación ya Existe'
.head 4 -  !
.head 3 +  ! On MU_GRABAR
.head 4 -  Call SalSendClassMessage( MU_GRABAR, 0, 0 )
.head 3 +  ! On MU_ACTUALIZAR
.head 4 -  Call SalSendClassMessage( MU_ACTUALIZAR, 0, 0 )
.head 1 +  Form Window: frmPuestos
.head 2 -  Class: frmSoloNombre
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Puestos
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.85"
.head 4 -  Top:    0.49"
.head 4 -  Width:  8.633"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.024"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.512"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pbAgregar
.head 5 -  Class Child Ref Key: 29
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbBorrar
.head 5 -  Class Child Ref Key: 30
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbGrabar
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSalir
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: frmSoloNombre
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 5
.head 4 -  Class ChildKey: 0
.head 4 -  Class: frmSoloNombre
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  7.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 500
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCodigor
.head 6 -  Class Child Ref Key: 25
.head 6 -  Class ChildKey: 0
.head 6 -  Class: frmSoloNombre
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Yes
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNombrer
.head 6 -  Class Child Ref Key: 26
.head 6 -  Class ChildKey: 0
.head 6 -  Class: frmSoloNombre
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  5.833"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete
.head 6 -  Set frmPuestos.sTitulos='Tipos de Puestos'
.head 6 -  Call SalSendClassMessage(SAM_CreateComplete,0,0)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Set sTabla='PUESTOS'
.head 4 -  Set sNombre='NOMBRE'
.head 4 -  Set sCodigo='COD_PUESTO'
.head 4 -  Set nNumeroTabla=31
.head 4 -  Set hWndTabla=tbl1
.head 4 -  Set sMensajes_Otros='Puesto ya Existe'
.head 4 -  !
.head 3 +  ! On MU_GRABAR
.head 4 -  Call SalSendClassMessage( MU_GRABAR, 0, 0 )
.head 3 +  ! On MU_ACTUALIZAR
.head 4 -  Call SalSendClassMessage( MU_ACTUALIZAR, 0, 0 )
.head 1 +  Form Window: frmIngDed
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Registro de Ingresos/Deducciones
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.513"
.head 4 -  Top:    0.292"
.head 4 -  Width:  8.733"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.06"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.583"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbAgregar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMas
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.35"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbAgregar.nOpcionh=1
.head 7 -  Set pbAgregar.hWndCampo=dfCodIngDed
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 7 -  Call SqlPrepareAndExecute(hSql1,'select max(COD_INGDED) FROM ING_DED into
			 :dfCodIngDed')
.head 7 -  Call SqlFetchNext(hSql1,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 7 +  If dfCodIngDed=NUMBER_Null
.head 8 -  Set dfCodIngDed=1
.head 7 +  Else
.head 8 -  Set dfCodIngDed=dfCodIngDed +1
.head 7 -  Call SalSetFocus( dfNombre )
.head 4 +  Pushbutton: pbBorrar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMenos
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.05"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbBorrar.nOpcionh=1
.head 7 -  Set pbBorrar.sTitulo=' El Ingreso/Deducción'
.head 4 +  Pushbutton: pbGrabar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbGrabar
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.75"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbGrabar.nOpcion=1
.head 7 -  Set pbGrabar.sTitulo=' El Ingreso/Deducción '
.head 4 +  Pushbutton: pbBuscar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbBusqueda
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.45"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! Call SalModalDialog( dlgConsultaPacientes, hWndForm,3,sRegresaPac,sRegresaCor )
.head 7 +  ! If sRegresaPac!=''
.head 8 -  Set dfCodPaciente =sRegresaPac
.head 8 -  Set dfCorrel =sRegresaCor
.head 8 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 2 +  Contents
.head 3 -  Background Text: Codigo :
.head 4 -  Resource Id: 28053
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    0.262"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCodIngDed
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    0.238"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlExists("Select	COD_INGDED
from	ING_DED
where	COD_INGDED=:dfCodIngDed",bExists)
.head 6 -  Call SqlClearImmediate(  )
.head 6 +  If bExists
.head 7 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 6 +  Else
.head 7 -  Call SalClearField( dfNombre )
.head 7 -  Call SalClearField( cmbTipo )
.head 3 -  Background Text: Nombre :
.head 4 -  Resource Id: 28054
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    0.595"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNombre
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    0.571"
.head 6 -  Width:  6.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalTblPopulate( tbl1, hSql1, "select A.cod_ingded,A.nombre,A.tipo
from ING_DED A
where  A.nombre like '" || dfNombre || "%'  ",TBL_FillAll)
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 3 -  Background Text: Tipo :
.head 4 -  Resource Id: 28055
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    1.012"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbTipo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.483"
.head 5 -  Top:    0.988"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.383"
.head 6 -  Top:    1.405"
.head 6 -  Width:  7.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.083"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCodigo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Codigo
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNombre
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nombre
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTipo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Tipo
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 -  Background Text: Factor:
.head 4 -  Resource Id: 21034
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.983"
.head 5 -  Top:    1.012"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFactor
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.983"
.head 6 -  Top:    0.988"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalListAdd( cmbTipo, 'INGRESO' )
.head 4 -  Call SalListAdd( cmbTipo, 'DEDUCCION' )
.head 4 -  Call SalTblPopulate( tbl1, hSql1, "select A.cod_ingded,A.nombre,A.tipo
from ING_DED A ",TBL_FillAll)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 3 +  On MU_ACTUALIZAR
.head 4 -  Call SqlPrepareAndExecute(hSql1,"
select	nombre,tipo,factor
	
from	ING_DED
where	COD_INGDED=:dfCodIngDed
into	:dfNombre,
	:cmbTipo,:dfFactor")
.head 4 -  Call SqlFetchNext(hSql1,nSiguiente)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 3 +  On MU_BORRAR
.head 4 -  Call SqlPrepareAndExecute(hSql1,"
delete from	ING_DED
where		COD_INGDED=:dfCodIngDed ") 
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 3 +  On MU_GRABAR
.head 4 -  Call SqlExists("Select	COD_INGDED
from	ING_DED
where	COD_INGDED=:dfCodIngDed ",bExists)
.head 4 -  Call SqlClearImmediate(  )
.head 4 +  If bExists
.head 5 -  Call SqlPrepareAndExecute(hSql1,"
update	ING_DED
	set	nombre=:dfNombre,
		tipo=:cmbTipo,
		factor=:dfFactor
		
			
		
where	COD_INGDED=:dfCodIngDed") 
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 +  Else
.head 5 -  Call SqlPrepareAndExecute(hSql1,"
insert into ING_DED 
( cod_ingded,nombre,tipo,factor)   values
(:dfCodIngDed, :dfNombre, :cmbTipo,:dfFactor ) ") 
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 1 +  Dialog Box: dlgConsultaEmpleados
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Consulta de Pacientes
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.125"
.head 4 -  Top:    -0.01"
.head 4 -  Width:  12.933"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.369"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    2.571"
.head 6 -  Width:  12.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.917"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: Cod_Empleado
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Codigo
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Primer_Nom
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Primer Nombre
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.083"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Primer_Ape
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Primer Apellido
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Tipo_Pago
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Forma Pago
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Sueldo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sueldo
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.483"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Fecha_Ingreso
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsFecha
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Fecha Ing.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.583"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Puesto
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Puesto
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Ocupacion
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ocupacion
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Departamento
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Depto.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFilita
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalTblQueryFocus(tbl1,nFilita,tbl1.Cod_Empleado)
.head 6 -  Call SalTblSetContext(tbl1,nFilita)
.head 6 -  Set nRegresa=tbl1.Cod_Empleado
.head 6 -  Call SalEndDialog(dlgConsultaEmpleados,TRUE)
.head 3 -  Group Box: Criterios de Busqueda
.head 4 -  Resource Id: 40422
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.071"
.head 5 -  Width:  12.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbSalir
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.083"
.head 5 -  Top:    1.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbBusqueda
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.286"
.head 5 -  Top:    1.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalTblPopulate( tbl1, hSql1, ArmarQuery(), TBL_FillAll)
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  Set dfTotal=ContarFilas( tbl1 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 3 +  Data Field: dfOculto
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    4.905"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Posicionese sobre el Paciente en Particular y presione doble click para cargarlo
.head 4 -  Resource Id: 40424
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.583"
.head 5 -  Top:    5.595"
.head 5 -  Width:  8.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Total
.head 4 -  Resource Id: 40425
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.483"
.head 5 -  Top:    5.595"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTotal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.183"
.head 6 -  Top:    5.571"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: #0
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbLimpia
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.486"
.head 5 -  Top:    1.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb6
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbImprimir
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.686"
.head 5 -  Top:    1.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ArmarQuery()
.head 6 -  Call SalCreateWindow( frmImprimir, hWndForm,
"Listado de Empleados",
strRepPath || "\\empleados.QRP",
":n1,:s1,:s2,
:s3,:n2,:s7,:s4,:s5,:s6,:n3",
" A.COD_EMPLEADO,
		A.PRIMER_NOM,
		A.PRIMER_APE,
		A.FORMA_PAGO,
		A.SUELDO_BASE,
		FECHA_INGRESO,
		B.NOMBRE,C.NOMBRE,D.NOMBRE,bool",
sConsulta2 || " 	
into
:n1,:s1,:s2,
:s3,:n2,:s7,:s4,:s5,:s6,:n3",'',FALSE)
.head 3 -  Background Text: Primer Nombre
.head 4 -  Resource Id: 40426
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    0.429"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNombre
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.283"
.head 6 -  Top:    0.405"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Primer Apellido
.head 4 -  Resource Id: 40427
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.483"
.head 5 -  Top:    0.262"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfApellido
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.583"
.head 6 -  Top:    0.405"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Group Box: Rango de Fecha de Ingreso
.head 4 -  Resource Id: 40428
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.45"
.head 5 -  Top:    0.845"
.head 5 -  Width:  5.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Inicio
.head 4 -  Resource Id: 40430
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.75"
.head 5 -  Top:    1.119"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfInicio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.35"
.head 6 -  Top:    1.095"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Fin
.head 4 -  Resource Id: 40429
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.017"
.head 5 -  Top:    1.143"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.617"
.head 6 -  Top:    1.119"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Ocupación
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 40431
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.517"
.head 5 -  Top:    1.643"
.head 5 -  Width:  1.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbOcupacion
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cmbBaseCodigo
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.117"
.head 5 -  Top:    1.619"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set cmbOcupacion.nCaso=1
.head 6 -  Set cmbOcupacion.sTabla='OCUPACIONES'
.head 6 -  Set cmbOcupacion.sNombre='NOMBRE'
.head 6 -  Set cmbOcupacion.sCodigo='COD_OCUPACION'
.head 3 -  Background Text: Forma de Pago
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 40434
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.95"
.head 5 -  Top:    0.202"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbFormaPago
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.95"
.head 5 -  Top:    0.429"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text: Depto.
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 40433
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.55"
.head 5 -  Top:    0.869"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbDepto
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cmbBaseCodigo
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.45"
.head 5 -  Top:    0.845"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set cmbDepto.nCaso=1
.head 6 -  Set cmbDepto.sTabla='DEPTOS'
.head 6 -  Set cmbDepto.sNombre='NOMBRE'
.head 6 -  Set cmbDepto.sCodigo='COD_DEPTO'
.head 3 +  Combo Box: cmbPuesto
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cmbBaseCodigo
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.45"
.head 5 -  Top:    1.179"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set cmbPuesto.nCaso=1
.head 6 -  Set cmbPuesto.sTabla='PUESTOS'
.head 6 -  Set cmbPuesto.sNombre='NOMBRE'
.head 6 -  Set cmbPuesto.sCodigo='COD_PUESTO'
.head 3 -  Background Text: Puesto
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 40432
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.45"
.head 5 -  Top:    1.202"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Estado
.head 4 -  Resource Id: 45545
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.583"
.head 5 -  Top:    1.905"
.head 5 -  Width:  3.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbActivo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Activo
.head 4 -  Window Location and Size
.head 5 -  Left:   0.683"
.head 5 -  Top:    2.071"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbInactivo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Inactivo
.head 4 -  Window Location and Size
.head 5 -  Left:   1.883"
.head 5 -  Top:    2.071"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbAmbos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Am&bos
.head 4 -  Window Location and Size
.head 5 -  Left:   3.183"
.head 5 -  Top:    2.071"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Group Box: Reporte
.head 4 -  Resource Id: 37045
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.486"
.head 5 -  Top:    1.906"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: cb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sueldo
.head 4 -  Window Location and Size
.head 5 -  Left:   4.686"
.head 5 -  Top:    2.073"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: ArmarQuery
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sConsulta
.head 4 +  Actions
.head 5 -  Set sConsulta="Select  A.COD_EMPLEADO,
		A.PRIMER_NOM,
		A.PRIMER_APE,
		A.FORMA_PAGO,
		A.SUELDO_BASE,
		convert(varchar(10),A.FECHA_INGRESO,103),
		B.NOMBRE,C.NOMBRE,D.NOMBRE
		
		from	EMPLEADOS A,PUESTOS B, OCUPACIONES C,
			DEPTOS D

		where	A.COD_PUESTO=B.COD_PUESTO AND 
			A.COD_OCUPACION=C.COD_OCUPACION AND
			A.COD_DEPTO=D.COD_DEPTO "
			
.head 5 +  If dfNombre !=''
.head 6 -  Set sConsulta=sConsulta||"	AND	A.PRIMER_NOM   like '%"||dlgConsultaEmpleados.dfNombre||"%'"
.head 5 +  If dfApellido !=''
.head 6 -  Set sConsulta=sConsulta||"	AND	A.PRIMER_APE   like '%"||dlgConsultaEmpleados.dfApellido||"%'"
.head 5 +  If cmbDepto != ''
.head 6 -  Set sConsulta=sConsulta||" AND A.COD_DEPTO = :cmbDepto.nCodigo"
.head 5 +  If rbActivo = TRUE
.head 6 -  Set sConsulta=sConsulta||" AND A.ESTADO = 0"
.head 5 +  If rbInactivo = TRUE
.head 6 -  Set sConsulta=sConsulta||" AND A.ESTADO = 1"
.head 5 +  If cb1 = TRUE
.head 6 -  Set nBool =  1
.head 5 +  Else
.head 6 -  Set nBool = 0
.head 5 -  Set sConsulta2="Select  A.COD_EMPLEADO,
		A.PRIMER_NOM,
		A.PRIMER_APE,
		A.FORMA_PAGO,
		A.SUELDO_BASE,
		convert(varchar(10),A.FECHA_INGRESO,103),
		B.NOMBRE,C.NOMBRE,D.NOMBRE, " || SalNumberToStrX( dlgConsultaEmpleados.nBool ,0)
		
		|| " from	EMPLEADOS A,PUESTOS B, OCUPACIONES C,
			DEPTOS D

		where	A.COD_PUESTO=B.COD_PUESTO AND 
			A.COD_OCUPACION=C.COD_OCUPACION AND
			A.COD_DEPTO=D.COD_DEPTO "
			
.head 5 -  Set sConsulta2=sConsulta2||" order by D.NOMBRE, A.PRIMER_NOM"
.head 5 -  Set sConsulta=sConsulta||" order by D.NOMBRE, A.PRIMER_NOM"
.head 5 -  Return sConsulta
.head 2 +  Window Parameters
.head 3 -  Receive Number: nRegresa
.head 2 +  Window Variables
.head 3 -  String: sConsulta2
.head 3 -  Number: nBool
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalListAdd( cmbFormaPago, 'QUINCENAL' )
.head 4 -  Call SalListAdd( cmbFormaPago, 'MENSUAL' )
.head 1 +  Form Window: frmPlanilla
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Elaboración de Planillas
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    0.688"
.head 4 -  Width:  15.9"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.75"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: Opciones
.head 4 -  Resource Id: 21031
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Insertar
.head 5 -  Resource Id: 21032
.head 5 -  Keyboard Accelerator: Ins
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg( pbAIngDed, SAM_Click, 0, 0 )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Borrar
.head 5 -  Resource Id: 21033
.head 5 -  Keyboard Accelerator: Shift+Del
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg( pbBIngDed, SAM_Click, 0, 0 )
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.595"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pbAgregar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMas
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbAgregar.nOpcionh=1
.head 7 -  Set pbAgregar.hWndCampo=dfCod_Planilla
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 7 -  Call SqlPrepareAndExecute(hSql1,'select max(COD_PLANILLA) FROM PLANILLA  into
			 :dfCod_Planilla')
.head 7 -  Call SqlFetchNext(hSql1,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 7 +  If dfCod_Planilla=NUMBER_Null
.head 8 -  Set dfCod_Planilla=1
.head 7 +  Else
.head 8 -  Set dfCod_Planilla=dfCod_Planilla+1
.head 7 -  Call SalDisableWindow( tbl2 )
.head 7 -  Call SalDisableWindow( pbAIngDed )
.head 7 -  Call SalDisableWindow( pbBIngDed )
.head 7 -  Call SalDisableWindow( pbAIngDed2 )
.head 7 -  Call SalDisableWindow( pbBIngDed2 )
.head 7 -  Call SalTblInsertRow( tbl3, 1 )
.head 4 +  Pushbutton: pbEliminar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMenos
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbEliminar.nOpcionh=1
.head 7 -  Set pbEliminar.sTitulo=' La Planilla '
.head 4 +  Pushbutton: pbGrabar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbGrabar
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbBuscar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbBusqueda
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlgConsultaPlanilla, hWndForm,nRegresa)
.head 7 +  If nRegresa!=NUMBER_Null
.head 8 -  Set dfCod_Planilla =nRegresa
.head 8 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 4 +  Pushbutton: pbSalir
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbCerrar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbBusqueda
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: C:\SGH\icons\cerrar.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Single
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SqlPrepareAndExecute( hSql1, "SELECT estado FROM planilla WHERE cod_planilla = :dfCod_Planilla INTO :sEstado" )
.head 7 -  Call SqlFetchNext( hSql1, nSig )
.head 7 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 7 +  If sEstado = "CERRADA"
.head 8 -  Call SalMessageBox( "Esta planilla ya fue cerrada", "Mensaje", MB_Ok )
.head 8 -  Return FALSE
.head 7 -  Set nResp = SalMessageBox( "Esta seguro de cerrar la planilla?", "Confirmacion", MB_YesNo )
.head 7 +  If nResp = IDNO
.head 8 -  Return FALSE
.head 7 -  ! ! Debe mandarse a llamar usando las funciones de sybase.
.head 7 -  ! Call OdrExecuteProc( hSql1, "{call cerrar_planilla(" || SalNumberToStrX( dfCod_Planilla, 0 ) || ")}", "" )
.head 7 -  ! !
.head 7 -  ! ! En la version Sybase 12.5 es posible invocar el procedure directamente (solo es necesario establecer el tipo de procedure en anymode)  sp_procxmode SP_GENERAR_PARTIDAS_PP, "anymode";
.head 7 -  Call SqlPrepareAndExecute( hSql1, "EXECUTE SP_GENERAR_PARTIDAS_PP :dfCod_Planilla" )
.head 7 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 7 -  Call SqlPrepareAndExecute( hSql1, "UPDATE planilla SET estado = 'CERRADA' WHERE cod_planilla = :dfCod_Planilla" )
.head 7 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 7 -  Call SalMessageBox( "La planilla fue cerrada", "Mensaje", MB_Ok )
.head 4 +  Pushbutton: pb9
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbImprimir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! Set fechaI= SalFmtFormatDateTime(dfInicio,"dd/MM/yyyy")
.head 7 -  ! Set fechaF= SalFmtFormatDateTime(dfFin ,"dd/MM/yyyy")
.head 7 -  ! Set sObs="PLANILLA " || cmbFormaPago || "  De la Fecha " || fechaI || "   a la Fecha  " ||  fechaF
.head 7 -  ! Call SalCreateWindow( frmImprimir, hWndForm,
"Planilla",
strRepPath || "\\PLANILLA.QRP",
":n1,:s1,:s2,:s3,:s4,:n2,:n3,:n4,:n5,:n6,:n7,:n8,:n9,:n10,:n11,:n12,:n13,:n14,:n15,:s5",

"A.cod_empleado, B.Primer_Nom, B.Segundo_Nom,B.Primer_Ape,B.Segundo_Ape,
A.horas_extras,A.turnos,A.otros_ingresos,A.ihss,A.rap,A.alimentacion,
A.prestamo,A.isr,A.ausencias,A.cooperativa,A.otros_egresos,A.sueldo_pagado,A.bonificaciones,
A.laboratorio, A.medicamentos, C.departamento",

"SELECT	A.cod_empleado, B.Primer_Nom, B.Segundo_Nom,B.Primer_Ape,B.Segundo_Ape,
A.horas_extras,A.turnos,A.otros_ingresos,A.ihss,A.rap,A.alimentacion,
A.prestamo,A.isr,A.ausencias,A.cooperativa,A.otros_egresos,A.sueldo_pagado,A.bonificaciones,
A.laboratorio, A.medicamentos,C.nombre
                
from	DET_PLANILLA A, EMPLEADOS B, DEPTOS C
where	A.cod_empleado=B.cod_empleado and A.cod_planilla=:frmPlanilla.dfCod_Planilla AND
	B.cod_depto = C.cod_depto

ORDER BY  C.nombre

into      :n1,:s1,:s2,:s3,:s4,:n2,:n3,:n4,:n5,:n6,:n7,:n8,:n9,:n10,:n11,:n12,:n13,:n14,:n15,:s5",

sObs)
.head 7 -  Call SalModalDialog( dlgPlanilla, hWndForm)
.head 4 +  Pushbutton: pbVouchers
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbImprimir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Recibos
.head 5 -  Window Location and Size
.head 6 -  Left:   5.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set fechaI= SalFmtFormatDateTime(dfInicio,"dd/MM/yyyy")
.head 7 -  Set fechaF= SalFmtFormatDateTime(dfFin ,"dd/MM/yyyy")
.head 7 -  Set sObs="Pago correspondiente para Planilla  " || cmbFormaPago || "  De la Fecha " || fechaI || "   a la Fecha  " ||  fechaF
.head 7 -  Call SalCreateWindow( frmImprimir, hWndForm,
sObs,
strRepPath || "\\PLANILLA_RECIBOS.QRP",
":s1,:n1,:n2,:n3,:n4,:dt1,:s2,:n5,:s3,:s4,:n6,:n7,:s5,:n8,:n9",

"D.tipo,FORMULANUEVA,c.cod_ingded,c.monto,c.cantidad,c.fecha,c.descripcion,
A.cod_empleado,B.Primer_Nom,B.Primer_Ape,A.sueldo_mensual,A.sueldo_pagado,D.nombre,TOTALINGRESOS,TOTALEGRESOS",

"select D.Tipo,1 corr,c.cod_ingded,c.monto,c.cantidad,c.fecha,c.descripcion,
A.cod_empleado,B.Primer_Nom,B.Primer_Ape,A.sueldo_mensual,A.sueldo_pagado,D.nombre,
A.sueldo_pagado + A.horas_extras + A.bonificaciones + A.otros_ingresos+
A.turnos,A.rap+A.ihss+A.isr+A.cooperativa+A.alimentacion+A.prestamo+A.ausencias+A.otros_egresos+A.laboratorio+A.medicamentos


from det_planilla A , empleados B, det_planilla_det C , ING_DED D


where A.cod_planilla =:frmPlanilla.dfCod_Planilla
and A.cod_empleado*=B.cod_empleado and A.cod_planilla*=C.cod_planilla and
A.cod_empleado*=C.cod_empleado and C.cod_ingded*=D.cod_ingded



union

select D.tipo ,2 corr,c.cod_ingded,c.monto,c.cantidad,c.fecha,c.descripcion,
A.cod_empleado,B.Primer_Nom,B.Primer_Ape,A.sueldo_mensual,A.sueldo_pagado,D.nombre,
A.sueldo_pagado + A.horas_extras + A.bonificaciones + A.otros_ingresos+
A.turnos,A.rap+A.ihss+A.isr+A.cooperativa+A.alimentacion+A.prestamo+A.ausencias+A.otros_egresos+A.laboratorio+A.medicamentos

from det_planilla A , empleados B, det_planilla_det C , ING_DED D


where A.cod_planilla =:frmPlanilla.dfCod_Planilla
and A.cod_empleado*=B.cod_empleado and A.cod_planilla*=C.cod_planilla and
A.cod_empleado*=C.cod_empleado and C.cod_ingded*=D.cod_ingded



into        :s1,:n1,:n2,:n3,:n4,:dt1,:s2,:n5,:s3,:s4,:n6,:n7,:s5,:n8,:n9",

sObs,FALSE)
.head 4 +  Pushbutton: pbArchivo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Archivo
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlgArchPlanilla, hWndForm, dfCod_Planilla)
.head 4 +  Pushbutton: pbAsistencia
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Asistencia
.head 5 -  Window Location and Size
.head 6 -  Left:   7.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalCreateWindow( frmAsistencia, hWndForm, dfCod_Planilla,dfInicio,dfFin)
.head 2 +  Contents
.head 3 -  Background Text: Numero Planilla:
.head 4 -  Resource Id: 22513
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.012"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCod_Planilla
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlExists("Select	SUBTIPO
from	PLANILLA
where	COD_PLANILLA=:dfCod_Planilla into :TIPO ",bExists)
.head 6 -  Call SqlClearImmediate(  )
.head 6 +  If bExists
.head 7 -  Call SalSendMsg( frmPlanilla, MU_ACTUALIZAR, 0, 0 )
.head 3 +  Combo Box: cmbFormaPago
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.35"
.head 5 -  Top:    0.012"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text: Tipo
.head 4 -  Resource Id: 22514
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.783"
.head 5 -  Top:    0.012"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Fecha Inicio
.head 4 -  Resource Id: 22515
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.417"
.head 5 -  Top:    0.06"
.head 5 -  Width:  1.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfInicio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.517"
.head 6 -  Top:    0.036"
.head 6 -  Width:  1.467"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Fecha Fin
.head 4 -  Resource Id: 22516
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.183"
.head 5 -  Top:    0.083"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.083"
.head 6 -  Top:    0.06"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Descripción
.head 4 -  Resource Id: 22517
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    0.345"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDescripcion
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.321"
.head 6 -  Width:  9.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Estado
.head 4 -  Resource Id: 22518
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.883"
.head 5 -  Top:    0.345"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold-Underline
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfEstado
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.583"
.head 6 -  Top:    0.321"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    0.571"
.head 6 -  Width:  12.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: cod_empleado
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Codigo
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call SqlExists("Select  Primer_Nom + ' ' + Primer_Ape, sueldo_base,fecha_ingreso
from	empleados
where	COD_empleado=:tbl1.cod_empleado and forma_pago=:cmbFormaPago  into 
:tbl1.nombres,:tbl1.sueldo_mensual,:G_FECHA_INGRESO ",bExists)
.head 8 -  Call SqlClearImmediate(  )
.head 8 +  If bExists
.head 9 -  Set tbl1.sueldo=  Calcular_Sueldo ( tbl1.cod_empleado,tbl1.sueldo_mensual ,G_FECHA_INGRESO )
.head 9 -  Set tbl1.horas_extras=0 
.head 9 -  Set tbl1.turnos=0 
.head 9 -  Set tbl1.Bonificacion=0 
.head 9 -  Set tbl1.otros_ingresos=0 
.head 9 -  Set tbl1.seguro =0 
.head 9 -  Set tbl1.isr =0 
.head 9 -  Set tbl1.cooperativa =0 
.head 9 -  Set tbl1.alimentacion  =0 
.head 9 -  Set tbl1.prestamo  =0 
.head 9 -  Set tbl1.ausencia  =0 
.head 9 -  Set tbl1.otros_egresos  =0 
.head 9 -  Set tbl1.Total_Ing   = tbl1.sueldo 
.head 9 -  Set tbl1.total_egresos   = 0
.head 9 -  Set tbl1.neto   = tbl1.sueldo
.head 5 +  Column: nombres
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nombre
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.217"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: sueldo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sueldo
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.217"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set tbl1.Total_Ing = tbl1.sueldo + tbl1.horas_extras+ tbl1.turnos + tbl1.Bonificacion + tbl1.otros_ingresos
.head 8 -  Set tbl1.total_egresos = tbl1.seguro+ tbl1.isr + tbl1.cooperativa + tbl1.alimentacion + tbl1.prestamo +
tbl1.ausencia+ tbl1.otros_egresos
.head 8 -  Set tbl1.neto = tbl1.Total_Ing - tbl1.total_egresos
.head 5 +  Column: horas_extras
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Horas Ext.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: turnos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Turnos
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Bonificacion
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Bonificación
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: otros_ingresos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Otros Ing.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Total_Ing
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Total Ing.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: RAP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: RAP
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: seguro
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: IHSS
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLaboratorio
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Laboratorio
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMedicamentos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Medicina
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: isr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Imp. S/R
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cooperativa
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Coop.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.867"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: alimentacion
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Aliment.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: prestamo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prestamo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ausencia
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ausencias
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: otros_egresos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Otros Egre.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: total_egresos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Total Egre.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: neto
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sueldo Neto
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Right
.head 6 -  Width:  1.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: sueldo_mensual
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.917"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 -  ! On SAM_Click
.head 5 +  On SAM_Click
.head 6 -  !
.head 6 -  ! primero carguemos unicamente los ingresos
.head 6 -  Call SalEnableWindow( tbl2 )
.head 6 -  Call SalTblPopulate( tbl2, hSql1, "
select A.correlativo,A.cod_ingded,B.nombre,B.tipo,A.cantidad,A.monto,A.subtotal,
convert(varchar(10),A.fecha,103),A.descripcion


from det_planilla_det A, ING_DED B
where A.cod_ingded=B.cod_ingded and A.cod_planilla=:dfCod_Planilla and 
A.cod_empleado = :tbl1.cod_empleado	and	B.TIPO='INGRESO'

", TBL_FillAll )
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  !
.head 6 -  ! ahora carguemos las deducciones
.head 6 -  Call SalEnableWindow( tbl4 )
.head 6 -  Call SalTblPopulate( tbl4, hSql1, "
select 
	A.correlativo,
	A.cod_ingded,
	B.nombre,
	B.tipo,
	dpp.COD_FACTURA,
	A.cantidad,
	A.monto,
	A.subtotal,
	convert(varchar(10),
	A.fecha,103),
	A.descripcion
from 
	det_planilla_det A
	  inner join ING_DED B ON A.cod_ingded=B.cod_ingded
	    left outer join DET_PLANILLA_DET_PE dpp ON A.CORRELATIVO = dpp.CORRELATIVO
where 
	A.cod_planilla=:dfCod_Planilla and 
	A.cod_empleado = :tbl1.cod_empleado	and	B.TIPO='DEDUCCION'

", TBL_FillAll )
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  !
.head 6 -  Call SalEnableWindow( pbAIngDed )
.head 6 -  Call SalEnableWindow( pbBIngDed )
.head 6 -  Call SalEnableWindow( pbAIngDed2 )
.head 6 -  Call SalEnableWindow( pbBIngDed2 )
.head 3 -  !
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    3.071"
.head 6 -  Width:  11.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.083"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colUnico
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Correl
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.683"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cod_ingded
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Cod
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.617"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call SqlExists( "select A.NOMBRE from ING_DED  A where 
A.COD_INGDED=:tbl2.cod_ingded  and
A.TIPO='INGRESO'
into :colcmbIngDed  " ,bExists)
.head 8 -  Call SqlClearImmediate()
.head 8 +  If not bExists
.head 9 -  Call SalMessageBox("Ingreso no existe","ERROR",MB_Ok)
.head 9 -  Set tbl2.cod_ingded = NUMBER_Null
.head 9 -  Set tbl2.colcmbIngDed=''
.head 8 +  Else
.head 9 -  Set tbl2.tipo='INGRESO'
.head 9 -  Set tbl2.colcmbIngDed.nCodigo=tbl2.cod_ingded
.head 5 +  Column: colcmbIngDed
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsCbCodigo
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ingreso
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.067"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set colcmbIngDed.nCaso=1
.head 8 -  Set colcmbIngDed.sTabla='ING_DED'
.head 8 -  Set colcmbIngDed.sNombre='NOMBRE'
.head 8 -  Set colcmbIngDed.sCodigo='COD_INGDED'
.head 7 +  On SAM_Validate
.head 8 -  Call SalSendClassMessage(SAM_Validate,0,0)
.head 8 -  Set tbl2.cod_ingded=tbl2.colcmbIngDed.nCodigo
.head 8 -  Call SqlImmediate( "select A.TIPO,A.FACTOR  from ING_DED A where 
A.COD_INGDED = :tbl2.cod_ingded  into :tbl2.tipo,:factor " )
.head 8 -  Call SqlClearImmediate()
.head 8 +  Select Case (tbl2.cod_ingded)
.head 9 +  Case 1
.head 10 -  ! HORAS EXTRAS
.head 10 -  Set tbl2.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor 
.head 10 -  Break
.head 9 +  Case 2
.head 10 -  ! BONIFICACIONEs
.head 10 -  Break
.head 9 +  Case 3
.head 10 -  ! OTROS INGRESOS
.head 10 -  Break
.head 9 +  Case 4
.head 10 -  ! TURNO A
.head 10 -  Set tbl2.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor
.head 10 -  Break
.head 9 +  Case 5
.head 10 -  ! TURNO B
.head 10 -  Set tbl2.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor
.head 10 -  Break
.head 9 +  Case 6
.head 10 -  ! TURNO C
.head 10 -  Set tbl2.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor
.head 10 -  Break
.head 9 +  Case 7
.head 10 -  ! SEGURO (IHSS)
.head 10 +  If tbl1.sueldo_mensual >= 4800
.head 11 +  If cmbFormaPago='MENSUAL'
.head 12 -  Set tbl2.monto=168
.head 11 +  Else
.head 12 +  If cbQuincena=TRUE
.head 13 -  Set tbl2.monto = 168
.head 12 +  Else
.head 13 -  Set tbl2.monto=0
.head 10 +  Else
.head 11 -  Set tbl2.monto = 0
.head 10 -  Break
.head 9 +  Case 8
.head 10 -  ! PRESTAMO
.head 10 -  Break
.head 9 +  Case 9
.head 10 -  ! COOPERATIVA
.head 10 -  Break
.head 9 +  Case 10
.head 10 -  ! AUSENCIAS
.head 10 -  Set tbl2.monto= (tbl1.sueldo_mensual / 30)
.head 10 -  Break
.head 9 +  Case 11
.head 10 -  ! ALIMENTACION
.head 10 -  Break
.head 9 +  Case 12
.head 10 -  ! OTRAS DEDUCCIONES
.head 10 -  Break
.head 9 +  Case 13
.head 10 -  ! IMPUESTO SOBRE RENTA
.head 10 -  Set nRegresa=0
.head 10 -  Call SalModalDialog( dlgISR, hWndForm,nRegresa,tbl1.sueldo_mensual )
.head 10 +  If nRegresa!=0
.head 11 -  Set tbl2.monto =nRegresa
.head 10 -  Break
.head 9 +  Case 14
.head 10 -  ! VACACIONES 
.head 10 -  Set tbl2.monto= (tbl1.sueldo_mensual / 30)
.head 10 -  Break
.head 9 +  Case 15
.head 10 -  ! TURNOS
.head 10 -  Set tbl2.monto= (tbl1.sueldo_mensual / 30)
.head 10 -  Break
.head 9 +  Case 17
.head 10 -  ! INCAPACIDAD
.head 10 -  Set tbl2.monto= (tbl1.sueldo_mensual / 30)
.head 10 -  Break
.head 9 -  Default
.head 7 +  On SAM_DropDown
.head 8 -  Call SalListPopulate(colcmbIngDed,hSql6,"select	NOMBRE		FROM	ING_DED
WHERE TIPO='INGRESO'")
.head 8 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 5 +  Column: tipo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Tipo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cantidad
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Cant.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set tbl2.subtotal=tbl2.cantidad * tbl2.monto
.head 5 +  Column: monto
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Monto
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.217"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###00000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set tbl2.subtotal=tbl2.cantidad * tbl2.monto
.head 5 +  Column: subtotal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SubTotal
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.15"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: fecha
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsFecha
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Fecha
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: descripcion
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Descripcion
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.267"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: factor
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbAIngDed
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 6E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChAgregarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.186"
.head 5 -  Top:    3.344"
.head 5 -  Width:  0.567"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbAIngDed.hWndFila=tbl2.cod_ingded
.head 6 -  Set pbAIngDed.hWndTabla=tbl2
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 6 -  Set tbl2.colUnico=Identity(600)
.head 6 -  Set tbl2.fecha = dfFin
.head 3 +  Pushbutton: pbBIngDed
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 6E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChBorrarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.186"
.head 5 -  Top:    3.74"
.head 5 -  Width:  0.567"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbBIngDed.hWndFila=tbl2.cod_ingded
.head 6 -  Set pbBIngDed.hWndTabla=tbl2
.head 3 -  !
.head 3 +  Child Table: tbl4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    4.405"
.head 6 -  Width:  12.733"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.357"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colUnico
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Correl
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.667"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cod_ingded
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Cod
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call SqlExists( "select A.NOMBRE from ING_DED  A where 
A.COD_INGDED=:tbl4.cod_ingded  and
A.TIPO='DEDUCCION'
into :colcmbIngDed  " ,bExists)
.head 8 -  Call SqlClearImmediate()
.head 8 +  If not bExists
.head 9 -  Call SalMessageBox("Deduccion no existe","ERROR",MB_Ok)
.head 9 -  Set tbl4.cod_ingded = NUMBER_Null
.head 9 -  Set tbl4.colcmbIngDed=''
.head 8 +  Else
.head 9 -  Set tbl4.colcmbIngDed.nCodigo=tbl4.cod_ingded
.head 9 -  Set tbl4.tipo='DEDUCCION'
.head 9 +  Select Case (tbl4.cod_ingded)
.head 10 +  Case 1
.head 11 -  ! HORAS EXTRAS
.head 11 -  Set tbl4.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor 
.head 11 -  Break
.head 10 +  Case 2
.head 11 -  ! BONIFICACIONEs
.head 11 -  Break
.head 10 +  Case 3
.head 11 -  ! OTROS INGRESOS
.head 11 -  Break
.head 10 +  Case 4
.head 11 -  ! TURNO A
.head 11 -  Set tbl4.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor
.head 11 -  Break
.head 10 +  Case 5
.head 11 -  ! TURNO B
.head 11 -  Set tbl4.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor
.head 11 -  Break
.head 10 +  Case 6
.head 11 -  ! TURNO C
.head 11 -  Set tbl4.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor
.head 11 -  Break
.head 10 +  Case 7
.head 11 -  ! SEGURO (IHSS)
.head 11 -  Set tbl4.monto = GetIHSS( tbl1.sueldo_mensual , cmbFormaPago, cbQuincena, nIHSS_TECHO, nIHSS_PORCENTAJE )
.head 11 -  Break
.head 10 +  Case 8
.head 11 -  ! PRESTAMO
.head 11 -  Call PopulateFactEmpleado(tbl1.cod_empleado)
.head 11 -  Break
.head 10 +  Case 9
.head 11 -  ! COOPERATIVA
.head 11 -  Break
.head 10 +  Case 10
.head 11 -  ! AUSENCIAS
.head 11 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)
.head 11 -  Break
.head 10 +  Case 11
.head 11 -  ! ALIMENTACION
.head 11 -  Break
.head 10 +  Case 12
.head 11 -  ! OTRAS DEDUCCIONES
.head 11 -  Break
.head 10 +  Case 13
.head 11 -  ! IMPUESTO SOBRE RENTA
.head 11 -  Set nRegresa=0
.head 11 -  Call SalModalDialog( dlgISR, hWndForm,nRegresa,tbl1.sueldo_mensual )
.head 11 +  If nRegresa!=0
.head 12 -  Set tbl4.monto =nRegresa
.head 11 -  Break
.head 10 +  Case 14
.head 11 -  ! VACACIONES 
.head 11 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)
.head 11 -  Break
.head 10 +  Case 15
.head 11 -  ! TURNOS
.head 11 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)
.head 11 -  Break
.head 10 +  Case 17
.head 11 -  ! INCAPACIDAD
.head 11 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)
.head 11 -  Break
.head 10 +  Case 32
.head 11 -  ! RAP
.head 11 +  If cmbFormaPago='MENSUAL'
.head 12 -  Set tbl4.monto = tbl1.sueldo_mensual * 0.015
.head 11 +  Else
.head 12 +  If cbQuincena=TRUE
.head 13 -  Set tbl4.monto = tbl1.sueldo_mensual * 0.015
.head 12 +  Else
.head 13 -  Set tbl4.monto=0
.head 11 -  Break
.head 10 +  Case 36
.head 11 -  ! Vacaciones Ded
.head 11 -  Set tbl4.monto = tbl1.sueldo_mensual /30
.head 11 -  Break
.head 10 +  Case 33
.head 11 -  ! Incapacidad al 50%
.head 11 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)/2
.head 11 -  Break
.head 10 -  !
.head 10 +  Case 34
.head 11 -  ! Incapacidad al 66%
.head 11 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)*0.66
.head 11 -  Break
.head 10 -  Default
.head 5 +  Column: colcmbIngDed
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsCbCodigo
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Deduccion
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.133"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set colcmbIngDed.nCaso=1
.head 8 -  Set colcmbIngDed.sTabla='ING_DED'
.head 8 -  Set colcmbIngDed.sNombre='NOMBRE'
.head 8 -  Set colcmbIngDed.sCodigo='COD_INGDED'
.head 7 +  On SAM_Validate
.head 8 -  Call SalSendClassMessage(SAM_Validate,0,0)
.head 8 -  Set tbl4.cod_ingded=tbl4.colcmbIngDed.nCodigo
.head 8 -  Call SqlImmediate( "select A.TIPO,A.FACTOR  from ING_DED A where 
A.COD_INGDED = :tbl4.cod_ingded  into :tbl4.tipo,:factor " )
.head 8 -  Call SqlClearImmediate()
.head 8 +  Select Case (tbl4.cod_ingded)
.head 9 +  Case 1
.head 10 -  ! HORAS EXTRAS
.head 10 -  Set tbl4.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor 
.head 10 -  Break
.head 9 +  Case 2
.head 10 -  ! BONIFICACIONEs
.head 10 -  Break
.head 9 +  Case 3
.head 10 -  ! OTROS INGRESOS
.head 10 -  Break
.head 9 +  Case 4
.head 10 -  ! TURNO A
.head 10 -  Set tbl4.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor
.head 10 -  Break
.head 9 +  Case 5
.head 10 -  ! TURNO B
.head 10 -  Set tbl4.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor
.head 10 -  Break
.head 9 +  Case 6
.head 10 -  ! TURNO C
.head 10 -  Set tbl4.monto=( (tbl1.sueldo_mensual / 30) / 8) * factor
.head 10 -  Break
.head 9 +  Case 7
.head 10 -  ! SEGURO (IHSS)
.head 10 -  Set tbl4.monto = GetIHSS( tbl1.sueldo_mensual , cmbFormaPago, cbQuincena, nIHSS_TECHO, nIHSS_PORCENTAJE )
.head 10 -  Break
.head 9 +  Case 8
.head 10 -  ! PRESTAMO
.head 10 -  Call PopulateFactEmpleado(tbl1.cod_empleado)
.head 10 -  Break
.head 9 +  Case 9
.head 10 -  ! COOPERATIVA
.head 10 -  Break
.head 9 +  Case 10
.head 10 -  ! AUSENCIAS
.head 10 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)
.head 10 -  Break
.head 9 +  Case 11
.head 10 -  ! ALIMENTACION
.head 10 -  Break
.head 9 +  Case 12
.head 10 -  ! OTRAS DEDUCCIONES
.head 10 -  Break
.head 9 +  Case 13
.head 10 -  ! IMPUESTO SOBRE RENTA
.head 10 -  Set nRegresa=0
.head 10 -  Call SalModalDialog( dlgISR, hWndForm,nRegresa,tbl1.sueldo_mensual )
.head 10 +  If nRegresa!=0
.head 11 -  Set tbl4.monto =nRegresa
.head 10 -  Break
.head 9 +  Case 14
.head 10 -  ! VACACIONES 
.head 10 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)
.head 10 -  Break
.head 9 +  Case 15
.head 10 -  ! TURNOS
.head 10 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)
.head 10 -  Break
.head 9 +  Case 17
.head 10 -  ! INCAPACIDAD
.head 10 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)
.head 10 -  Break
.head 9 +  Case 32
.head 10 -  ! RAP
.head 10 +  If cmbFormaPago='MENSUAL'
.head 11 -  Set tbl4.monto = tbl1.sueldo_mensual * 0.015
.head 10 +  Else
.head 11 +  If cbQuincena=TRUE
.head 12 -  Set tbl4.monto = tbl1.sueldo_mensual * 0.015
.head 11 +  Else
.head 12 -  Set tbl4.monto=0
.head 10 -  Break
.head 9 +  Case 36
.head 10 -  ! Vacaciones Ded
.head 10 -  Set tbl4.monto = tbl1.sueldo_mensual /30
.head 10 -  Break
.head 9 +  Case 33
.head 10 -  ! Incapacidad al 50%
.head 10 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)/2
.head 10 -  Break
.head 9 -  !
.head 9 +  Case 34
.head 10 -  ! Incapacidad al 66%
.head 10 -  Set tbl4.monto= (tbl1.sueldo_mensual / 30)*0.66
.head 10 -  Break
.head 9 -  Default
.head 7 +  On SAM_DropDown
.head 8 -  Call SalListPopulate(colcmbIngDed,hSql6,"select	NOMBRE		FROM	ING_DED
WHERE TIPO='DEDUCCION'")
.head 8 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 5 +  Column: tipo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Tipo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFactura
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: # Factura
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If tbl4.colFactura != NUMBER_Null
.head 9 -  Set nFactura =  tbl4.colFactura 
.head 9 -  Call SqlImmediate( "SELECT MONTO_DEBE FROM FACTURAS INTO :tbl4.monto WHERE COD_FACTURA = :nFactura" )
.head 9 -  Set tbl4.cantidad = NUMBER_Null
.head 9 -  Set tbl4.subtotal = NUMBER_Null
.head 9 -  Call SalTblSetFocusCell( tbl4, lParam, tbl4.cantidad, 0,0 )
.head 9 -  Call SqlClearImmediate(  )
.head 5 +  Column: cantidad
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Cant.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set tbl4.subtotal=tbl4.cantidad * tbl4.monto
.head 5 +  Column: monto
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Monto
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.267"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set tbl4.subtotal=tbl4.cantidad * tbl4.monto
.head 5 +  Column: subtotal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SubTotal
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.15"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: fecha
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsFecha
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Fecha
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: descripcion
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Descripcion
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.983"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: factor
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbAIngDed2
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 6E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChAgregarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.257"
.head 5 -  Top:    4.865"
.head 5 -  Width:  0.567"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbAIngDed2.hWndFila=tbl4.cod_ingded
.head 6 -  Set pbAIngDed2.hWndTabla=tbl4
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 6 -  Set tbl4.colUnico=Identity(600)
.head 6 -  Set tbl4.fecha = dfFin
.head 3 +  Pushbutton: pbBIngDed2
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 6E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChBorrarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.257"
.head 5 -  Top:    5.26"
.head 5 -  Width:  0.567"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbBIngDed2.hWndFila=tbl4.cod_ingded
.head 6 -  Set pbBIngDed2.hWndTabla=tbl4
.head 3 -  !
.head 3 +  Pushbutton: pbActualizar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Actualizar
.head 4 -  Window Location and Size
.head 5 -  Left:   12.883"
.head 5 -  Top:    2.988"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: C:\SGH\icons\Admon.ico
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  !
.head 6 +  If dfEstado = 'CERRADA'
.head 7 -  Call SalMessageBox( 'La planilla no puede ser modificada porque ya esta CERRADA', '.:: Sistema de Gestion Hospitalaria ::.', 0 )
.head 7 -  Return 0
.head 6 -  Set nInicio=-1
.head 6 -  Set bBlanco=FALSE
.head 6 +  While SalTblFindNextRow( tbl2,nInicio,ROW_New | ROW_Edited,0)
.head 7 -  Call SalTblSetContext( tbl2,nInicio)
.head 7 +  If not SalTblQueryRowFlags( tbl2, nInicio, ROW_MarkDeleted )
.head 8 +  If tbl2.colUnico=NUMBER_Null OR tbl2.cod_ingded=NUMBER_Null  OR tbl2.colcmbIngDed='' OR tbl2.tipo='' OR tbl2.cantidad=NUMBER_Null OR tbl2.monto=NUMBER_Null OR tbl2.subtotal=NUMBER_Null  
.head 9 -  Call SalMessageBox( "Columna no puede quedar en blanco", "Advertencia", 0 )
.head 9 -  Set bBlanco=TRUE
.head 9 -  Break
.head 6 -  !
.head 6 -  Set nInicio=-1
.head 6 -  Set bBlanco=FALSE
.head 6 +  While SalTblFindNextRow( tbl4,nInicio,ROW_New | ROW_Edited,0)
.head 7 -  Call SalTblSetContext( tbl4,nInicio)
.head 7 +  If not SalTblQueryRowFlags( tbl4, nInicio, ROW_MarkDeleted )
.head 8 +  If tbl4.colUnico=NUMBER_Null OR tbl4.cod_ingded=NUMBER_Null  OR tbl4.colcmbIngDed='' OR tbl4.tipo='' OR tbl4.cantidad=NUMBER_Null OR tbl4.monto=NUMBER_Null OR tbl4.subtotal=NUMBER_Null  
.head 9 -  Call SalMessageBox( "Columna no puede quedar en blanco", "Advertencia", 0 )
.head 9 -  Set bBlanco=TRUE
.head 9 -  Break
.head 6 -  !
.head 6 +  If not bBlanco
.head 7 -  ! Call SalMessageBox( "No nulo", " No Nulo", 0 )
.head 7 -  Call Salvar_Detalle(  )
.head 3 +  Child Table: tbl3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.883"
.head 6 -  Top:    1.99"
.head 6 -  Width:  12.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: sueldo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sueldo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.217"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: horas_extras
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Horas Ext.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: turnos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Turnos
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Bonificacion
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Bonificación
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: otros_ingresos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Otros Ing.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: Total_Ing
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Total Ing.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: rap
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: RAP
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: seguro
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: IHSS
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: isr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Imp. S/R
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: cooperativa
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Coop.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.867"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col19
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: alimentacion
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Aliment.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: prestamo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prestamo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLaboratorio
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Laboratorio
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMedicamentos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Medicina
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.917"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: otros_egresos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Otros Egre.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ausencia
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ausencias
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: total_egresos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Total Egre.
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: neto
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sueldo Neto
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Right
.head 6 -  Width:  1.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 -  Background Text: Totales :
.head 4 -  Resource Id: 21035
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.845"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: cbQuincena
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Seg. Quincena
.head 4 -  Window Location and Size
.head 5 -  Left:   10.983"
.head 5 -  Top:    -0.012"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbEmpleado
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 6E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChAgregarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    0.619"
.head 5 -  Width:  0.567"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbEmpleado.hWndFila=tbl1.cod_empleado
.head 6 -  Set pbEmpleado.hWndTabla=tbl1
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 3 +  Pushbutton: pbBEmpleado
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 6E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChBorrarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    1.012"
.head 5 -  Width:  0.567"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbBEmpleado.hWndFila=tbl1.cod_empleado
.head 6 -  Set pbBEmpleado.hWndTabla=tbl1
.head 3 -  Background Text: Deducciones
.head 4 -  Resource Id: 45873
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.883"
.head 5 -  Top:    4.24"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Ingresos
.head 4 -  Resource Id: 45874
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.85"
.head 5 -  Top:    2.869"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: Registrar_IngDed
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: cod_empleado
.head 5 -  Number: sueldo
.head 5 -  Date/Time: l_fecha_ingreso
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: COD_INGDED
.head 5 -  Number: nOtro
.head 5 -  Number: nOtro3
.head 5 -  Number: nuevo_sueldo
.head 5 -  Number: Correl
.head 5 -  Number: SEGURO
.head 5 -  Number: RAP
.head 5 -  Number: CANTIDAD
.head 5 -  Number: MONTO
.head 5 -  String: TIPO
.head 4 +  Actions
.head 5 -  Set nuevo_sueldo=  Calcular_Sueldo ( cod_empleado, sueldo,l_fecha_ingreso )
.head 5 +  If nuevo_sueldo=-1
.head 6 -  Return 0
.head 5 -  Call SqlPrepareAndExecute( hSql2, "insert into det_planilla
  values (:dfCod_Planilla,:cod_empleado,0,0,0,0,0,0,0,0,0,0,:nuevo_sueldo,:cmbFormaPago,0,:sueldo,0,0,0,0 ) " )
.head 5 -  Call SqlPrepareAndExecute(hSql2,"commit")
.head 5 -  Call SqlPrepareAndExecute(hSql2,"select cod_ingded,cantidad,monto from INGDED_EMPLEADO where
                       cod_empleado = :cod_empleado into :COD_INGDED, :CANTIDAD,:MONTO ")
.head 5 -  Call SqlFetchNext(hSql2,nOtro)
.head 5 +  While (nOtro!=1)
.head 6 -  Set Correl = Identity( 600 )
.head 6 +  Select Case (COD_INGDED)
.head 7 +  Case 1 ! HORAS ESTRAS
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set HORAS_EXTRAS =
HORAS_EXTRAS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 2 ! BONIFICACIONES
.head 8 -  ! BONIFICACIONEs
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set BONIFICACIONES =
BONIFICACIONES + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 3 ! OTROS INGRESOS
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set OTROS_INGRESOS =
OTROS_INGRESOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 4 ! TURNO A
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set TURNOS =
TURNOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 5 ! TURNO B
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set TURNOS =
TURNOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 6 ! TURNO C
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set TURNOS =
TURNOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 7 ! SEGURO (IHSS)
.head 8 -  Set SEGURO = GetIHSS( sueldo, cmbFormaPago, cbQuincena, nIHSS_TECHO, nIHSS_PORCENTAJE )
.head 8 +  If SEGURO > 0
.head 9 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,1,:SEGURO,:dfFin,' ',:SEGURO) ")
.head 9 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set IHSS =:SEGURO where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 8 ! PRESTAMO
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set PRESTAMO =
PRESTAMO + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 9 ! COOPERATIVA
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set COOPERATIVA =
COOPERATIVA + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 18 ! LABORATORIO
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set LABORATORIO = LABORATORIO + :CANTIDAD * :MONTO
				where cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 19 ! MEDICAMENTOS
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set MEDICAMENTOS = MEDICAMENTOS + :CANTIDAD * :MONTO
				where cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 20 ! PRESTAMO COOPERATIVA
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set PRESTAMO = PRESTAMO + :CANTIDAD * :MONTO
				where cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 21 ! INTERESES S/PRESTAMO COOPERATIVA
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set PRESTAMO = PRESTAMO + :CANTIDAD * :MONTO
				where cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 10 ! AUSENCIAS
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set AUSENCIAS =
AUSENCIAS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 11 ! ALIMENTACION
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set ALIMENTACION =
ALIMENTACION + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 12 ! OTRAS DEDUCCIONES
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set OTROS_EGRESOS =
OTROS_EGRESOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 13 ! IMPUESTO SOBRE LA RENTA
.head 8 +  If (CANTIDAD * MONTO )  >  0
.head 9 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set  ISR=
ISR + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 9 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 9 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',0) ")
.head 9 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Case 32 ! RAP
.head 8 +  If cmbFormaPago='MENSUAL'
.head 9 -  Set RAP=sueldo * 0.015
.head 8 +  Else
.head 9 +  If cbQuincena=TRUE
.head 10 -  Set RAP=sueldo * 0.015
.head 9 +  Else
.head 10 -  Set RAP=0
.head 8 +  If RAP > 0
.head 9 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,1,:RAP,:dfFin,' ',:RAP) ")
.head 9 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set RAP =:RAP where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SqlPrepareAndExecute(hSql4,"select TIPO from ING_DED where
                       cod_ingded = :COD_INGDED into :TIPO ")
.head 8 -  Call SqlFetchNext(hSql4,nOtro3)
.head 8 -  Call SqlPrepareAndExecute(hSql4,"commit")
.head 8 +  If TIPO="INGRESO"
.head 9 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set OTROS_INGRESOS =
OTROS_INGRESOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 9 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute(hSql3,"update det_planilla  set OTROS_EGRESOS =
OTROS_EGRESOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 9 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:Correl,:COD_INGDED,:dfCod_Planilla,:cod_empleado,:CANTIDAD,:MONTO,:dfFin,' ',:CANTIDAD * :MONTO) ")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 6 -  Call SqlFetchNext(hSql2,nOtro)
.head 5 -  Call SqlPrepareAndExecute(hSql2,"commit")
.head 3 +  Function: Calcular_Sueldo
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: cod_empleado
.head 5 -  Number: sueldo
.head 5 -  Date/Time: p_fecha_ingreso
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: fecha_ingreso_empleado
.head 5 -  Number: nOtro2
.head 5 -  Number: pago_por_dia
.head 5 -  Number: dias_trabajados
.head 4 +  Actions
.head 5 -  ! Call SqlPrepareAndExecute( hSql6, "select fecha_ingreso from empleados where 
cod_empleado= :cod_empleado into :fecha_ingreso_empleado " )
.head 5 -  Set fecha_ingreso_empleado = p_fecha_ingreso
.head 5 -  ! Call SqlFetchNext( hSql6, nOtro2 )
.head 5 +  If fecha_ingreso_empleado <= dfInicio
.head 6 +  If cmbFormaPago='QUINCENAL'
.head 7 -  Return (sueldo / 2)
.head 6 +  Else
.head 7 -  Return (sueldo )
.head 5 +  Else
.head 6 +  If fecha_ingreso_empleado <=dfFin
.head 7 -  Set pago_por_dia = sueldo / 30
.head 7 -  Set dias_trabajados = SalDateDay( fecha_ingreso_empleado ) - SalDateDay( dfInicio )
.head 7 -  Return (dias_trabajados * pago_por_dia)
.head 6 +  Else
.head 7 -  Return -1
.head 3 +  Function: Actualizar_Totales
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nColID
.head 4 +  Actions
.head 5 -  Call SalTblSetContext( tbl3, 1 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.sueldo )
.head 5 -  Set tbl3.sueldo = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.horas_extras )
.head 5 -  Set tbl3.horas_extras = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.turnos )
.head 5 -  Set tbl3.turnos = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.Bonificacion )
.head 5 -  Set tbl3.Bonificacion = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.otros_ingresos )
.head 5 -  Set tbl3.otros_ingresos = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.Total_Ing )
.head 5 -  Set tbl3.Total_Ing = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.seguro )
.head 5 -  Set tbl3.seguro= SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.isr )
.head 5 -  Set tbl3.isr = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.cooperativa )
.head 5 -  Set tbl3.cooperativa = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.alimentacion )
.head 5 -  Set tbl3.alimentacion = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.prestamo )
.head 5 -  Set tbl3.prestamo = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.ausencia )
.head 5 -  Set tbl3.ausencia  = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.otros_egresos )
.head 5 -  Set tbl3.otros_egresos  = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.total_egresos )
.head 5 -  Set tbl3.total_egresos  = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.neto )
.head 5 -  Set tbl3.neto   = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.RAP )
.head 5 -  Set tbl3.rap = SalTblColumnSum( tbl1, nColID, 0, 0 )
.head 5 -  ! ****** Agregado ******
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.colLaboratorio )
.head 5 -  Set tbl3.colLaboratorio = SalTblColumnSum(tbl1, nColID, 0, 0 )
.head 5 -  !
.head 5 -  Set nColID = SalTblQueryColumnID( tbl1.colMedicamentos )
.head 5 -  Set tbl3.colMedicamentos = SalTblColumnSum(tbl1, nColID, 0, 0 )
.head 3 +  Function: Salvar_Detalle
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: COD_INGDED
.head 5 -  Number: nOtro
.head 5 -  Number: nOtro3
.head 5 -  Number: cod_empleado
.head 5 -  Number: SEGURO
.head 5 -  Number: RAP
.head 5 -  Number: CANTIDAD
.head 5 -  Number: MONTO
.head 5 -  Number: i
.head 5 -  String: TIPO
.head 4 +  Actions
.head 5 -  Call SqlSetParameter( hSql3, DBP_AUTOCOMMIT, FALSE, STRING_Null )
.head 5 -  Call SqlPrepareAndExecute(hSql3,"BEGIN TRAN ")
.head 5 -  !
.head 5 -  ! Actualizemos primero los ingresos
.head 5 -  Call SqlPrepare(hSql1,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:tbl2.colUnico,:tbl2.cod_ingded,:dfCod_Planilla,:tbl1.cod_empleado,:tbl2.cantidad,:tbl2.monto,
:tbl2.fecha,:tbl2.descripcion,:tbl2.cantidad * :tbl2.monto) ")
.head 5 -  Call SalTblDoInserts( tbl2, hSql1, TRUE )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepare(hSql1,"	update det_planilla_det 
			set 	cod_ingded = :tbl2.cod_ingded,
				cantidad = :tbl2.cantidad,
				monto =:tbl2.monto,
				subtotal=:tbl2.subtotal,
				fecha=:tbl2.fecha,
			descripcion=:tbl2.descripcion
			where correlativo = :tbl2.colUnico")
.head 5 -  Call SalTblDoUpdates( tbl2, hSql1, TRUE )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepare(hSql1,"delete  det_planilla_det 
where correlativo = :tbl2.colUnico")
.head 5 -  Call SalTblDoDeletes( tbl2, hSql1, ROW_MarkDeleted )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  !
.head 5 -  ! Ahora las deducciones
.head 5 -  Call SqlPrepare(hSql1,"insert into det_planilla_det 
(correlativo,cod_ingded,cod_planilla,cod_empleado,cantidad,monto,fecha,
descripcion,subtotal) values
(:tbl4.colUnico,:tbl4.cod_ingded,:dfCod_Planilla,:tbl1.cod_empleado,:tbl4.cantidad,:tbl4.monto,
:tbl4.fecha,:tbl4.descripcion,:tbl4.cantidad * :tbl4.monto) ")
.head 5 -  Call SalTblDoInserts( tbl4, hSql1, FALSE )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepare(hSql1,"	update det_planilla_det 
			set 	cod_ingded = :tbl4.cod_ingded,
				cantidad = :tbl4.cantidad,
				monto =:tbl4.monto,
				subtotal=:tbl4.subtotal,
				fecha=:tbl4.fecha,
			descripcion=:tbl4.descripcion
			where correlativo = :tbl4.colUnico")
.head 5 -  Call SalTblDoUpdates( tbl4, hSql1, FALSE )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  ! !
.head 5 -  Call SqlPrepare(hSql1,"delete  det_planilla_det 
where correlativo = :tbl4.colUnico")
.head 5 -  Call SalTblDoDeletes( tbl4, hSql1, ROW_MarkDeleted )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  !
.head 5 -  ! !Registrar ingreso de los pagos a Facturas
.head 5 -  Call SalTblSetContext(tbl4,0)
.head 5 -  Set i =0
.head 5 +  If tbl4.cod_ingded = 8
.head 6 +  If SalTblQueryRowFlags( tbl4, i, ROW_New | ROW_Edited )
.head 7 -  Call RegistrarPago( tbl4.colUnico,tbl4.colFactura , tbl4.subtotal )
.head 5 +  While SalTblFindNextRow(tbl4,i,0,0)
.head 6 -  Call SalTblSetContext(tbl4,i)
.head 6 +  If tbl4.cod_ingded = 8
.head 7 +  If SalTblQueryRowFlags( tbl4, i, ROW_New | ROW_Edited )
.head 8 -  Call RegistrarPago( tbl4.colUnico, tbl4.colFactura , tbl4.subtotal)
.head 5 -  Call SalTblSetFlagsAnyRows( tbl4, ROW_New | ROW_Edited , FALSE, 0, 0 )
.head 5 -  !
.head 5 -  ! calculamos los datos de la planilla en los totales
.head 5 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set HORAS_EXTRAS=0,
TURNOS=0,OTROS_INGRESOS=0,ALIMENTACION=0,PRESTAMO=0, LABORATORIO=0, MEDICAMENTOS=0,
AUSENCIAS=0,COOPERATIVA=0,OTROS_EGRESOS=0,BONIFICACIONES=0,IHSS=0,
ISR=0, RAP=0
where
cod_planilla=:dfCod_Planilla and cod_empleado = :tbl1.cod_empleado ")
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepareAndExecute(hSql2,"select 
cod_ingded,cantidad,monto,cod_empleado from Det_Planilla_Det  where
                       cod_empleado = :tbl1.cod_empleado and 
cod_planilla = :dfCod_Planilla  into :COD_INGDED, :CANTIDAD,:MONTO,:cod_empleado ")
.head 5 -  Call SqlFetchNext(hSql2,nOtro)
.head 5 -  ! Call
.head 5 +  While (nOtro!=1)
.head 6 +  Select Case (COD_INGDED)
.head 7 +  Case 1 ! HORAS EXTRAS
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set HORAS_EXTRAS =
HORAS_EXTRAS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 2 ! BONIFICACIONES
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set BONIFICACIONES =
BONIFICACIONES + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 3 ! OTROS INGRESOS
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set OTROS_INGRESOS =
OTROS_INGRESOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 4 ! TURNO A
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set TURNOS =
TURNOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 5 ! TURNO B
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set TURNOS =
TURNOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 6 ! TURNO C
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set TURNOS =
TURNOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 7 ! SEGURO (IHSS)
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set IHSS =
IHSS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 8 ! PRESTAMO
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set PRESTAMO =
PRESTAMO + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 9 ! COOPERATIVA
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set COOPERATIVA =
COOPERATIVA + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 10 ! AUSENCIAS
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set AUSENCIAS =
AUSENCIAS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 11 ! ALIMENTACION
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set ALIMENTACION =
ALIMENTACION + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 12 ! OTRAS DEDUCCIONES
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set OTROS_EGRESOS =
OTROS_EGRESOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 13 ! IMPUESTO SOBRE RENTA
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set ISR =
ISR + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 18 ! LABORATORIO
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set LABORATORIO = LABORATORIO + :CANTIDAD * :MONTO
				where cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 19 ! MEDICAMENTOS
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set MEDICAMENTOS = MEDICAMENTOS + :CANTIDAD * :MONTO
				where cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 20 ! PRESTAMO COOPERATIVA
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set PRESTAMO =
PRESTAMO + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 21 ! INTERESES S/PRESTAMO COOPERATIA
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set PRESTAMO =
PRESTAMO + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Case 32 ! RAP
.head 8 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set RAP =
RAP + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Break
.head 7 +  Default
.head 8 -  Call SqlPrepareAndExecute(hSql4,"select TIPO from ING_DED where
                       cod_ingded = :COD_INGDED into :TIPO ")
.head 8 -  Call SqlFetchNext(hSql4,nOtro3)
.head 8 -  Call SqlPrepareAndExecute(hSql4,"commit")
.head 8 +  If TIPO="INGRESO"
.head 9 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set OTROS_INGRESOS =
OTROS_INGRESOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 9 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute(hSql1,"update det_planilla  set OTROS_EGRESOS =
OTROS_EGRESOS + :CANTIDAD * :MONTO  where
cod_planilla=:dfCod_Planilla and cod_empleado = :cod_empleado ")
.head 9 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  Call SqlFetchNext(hSql2,nOtro)
.head 5 -  Call SqlPrepareAndExecute(hSql2,"commit")
.head 5 -  Call SqlPrepareAndExecute(hSql3,"COMMIT TRAN ")
.head 5 -  Call SqlPrepareAndExecute(hSql1," 
select 

A.horas_extras,A.turnos,A.bonificaciones,
A.otros_ingresos,round(A.sueldo_pagado + A.horas_extras + A.bonificaciones + A.otros_ingresos+A.turnos,2),
A.rap,A.ihss,A.laboratorio,A.medicamentos,A.isr,A.cooperativa,A.alimentacion,A.prestamo,A.ausencias,A.otros_egresos,
round(A.rap+A.ihss+A.isr+A.cooperativa+A.alimentacion+A.prestamo+A.ausencias+A.otros_egresos+A.laboratorio+A.medicamentos,2), 
round(A.sueldo_pagado + A.horas_extras + A.bonificaciones + A.otros_ingresos+A.turnos,2) - 
round(A.rap+A.ihss+A.isr+A.cooperativa+A.alimentacion+A.prestamo+A.ausencias+A.otros_egresos+A.laboratorio+A.medicamentos,2)
from DET_PLANILLA A, EMPLEADOS B where A.COD_EMPLEADO=B.COD_EMPLEADO and
A.COD_PLANILLA = :dfCod_Planilla and A.COD_EMPLEADO=:tbl1.cod_empleado

into 
:tbl1.horas_extras,:tbl1.turnos,:tbl1.Bonificacion,:tbl1.otros_ingresos,:tbl1.Total_Ing, :tbl1.RAP,
:tbl1.seguro,:tbl1.colLaboratorio,:tbl1.colMedicamentos,:tbl1.isr,:tbl1.cooperativa,:tbl1.alimentacion,:tbl1.prestamo,:tbl1.ausencia,:tbl1.otros_egresos,
:tbl1.total_egresos,:tbl1.neto

")
.head 5 -  Call SqlFetchNext( hSql1, nSiguiente )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call Actualizar_Totales(  )
.head 5 -  Call SqlSetParameter( hSql3, DBP_AUTOCOMMIT, TRUE, STRING_Null )
.head 3 +  Function: PopulateFactEmpleado
.head 4 -  Description: Fucion creda para obtener las Facturas Pendientes de pago de un Empleado
By Elvin Deras 08/Ene/2016
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: P_COD_EMPLEADO
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalListPopulate( tbl4.colFactura, hSql1, "select 
	f.COD_FACTURA
from 
	facturas f 
	  inner join autorizacion_pago ap on f.COD_AUTORIZACION = ap.COD_AUTORIZACION
where 
	ap.COD_EMPLEADO = :P_COD_EMPLEADO
	AND f.MONTO_DEBE > 0" )
.head 3 +  Function: RegistrarPago
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: P_Correlativo
.head 5 -  Number: P_Factura
.head 5 -  Number: P_Monto
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bExists
.head 4 +  Actions
.head 5 -  Call SqlExists( "
SELECT
	COD_FACTURA
FROM
	DET_PLANILLA_DET_PE WHERE CORRELATIVO = :P_Correlativo", bExists)
.head 5 -  ! !
.head 5 +  If not bExists
.head 6 +  If P_Factura != NUMBER_Null
.head 7 +  If SqlPrepareAndExecute(hSql3, "INSERT INTO DET_PLANILLA_DET_PE
	(CORRELATIVO, COD_FACTURA, MONTO)
VALUES 
	(:P_Correlativo, :P_Factura, :P_Monto)")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"COMMIT")
.head 5 +  Else
.head 6 -  ! ! Significa que habia una factura luego dejo vacio el valor
.head 6 +  If P_Factura = NUMBER_Null
.head 7 +  If SqlPrepareAndExecute(hSql3, "DELETE FROM DET_PLANILLA_DET_PE WHERE CORRELATIVO = :P_Correlativo")
.head 8 -  Call SqlPrepareAndExecute(hSql3, "COMMIT")
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute(hSql3, "
UPDATE DET_PLANILLA_DET_PE 
SET 
	COD_FACTURA = :P_Factura,
	MONTO = :P_Monto
WHERE 
	CORRELATIVO = :P_Correlativo")
.head 8 -  Call SqlPrepareAndExecute(hSql3,"COMMIT")
.head 3 +  Function: GenerarPartida
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: P_CodPartida
.head 5 -  String: P_Descripcion
.head 5 -  Date/Time: P_Fecha
.head 5 -  Number: P_Monto
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sCuentaDebe
.head 5 -  String: sNombreCuentaDebe
.head 5 -  String: sCuentaHaber
.head 5 -  String: sNombreCuentaHaber
.head 5 -  Number: nCorrelativo
.head 5 -  Number: nCorrelativo2
.head 4 +  Actions
.head 5 -  ! CAJA GENERAL
.head 5 -  Set sCuentaDebe = '111-01'
.head 5 -  Set sNombreCuentaDebe = 'CAJA GENERAL'
.head 5 -  ! !
.head 5 -  ! FACTURACION - Pendiente Confirmar si e usara una cuenta por empleado
.head 5 -  ! Set sCuentaHaber = '113-04-' || SalNumberToStrX(nCodEmpleado, 0) || '-01'
.head 5 -  ! Set sNombreCuentaHaber = 'FACTURACION'
.head 5 -  ! !Se usa la cuenta de Cliente
.head 5 -  ! !
.head 5 -  ! CLENTES
.head 5 -  Set sCuentaHaber = '113-10'
.head 5 -  Set sNombreCuentaHaber = 'CLIENTES'
.head 5 -  ! !
.head 5 -  Set nCorrelativo =  Identity(2)
.head 5 -  Set nCorrelativo2 =  Identity(2)
.head 5 +  If SqlPrepareAndExecute(hSql3,"
insert INTO PARTIDAS (
	COD_PARTIDA,
	DESCRIPCION,
	FECHA,
	COD_TIPO,
	TOTAL_CARGO,
	TOTAL_DEBITO,
	ESTADO, SUMARIZADA,CERRADA
)
values(
	:P_CodPartida,
	:P_Descripcion ,
	:P_Fecha,
	10 ,
	:P_Monto,
	:P_Monto,
	0,0,0)") 
AND
SqlPrepareAndExecute(hSql3,"
insert into
DET_PARTIDAS (
	COD_PARTIDA ,
	COD_CUENTA,
	NOMBRE,
	CARGO,
	CONCEPTO,
	CORRELATIVO)
values(
	:P_CodPartida,
	:sCuentaDebe,
	:sNombreCuentaDebe,
	:P_Monto,
	:P_Descripcion,
	:nCorrelativo)") 
AND 
SqlPrepareAndExecute(hSql3,"
	insert into
	DET_PARTIDAS (
		COD_PARTIDA ,
		COD_CUENTA,
		NOMBRE,
		CREDITO,
		CONCEPTO,
		CORRELATIVO)
	values(
		:P_CodPartida,
		:sCuentaHaber,
		:sNombreCuentaHaber,
		:P_Monto,
		:P_Descripcion,
		:nCorrelativo2)")  
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: COD_EMPLEADO
.head 3 -  Number: SUELDO
.head 3 -  Number: linea
.head 3 -  String: TIPO
.head 3 -  String: sObs
.head 3 -  String: fechaI
.head 3 -  String: fechaF
.head 3 -  Date/Time: G_FECHA_INGRESO
.head 3 -  Number: nRegresa
.head 3 -  String: SQ
.head 3 -  Number: nSig
.head 3 -  String: sEstado
.head 3 -  Number: nResp
.head 3 -  Number: nInicio
.head 3 -  Boolean: bBlanco
.head 3 -  Window Handle: nFila
.head 3 -  String: sValues[3]
.head 3 -  Number: nIHSS_TECHO
.head 3 -  Number: nIHSS_PORCENTAJE
.head 3 -  Number: nFactura
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalListAdd( cmbFormaPago, 'QUINCENAL' )
.head 4 -  Call SalListAdd( cmbFormaPago, 'MENSUAL' )
.head 4 -  Call SalDisableWindow( tbl2 )
.head 4 -  Call SalDisableWindow( tbl4 )
.head 4 -  Call SalDisableWindow( pbAIngDed )
.head 4 -  Call SalDisableWindow( pbBIngDed )
.head 4 -  Call SalDisableWindow( pbAIngDed2 )
.head 4 -  Call SalDisableWindow( pbBIngDed2)
.head 4 -  Call SalTblInsertRow( tbl3, linea )
.head 4 -  Call SalTblSetLockedColumns( tbl1, 3 )
.head 4 -  Call GetParameterValues( 'PLANILLA_IHSS', sValues[0], sValues[1], sValues[2] )
.head 4 -  Set nIHSS_TECHO = SalStrToNumber( sValues[0] )
.head 4 -  Set nIHSS_PORCENTAJE = SalStrToNumber( sValues[1] ) / 100
.head 3 +  On MU_GRABAR
.head 4 -  Call SqlExists("Select	COD_PLANILLA
from	PLANILLA
where	COD_PLANILLA=:dfCod_Planilla ",bExists)
.head 4 -  Call SqlClearImmediate(  )
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 +  If bExists
.head 5 +  If dfEstado = 'CERRADA'
.head 6 -  Call SalMessageBox( 'La planilla no puede ser modificada porque ya esta CERRADA', '.:: Sistema de Gestion Hospitalaria ::.', 0 )
.head 6 -  Call SalWaitCursor( FALSE)
.head 6 -  Return 0
.head 5 -  ! Call Salvar_Detalle(  )
.head 5 -  ! Call SqlPrepareAndExecute(hSql1,"begin tran")
.head 5 -  ! Call SqlPrepareAndExecute(hSql1,"select cod_empleado,sueldo_base,fecha_ingreso from empleados where
forma_pago=:cmbFormaPago and estado=0 and cod_empleado not in
(select cod_empleado from det_planilla where cod_planilla=:dfCod_Planilla )
 into :COD_EMPLEADO,:SUELDO, :G_FECHA_INGRESO ")
.head 5 -  ! Call SqlFetchNext( hSql1, nSiguiente )
.head 5 +  ! While (nSiguiente!=1)
.head 6 -  Call Registrar_IngDed(COD_EMPLEADO,SUELDO,G_FECHA_INGRESO)
.head 6 -  Call SqlFetchNext( hSql1, nSiguiente )
.head 5 -  ! Call SqlPrepareAndExecute(hSql1,"commit tran")
.head 5 -  ! Call SalWaitCursor( FALSE )
.head 5 -  ! If
.head 5 +  ! Else
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepare( hSql1, "insert into det_planilla
  values (:dfCod_Planilla,:tbl1.cod_empleado,
0,0,0,0,0,0,0,0,0,0,:tbl1.sueldo,:cmbFormaPago,0,:tbl1.sueldo_mensual,0,0,0,0 ) "  )
.head 5 -  Call SalTblDoInserts( tbl1, hSql1 , TRUE )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepare( hSql1, "update det_planilla set sueldo_pagado=:tbl1.sueldo where
cod_planilla=:dfCod_Planilla and
cod_empleado=:tbl1.cod_empleado     " )
.head 5 -  Call SalTblDoUpdates( tbl1, hSql1, TRUE )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepare( hSql1, "delete from det_planilla where cod_planilla=:dfCod_Planilla and
cod_empleado=:tbl1.cod_empleado " )
.head 5 -  Call SalTblDoDeletes( tbl1, hSql1, ROW_MarkDeleted )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SalSendMsg( frmPlanilla, MU_ACTUALIZAR, 0, 0 )
.head 5 -  Call SalWaitCursor( FALSE)
.head 4 +  Else
.head 5 +  If cbQuincena=TRUE
.head 6 -  Set SQ='T'
.head 5 +  Else
.head 6 -  Set SQ='F'
.head 5 -  Call SqlPrepareAndExecute(hSql2,"begin tran")
.head 5 -  Call SqlPrepareAndExecute(hSql1,"insert into planilla 
(cod_planilla,descripcion,tipo,fechaI,fechaf,estado,segundaquincena)  
 values (:dfCod_Planilla,:dfDescripcion,:cmbFormaPago,:dfInicio,:dfFin,'EN PROCESO',:SQ ) ")
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepareAndExecute(hSql1,"select cod_empleado,sueldo_base,fecha_ingreso from empleados where
forma_pago=:cmbFormaPago and estado=0 into :COD_EMPLEADO,:SUELDO,:G_FECHA_INGRESO ")
.head 5 -  Call SqlFetchNext( hSql1, nSiguiente )
.head 5 +  While (nSiguiente!=1)
.head 6 -  Call Registrar_IngDed(COD_EMPLEADO,SUELDO,G_FECHA_INGRESO)
.head 6 -  Call SqlFetchNext( hSql1, nSiguiente )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepareAndExecute(hSql2,"commit tran")
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  On MU_ACTUALIZAR
.head 4 -  Call SqlExists("Select	COD_PLANILLA
from	PLANILLA
where	COD_PLANILLA=:dfCod_Planilla ",bExists)
.head 4 -  Call SqlClearImmediate(  )
.head 4 +  If bExists
.head 5 -  Call SqlPrepareAndExecute( hSql1, "select descripcion,tipo,fechaI,fechaF,estado,segundaquincena from
planilla where cod_planilla=:dfCod_Planilla into :dfDescripcion,:cmbFormaPago ,
:dfInicio,:dfFin, :dfEstado,:SQ  " )
.head 5 -  Call SqlFetchNext( hSql1, nSiguiente )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SalTblPopulate( tbl1, hSql1, "select 
A.cod_empleado,B.Primer_Nom + ' ' + B.Primer_Ape,
A.sueldo_pagado,A.horas_extras,A.turnos,A.bonificaciones,
A.otros_ingresos,round(A.sueldo_pagado + A.horas_extras + A.bonificaciones + A.otros_ingresos+A.turnos,2),
A.rap,A.ihss,A.laboratorio,A.medicamentos,A.isr,A.cooperativa,A.alimentacion,A.prestamo,A.ausencias,A.otros_egresos,
round(A.ihss+A.rap+A.isr+A.cooperativa+A.alimentacion+A.prestamo+A.ausencias+A.otros_egresos+A.laboratorio+A.medicamentos,2), 
round(A.sueldo_pagado + A.horas_extras + A.bonificaciones + A.otros_ingresos+A.turnos,2) - 
round(A.rap+A.ihss+A.isr+A.cooperativa+A.alimentacion+A.prestamo+A.ausencias+A.otros_egresos+A.laboratorio+A.medicamentos,2),

A.sueldo_mensual

from DET_PLANILLA A, EMPLEADOS B where A.COD_EMPLEADO=B.COD_EMPLEADO and
A.COD_PLANILLA = :dfCod_Planilla order by B.Primer_Nom

", TBL_FillAll )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call Actualizar_Totales(  )
.head 5 +  If SQ='T'
.head 6 -  Set cbQuincena=TRUE
.head 5 +  Else
.head 6 -  Set cbQuincena=FALSE
.head 3 +  On MU_BORRAR
.head 4 +  If dfEstado = 'CERRADA'
.head 5 -  Call SalMessageBox( 'La planilla no puede ser modificada porque ya esta CERRADA', '.:: Sistema de Gestion Hospitalaria ::.', 0 )
.head 5 -  Return 0
.head 4 -  ! !
.head 4 -  Call SqlPrepareAndExecute( hSql1, "delete from det_planilla_det where cod_planilla=:dfCod_Planilla" )
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SqlPrepareAndExecute( hSql1, "delete from det_planilla where cod_planilla=:dfCod_Planilla" )
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SqlPrepareAndExecute( hSql1, "delete from planilla where cod_planilla=:dfCod_Planilla" )
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 1 +  Form Window: frmPlanillaAdi
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Elaboración de Planillas
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    0.688"
.head 4 -  Width:  13.533"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.286"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.595"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pbAgregar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMas
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbAgregar.nOpcionh=1
.head 7 -  Set pbAgregar.hWndCampo=dfCod_Planilla
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 7 -  Call SqlPrepareAndExecute(hSql1,'select max(COD_PLANILLA) FROM PLANILLA  into
			 :dfCod_Planilla')
.head 7 -  Call SqlFetchNext(hSql1,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 7 +  If dfCod_Planilla=NUMBER_Null
.head 8 -  Set dfCod_Planilla=1
.head 7 +  Else
.head 8 -  Set dfCod_Planilla=dfCod_Planilla +1
.head 4 +  Pushbutton: pbEliminar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMenos
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbEliminar.nOpcionh=1
.head 7 -  Set pbEliminar.sTitulo=' La Planilla '
.head 4 +  Pushbutton: pbGrabar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbGrabar
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbBuscar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbBusqueda
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlgConsultaPlanilla, hWndForm,nRegresa)
.head 7 +  If nRegresa!=NUMBER_Null
.head 8 -  Set dfCod_Planilla =nRegresa
.head 8 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 4 +  Pushbutton: pbSalir
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbCerrar
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbBusqueda
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Cerrar
.head 5 -  Window Location and Size
.head 6 -  Left:   3.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: C:\SGH\icons\cerrar.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 -  On SAM_Click
.head 4 +  Pushbutton: pb9
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbImprimir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set fechaI= SalFmtFormatDateTime(dfInicio,"dd/MM/yyyy")
.head 7 -  Set fechaF= SalFmtFormatDateTime(dfFin ,"dd/MM/yyyy")
.head 7 -  Set sObs="PLANILLA " || cmbFormaPago || "  De la Fecha " || fechaI || "   a la Fecha  " ||  fechaF
.head 7 -  Call SalCreateWindow( frmImprimir, hWndForm,
cmbSubTipo,
strRepPath || "\\PLANILLA_ADI.QRP",
":n1,:s1,:s2,:s3,:s4,:n2,:n3",

" A.cod_empleado, B.Primer_Nom, B.Segundo_Nom,B.Primer_Ape,B.Segundo_Ape,A.sueldo_mensual,
A.sueldo_pagado",

"select	A.cod_empleado, B.Primer_Nom, B.Segundo_Nom,B.Primer_Ape,B.Segundo_Ape,A.sueldo_mensual,
A.sueldo_pagado
                


from	DET_PLANILLA A, EMPLEADOS B
where	A.cod_empleado=B.cod_empleado and A.cod_planilla=:frmPlanillaAdi.dfCod_Planilla

ORDER BY  B.Primer_Nom

into      :n1,:s1,:s2,:s3,:s4,:n2,:n3",

sObs,FALSE)
.head 2 +  Contents
.head 3 -  Background Text: Numero Planilla:
.head 4 -  Resource Id: 48126
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.179"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCod_Planilla
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlExists("Select	SUBTIPO
from	PLANILLA
where	COD_PLANILLA=:dfCod_Planilla into :TIPO ",bExists)
.head 6 -  Call SqlClearImmediate(  )
.head 6 +  If bExists
.head 7 -  Call SalSendMsg( frmPlanillaAdi, MU_ACTUALIZAR, 0, 0 )
.head 3 +  Combo Box: cmbFormaPago
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.35"
.head 5 -  Top:    0.179"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.726"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text: Tipo
.head 4 -  Resource Id: 48127
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.783"
.head 5 -  Top:    0.179"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Fecha Inicio
.head 4 -  Resource Id: 48128
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.517"
.head 5 -  Top:    0.226"
.head 5 -  Width:  1.067"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfInicio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.717"
.head 6 -  Top:    0.202"
.head 6 -  Width:  1.467"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Fecha Fin
.head 4 -  Resource Id: 48129
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.383"
.head 5 -  Top:    0.25"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.383"
.head 6 -  Top:    0.226"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Descripción
.head 4 -  Resource Id: 48130
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    0.512"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDescripcion
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.488"
.head 6 -  Width:  9.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Estado
.head 4 -  Resource Id: 48131
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   11.383"
.head 5 -  Top:    0.262"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold-Underline
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfEstado
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.983"
.head 6 -  Top:    0.488"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.783"
.head 6 -  Top:    1.321"
.head 6 -  Width:  11.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: cod_empleado
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Codigo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: nombres
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nombre
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.717"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: sueldo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sueldo
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMeses
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Fecha Ing.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.583"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd/mm/yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMonto
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Monto a Pagar
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.583"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call Actualizar_Totales(  )
.head 5 +  Column: colMes
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Meses
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #0
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If tbl1.colMes  >= 12
.head 9 -  Set tbl1.colMonto=tbl1.sueldo
.head 8 +  Else
.head 9 -  Set tbl1.colMonto = ((tbl1.sueldo*tbl1.colMes) /12 )
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSubTipo
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.617"
.head 5 -  Top:    0.869"
.head 5 -  Width:  3.567"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text: Sub Tipo
.head 4 -  Resource Id: 48133
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.683"
.head 5 -  Top:    0.869"
.head 5 -  Width:  0.867"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTotalSueldo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.783"
.head 6 -  Top:    4.988"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 3 +  Data Field: dfTotalMonto
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.983"
.head 6 -  Top:    4.988"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On MU_REVISAR
.head 6 -  Return TRUE
.head 3 +  Pushbutton: pbDetalle
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Actualizar Detalle
.head 4 -  Window Location and Size
.head 5 -  Left:   8.383"
.head 5 -  Top:    0.988"
.head 5 -  Width:  3.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cmbSubTipo = ''
.head 7 -  Call SalMessageBox( 'No se puede modificar esta planilla en esta ventana', 'No se puede modificar esta planilla en esta ventana', MB_Ok )
.head 6 +  Else
.head 7 -  Call SqlPrepare( hSql1, "update det_planilla set sueldo_pagado = :tbl1.colMonto where
cod_empleado=:tbl1.cod_empleado and cod_planilla = :dfCod_Planilla  " )
.head 7 -  Call SalTblDoUpdates( tbl1, hSql1, TRUE )
.head 7 -  Call SqlPrepareAndExecute( hSql1, " commit" )
.head 7 -  Call SalSendMsg( frmPlanillaAdi, MU_ACTUALIZAR, 0, 0 )
.head 2 +  Functions
.head 3 +  Function: Registrar_IngDed
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: cod_empleado
.head 5 -  Number: sueldo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: COD_INGDED
.head 5 -  Number: nOtro
.head 5 -  Number: nOtro3
.head 5 -  Number: nuevo_sueldo
.head 5 -  Number: Correl
.head 5 -  Number: SEGURO
.head 5 -  Number: CANTIDAD
.head 5 -  Number: MONTO
.head 5 -  String: TIPO
.head 5 -  Number: meses
.head 4 +  Actions
.head 5 -  Set nuevo_sueldo=  Calcular_Sueldo ( cod_empleado  ,sueldo,meses )
.head 5 +  If nuevo_sueldo=-1
.head 6 -  Return 0
.head 5 -  Call SqlPrepareAndExecute( hSql2, "insert into det_planilla
  values (:dfCod_Planilla,:cod_empleado,0,0,0,0,0,0,0,0,0,0,:nuevo_sueldo,:cmbFormaPago,0,:sueldo,:meses ) " )
.head 5 -  Call SqlPrepareAndExecute(hSql2,"commit")
.head 3 +  Function: Calcular_Sueldo
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: cod_empleado
.head 5 -  Number: sueldo
.head 5 -  Receive Number: meses
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: fecha_ingreso_empleado
.head 5 -  Number: nOtro2
.head 5 -  Number: pago_por_dia
.head 5 -  Number: meses_trabajados
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute( hSql3, "select fecha_ingreso from empleados where 
cod_empleado= :cod_empleado into :fecha_ingreso_empleado " )
.head 5 -  Call SqlFetchNext( hSql3, nOtro2 )
.head 5 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 5 +  If fecha_ingreso_empleado <= dfInicio
.head 6 -  Set meses_trabajados = Calcular_Meses(fecha_ingreso_empleado,dfInicio)
.head 6 -  Set meses=meses_trabajados
.head 6 +  If meses_trabajados >= 12
.head 7 -  Return (sueldo)
.head 6 +  Else
.head 7 -  Return ((sueldo*meses_trabajados) /12 )
.head 5 +  Else
.head 6 -  Return (-1)
.head 3 +  Function: Actualizar_Totales
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfTotalSueldo = SalTblColumnSum( tbl1, 3, 0, 0 )
.head 5 -  Set dfTotalMonto = SalTblColumnSum( tbl1, 5, 0, 0 )
.head 3 +  Function: Calcular_Meses
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: fecha_I
.head 5 -  Date/Time: fecha_F
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: anos_I
.head 5 -  Number: Meses_I
.head 5 -  Number: Dias_I
.head 5 -  Number: anos_F
.head 5 -  Number: Meses_F
.head 5 -  Number: Dias_F
.head 4 +  Actions
.head 5 -  Set anos_I= SalDateYear( fecha_I )
.head 5 -  Set anos_F= SalDateYear( fecha_F )
.head 5 -  Set Meses_I= SalDateMonth( fecha_I )
.head 5 -  Set Meses_F= SalDateMonth( fecha_F )
.head 5 +  If anos_I=anos_F
.head 6 -  Return (Meses_F-Meses_I+1)
.head 5 +  Else
.head 6 +  If Meses_I <= Meses_F
.head 7 -  Return (   ((anos_F-anos_I)*12) +( Meses_F-Meses_I))
.head 6 +  Else
.head 7 -  Return (   ((anos_F-anos_I)*12) -( Meses_I-Meses_F))
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: COD_EMPLEADO
.head 3 -  Number: SUELDO
.head 3 -  Number: linea
.head 3 -  String: sObs
.head 3 -  String: fechaI
.head 3 -  String: fechaF
.head 3 -  String: TIPO
.head 3 -  Number: nRegresa
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalListAdd( cmbFormaPago, 'QUINCENAL' )
.head 4 -  Call SalListAdd( cmbFormaPago, 'MENSUAL' )
.head 4 -  Call SalListAdd( cmbSubTipo, 'AGUINALDO' )
.head 4 -  Call SalListAdd( cmbSubTipo, 'CATORCEAVO' )
.head 3 +  On MU_GRABAR
.head 4 -  Call SqlExists("Select	COD_PLANILLA
from	PLANILLA
where	COD_PLANILLA=:dfCod_Planilla ",bExists)
.head 4 -  Call SqlClearImmediate(  )
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 +  If bExists
.head 5 -  Call SqlPrepareAndExecute(hSql2,"begin tran")
.head 5 -  Call SqlPrepareAndExecute(hSql1,"select cod_empleado,sueldo_base from empleados where
forma_pago=:cmbFormaPago and estado=0 and cod_empleado not in
(select cod_empleado from det_planilla where cod_planilla=:dfCod_Planilla )
 into :COD_EMPLEADO,:SUELDO ")
.head 5 -  Call SqlFetchNext( hSql1, nSiguiente )
.head 5 +  While (nSiguiente!=1)
.head 6 -  Call Registrar_IngDed(COD_EMPLEADO,SUELDO)
.head 6 -  Call SqlFetchNext( hSql1, nSiguiente )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepareAndExecute(hSql2,"commit tran")
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  ! If
.head 5 +  ! Else
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 +  Else
.head 5 -  Call SqlPrepareAndExecute(hSql2,"begin tran")
.head 5 -  Call SqlPrepareAndExecute(hSql1,"insert into planilla 
(cod_planilla,descripcion,tipo,fechaI,fechaf,estado,subtipo)  
 values (:dfCod_Planilla,:dfDescripcion,:cmbFormaPago,:dfInicio,:dfFin,'EN PROCESO',:cmbSubTipo ) ")
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepareAndExecute(hSql1,"select cod_empleado,sueldo_base from empleados where
forma_pago=:cmbFormaPago and estado=0 into :COD_EMPLEADO,:SUELDO ")
.head 5 -  Call SqlFetchNext( hSql1, nSiguiente )
.head 5 +  While (nSiguiente!=1)
.head 6 -  Call Registrar_IngDed(COD_EMPLEADO,SUELDO)
.head 6 -  Call SqlFetchNext( hSql1, nSiguiente )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepareAndExecute(hSql2,"commit tran")
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  On MU_ACTUALIZAR
.head 4 -  Call SqlExists("Select	COD_PLANILLA
from	PLANILLA
where	COD_PLANILLA=:dfCod_Planilla ",bExists)
.head 4 -  Call SqlClearImmediate(  )
.head 4 +  If bExists
.head 5 -  Call SqlPrepareAndExecute( hSql1, "select descripcion,tipo,fechaI,fechaF,estado,subtipo from
planilla where cod_planilla=:dfCod_Planilla into :dfDescripcion,:cmbFormaPago ,
:dfInicio,:dfFin, :dfEstado,:cmbSubTipo  " )
.head 5 -  Call SqlFetchNext( hSql1, nSiguiente )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SalTblPopulate( tbl1, hSql1, "  select 
A.cod_empleado,B.Primer_Nom + ' ' + B.Primer_Ape,
A.sueldo_mensual,convert(varchar(10),B.fecha_ingreso,103),A.sueldo_pagado,A.meses
from DET_PLANILLA A, EMPLEADOS B where A.COD_EMPLEADO=B.COD_EMPLEADO and
A.COD_PLANILLA = :dfCod_Planilla

", TBL_FillAll )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call Actualizar_Totales(  )
.head 3 +  On MU_BORRAR
.head 4 +  If dfEstado !="CERRADA"
.head 5 -  Call SqlPrepareAndExecute( hSql1, "delete from det_planilla_det where cod_planilla=:dfCod_Planilla" )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepareAndExecute( hSql1, "delete from det_planilla where cod_planilla=:dfCod_Planilla" )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SqlPrepareAndExecute( hSql1, "delete from planilla where cod_planilla=:dfCod_Planilla" )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 1 +  Dialog Box: dlgConsultaPlanilla
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Consulta de Planillas
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.1"
.head 4 -  Top:    0.583"
.head 4 -  Width:  12.933"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.095"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    1.405"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.917"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCod_Planilla
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Codigo
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #0
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDescripcion
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Descripcion
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colForma_Pago
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Forma Pag.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.367"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSubtipo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SubTipo
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFechaI
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsFecha
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Fecha I.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd/mm/yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFechaF
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsFecha
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Fecha F.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd/mm/yyyy
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colEstado
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Estado
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.467"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFilita
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalTblQueryFocus(tbl1,nFilita,tbl1.colCod_Planilla)
.head 6 -  Call SalTblSetContext(tbl1,nFilita)
.head 6 -  Set nRegresa=tbl1.colCod_Planilla
.head 6 -  Call SalEndDialog(dlgConsultaPlanilla,TRUE)
.head 3 -  Group Box: Criterios de Busqueda
.head 4 -  Resource Id: 20656
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.071"
.head 5 -  Width:  12.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbSalir
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.983"
.head 5 -  Top:    0.321"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbBusqueda
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.783"
.head 5 -  Top:    0.321"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalTblPopulate( tbl1, hSql1, ArmarQuery(), TBL_FillAll)
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  Set dfTotal=ContarFilas( tbl1 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 3 +  Data Field: dfOculto
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    4.905"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Posicionese sobre el Paciente en Particular y presione doble click para cargarlo
.head 4 -  Resource Id: 20657
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.583"
.head 5 -  Top:    5.595"
.head 5 -  Width:  8.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Total
.head 4 -  Resource Id: 20658
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.483"
.head 5 -  Top:    4.429"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTotal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.183"
.head 6 -  Top:    4.405"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: #0
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbLimpia
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.583"
.head 5 -  Top:    0.321"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Inicio
.head 4 -  Resource Id: 20659
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.55"
.head 5 -  Top:    0.452"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Fin
.head 4 -  Resource Id: 20660
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.617"
.head 5 -  Top:    0.476"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.017"
.head 6 -  Top:    0.452"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Forma de Pago
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 20661
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.55"
.head 5 -  Top:    0.452"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbFormaPago
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.95"
.head 5 -  Top:    0.429"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.726"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Data Field: dfInicio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.117"
.head 6 -  Top:    0.452"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbSubTipo
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.083"
.head 5 -  Top:    0.81"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.036"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Background Text: Sub Tipo
.head 4 -  Resource Id: 20662
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.15"
.head 5 -  Top:    0.81"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: ArmarQuery
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sConsulta
.head 4 +  Actions
.head 5 -  Set sConsulta="Select  A.cod_planilla,A.descripcion,A.tipo,A.subtipo,
		   convert(varchar(10),A.fechaI,103),   convert(varchar(10),A.fechaF,103),
		  A.ESTADO
		

		from	PLANILLA A

		where	A.COD_PLANILLA > 0

"
			
.head 5 +  If dfInicio!=DATETIME_Null
.head 6 -  Set sConsulta=sConsulta||"	and	A.FECHAI>=:dlgConsultaPlanilla.dfInicio"
.head 5 +  If dfFin!=DATETIME_Null
.head 6 -  Set sConsulta=sConsulta||"	and	A.FECHAI<=:dlgConsultaPlanilla.dfFin"
.head 5 +  If cmbFormaPago!=''
.head 6 -  Set sConsulta = sConsulta || "  and A.TIPO = :dlgConsultaPlanilla.cmbFormaPago "
.head 5 +  If cmbSubTipo!=''
.head 6 -  Set sConsulta = sConsulta || "  and A.SUBTIPO = :dlgConsultaPlanilla.cmbSubTipo "
.head 5 -  Set sConsulta=sConsulta||"	order	by	A.COD_PLANILLA"
.head 5 -  Set sConsulta2=sConsulta
.head 5 -  Return sConsulta
.head 2 +  Window Parameters
.head 3 -  Receive Number: nRegresa
.head 2 +  Window Variables
.head 3 -  String: sConsulta2
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalListAdd( cmbFormaPago, 'QUINCENAL' )
.head 4 -  Call SalListAdd( cmbFormaPago, 'MENSUAL' )
.head 4 -  Call SalListAdd( cmbSubTipo, 'AGUINALDO' )
.head 4 -  Call SalListAdd( cmbSubTipo, 'CATORCEAVO' )
.head 4 -  Call SalListAdd( cmbSubTipo, 'NORMAL' )
.head 1 +  Dialog Box: dlgISR
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Calculo de ISR
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.975"
.head 4 -  Top:    1.188"
.head 4 -  Width:  6.386"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.905"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Bold
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Sueldo :
.head 4 -  Resource Id: 24137
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.262"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSueldo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.183"
.head 6 -  Top:    0.238"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call Calcular(  )
.head 3 -  Background Text: X 12 =
.head 4 -  Resource Id: 24138
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.783"
.head 5 -  Top:    0.262"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAnual
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    0.238"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: (menos)
.head 4 -  Resource Id: 24139
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.483"
.head 5 -  Top:    0.619"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfBase
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    0.571"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call Calcular(  )
.head 3 -  Background Text: SubTotal
.head 4 -  Resource Id: 24140
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.55"
.head 5 -  Top:    0.976"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSubTotal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    0.905"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: 30,000 x 10%
.head 4 -  Resource Id: 24141
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.586"
.head 5 -  Top:    1.762"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Resto x 15%
.head 4 -  Resource Id: 24142
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.286"
.head 5 -  Top:    1.762"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTreinta
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.486"
.head 6 -  Top:    1.405"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfResto
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.186"
.head 6 -  Top:    1.405"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPTreinta
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.486"
.head 6 -  Top:    2.071"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPResto
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.186"
.head 6 -  Top:    2.071"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: =
.head 4 -  Resource Id: 24143
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.914"
.head 5 -  Top:    2.143"
.head 5 -  Width:  0.171"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: +
.head 4 -  Resource Id: 24144
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.043"
.head 5 -  Top:    2.083"
.head 5 -  Width:  0.171"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFinal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.086"
.head 6 -  Top:    2.071"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Aceptar
.head 4 -  Window Location and Size
.head 5 -  Left:   4.086"
.head 5 -  Top:    3.155"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRetorno=dfRetorno
.head 6 -  Call SalEndDialog(dlgISR,TRUE)
.head 3 +  Data Field: dfMeses
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.186"
.head 6 -  Top:    2.405"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: /
.head 4 -  Resource Id: 24145
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.843"
.head 5 -  Top:    2.5"
.head 5 -  Width:  0.243"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfRetorno
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfNumero
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.086"
.head 6 -  Top:    2.738"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Calcular
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfAnual = dfSueldo *12
.head 5 -  Set dfSubTotal= dfAnual - dfBase
.head 5 +  If (dfSubTotal - 30000) >= 0
.head 6 -  Set dfTreinta = 30000
.head 6 -  Set dfResto = dfSubTotal - 30000
.head 5 +  Else
.head 6 -  Set dfTreinta = dfSubTotal
.head 6 -  Set dfResto =0
.head 5 -  Set dfPTreinta = dfTreinta * 0.10
.head 5 -  Set dfPResto = dfResto * 0.15
.head 5 -  Set dfFinal = dfPTreinta + dfPResto
.head 5 -  Set dfRetorno = dfFinal / dfMeses
.head 2 +  Window Parameters
.head 3 -  Receive Number: nRetorno
.head 3 -  Number: psueldo
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set dfSueldo=psueldo
.head 4 -  Set dfMeses=12
.head 4 -  Set dfBase=70000
.head 4 -  Call Calcular(  )
.head 1 +  Dialog Box: dlgPlanilla
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Imprimir Planilla
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.133"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.024"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.607"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Black
.head 3 +  Contents
.head 4 +  Pushbutton: pbSalir
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbImprimir
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbImprimir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set fechaI= SalFmtFormatDateTime(frmPlanilla.dfInicio,"dd/MM/yyyy")
.head 7 -  Set fechaF= SalFmtFormatDateTime(frmPlanilla.dfFin ,"dd/MM/yyyy")
.head 7 -  Set sObs="PLANILLA " || frmPlanilla.cmbFormaPago || "  De la Fecha " || fechaI || "   a la Fecha  " ||  fechaF
.head 7 +  If rbDetallado
.head 8 -  Set sReporte = strRepPath || "\\PLANILLA.QRP"
.head 8 -  Set sOrden = "C.nombre,Primer_Nom,B.Primer_Ape"
.head 7 +  If rbBanco
.head 8 -  Set sReporte=strRepPath || "\\PLANILLA_2.QRP"
.head 8 -  Set sOrden = "B.Primer_Nom,B.Primer_Ape"
.head 7 -  Call SalCreateWindow( frmImprimir, hWndForm,
"Planilla",
sReporte,
":n1,:s1,:s2,:s3,:s4,:n2,:n3,:n4,:n5,:n6,:n7,:n8,:n9,:n10,:n11,:n12,:n13,:n14,:n15,:s5,:s6,:n16",

"A.cod_empleado, B.Primer_Nom, B.Segundo_Nom,B.Primer_Ape,B.Segundo_Ape,
A.horas_extras,A.turnos,A.otros_ingresos,A.ihss,A.alimentacion,
A.prestamo,A.isr,A.ausencias,A.cooperativa,A.otros_egresos,A.sueldo_pagado,A.bonificaciones,
A.laboratorio, A.medicamentos, C.departamento,B.cuenta,A.rap",

"SELECT	A.cod_empleado, B.Primer_Nom, B.Segundo_Nom,B.Primer_Ape,B.Segundo_Ape,
A.horas_extras,A.turnos,A.otros_ingresos,A.ihss, A.alimentacion,
A.prestamo,A.isr,A.ausencias,A.cooperativa,A.otros_egresos,A.sueldo_pagado,A.bonificaciones,
A.laboratorio, A.medicamentos,C.nombre,B.cuenta, A.rap
                
from	DET_PLANILLA A, EMPLEADOS B, DEPTOS C
where	A.cod_empleado=B.cod_empleado and A.cod_planilla=:frmPlanilla.dfCod_Planilla AND
	B.cod_depto = C.cod_depto

ORDER BY "  || sOrden ||  "

into      :n1,:s1,:s2,:s3,:s4,:n2,:n3,:n4,:n5,:n6,:n7,:n8,:n9,:n10,:n11,:n12,:n13,:n14,:n15,:s5,:s6,:n16",

sObs,FALSE)
.head 2 +  Contents
.head 3 -  Group Box: Reporte de Planilla
.head 4 -  Resource Id: 3831
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.155"
.head 5 -  Width:  4.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbDetallado
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Detallado
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    0.405"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbBanco
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Para el banco
.head 4 -  Window Location and Size
.head 5 -  Left:   3.083"
.head 5 -  Top:    0.405"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sObs
.head 3 -  String: fechaI
.head 3 -  String: fechaF
.head 3 -  String: sReporte
.head 3 -  String: sOrden
.head 2 -  Message Actions
.head 1 +  Dialog Box: dlgArchPlanilla
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Generar Archivo de planilla
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.033"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.917"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfFechaI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.283"
.head 6 -  Top:    0.238"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFechaF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfFecha
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.35"
.head 6 -  Top:    0.262"
.head 6 -  Width:  2.333"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Fecha Inicio
.head 4 -  Resource Id: 13070
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.262"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Fecha Fin
.head 4 -  Resource Id: 13071
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.35"
.head 5 -  Top:    0.286"
.head 5 -  Width:  0.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbGenerar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Generar
.head 4 -  Window Location and Size
.head 5 -  Left:   0.883"
.head 5 -  Top:    0.905"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sDireccion="C:\\Planilla_"|| SalFmtFormatDateTime( dfFechaI, "ddMMyyyy" ) || "_HASTA_" || SalFmtFormatDateTime( dfFechaF, "ddMMyyyy") || ".txt" 
.head 6 -  Call SalFileOpen( fArch, sDireccion, OF_Create | OF_Append )
.head 6 -  Call SqlPrepareAndExecute( hSql2, "	SELECT 	A.cod_empleado, 
					Round((A.horas_extras+A.turnos+A.otros_ingresos+A.sueldo_pagado+A.bonificaciones) -
					(A.ihss+ A.alimentacion+A.prestamo+A.isr+A.ausencias+A.cooperativa+A.otros_egresos+A.laboratorio + A.medicamentos+A.rap),2),
					B.cuenta
				FROM det_planilla A, empleados B 
				INTO 	:nCodE,
					:nSueldo,
					:sCuenta
			             	 WHERE a.cod_empleado=b.cod_empleado AND a.cod_planilla=:nCodP" )

.head 6 -  Call SqlFetchNext( hSql2, nFin )
.head 6 +  While nFin != FETCH_EOF
.head 7 -  Set sLinea=SalStrTrimX( sCuenta ) || SalFmtFormatNumber( nSueldo, "00000000000.00") || "0"
.head 7 -  ! Call SalMessageBox( sLinea,"Betesda",0)
.head 7 -  Set sLinea= SalStrReplaceX( sLinea, 23 , 1,'' )
.head 7 -  ! Call SalMessageBox( sLinea,"Betesda",0)
.head 7 -  Call SalFilePutStr( fArch, sLinea )
.head 7 -  Call SqlFetchNext( hSql2, nFin )
.head 6 -  Call SqlPrepareAndExecute(hSql2,"commit")
.head 6 -  Call SqlPrepareAndExecute( hSql1, "	SELECT 	Sum(Round((A.horas_extras+A.turnos+A.otros_ingresos+A.sueldo_pagado+A.bonificaciones) -
					(A.ihss+ A.alimentacion+A.prestamo+A.isr+A.ausencias+A.cooperativa+A.otros_egresos+A.laboratorio + A.medicamentos+A.rap),2))
				FROM det_planilla A 
				INTO 	:nTotal
			             	 WHERE a.cod_planilla=:nCodP" )

.head 6 -  Call SqlFetchNext( hSql1, nFin )
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  Set sLinea="112300000898" || SalFmtFormatNumber( nTotal, "00000000000.00") || "1"
.head 6 -  Set sLinea= SalStrReplaceX( sLinea, 23, 1,'' )
.head 6 -  Call SalFilePutStr( fArch, sLinea )
.head 6 -  Call SalFileClose( fArch )
.head 6 -  Call SalMessageBox( "El archivo ha sido terminado la direccion es:" || sDireccion, "Planilla BETESDA", 0 )
.head 3 +  Pushbutton: pb2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Salir
.head 4 -  Window Location and Size
.head 5 -  Left:   2.583"
.head 5 -  Top:    0.905"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow( dlgArchPlanilla )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nCodP
.head 2 +  Window Variables
.head 3 -  Number: nFin
.head 3 -  String: sDireccion
.head 3 -  String: sLinea
.head 3 -  File Handle: fArch
.head 3 -  Number: nCodE
.head 3 -  Number: nSueldo
.head 3 -  Number: nTotal
.head 3 -  String: sCuenta
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SqlPrepareAndExecute( hSql1, "SELECT FechaI,FechaF from Planilla INTO :dfFechaI, :dfFechaF WHERE Cod_planilla=:nCodP" )
.head 4 -  Call SqlFetchNext( hSql1, nFin )
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 1 +  Form Window: frmAsistencia
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: colHETC
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.783"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.0"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.595"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Dark Gray
.head 3 +  Contents
.head 4 +  Pushbutton: pb6
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Gray
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Data Field: dfCodPlani
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.85"
.head 6 -  Top:    0.429"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfFechaI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.85"
.head 6 -  Top:    0.738"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 -  Message Actions
.head 3 +  Data Field: dfFechaF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    0.738"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: 99/99/9999
.head 4 -  Message Actions
.head 3 +  Data Field: df5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    1.405"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.283"
.head 6 -  Top:    0.571"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbCalcular
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Calcular Horas T
.head 4 -  Window Location and Size
.head 5 -  Left:   7.283"
.head 5 -  Top:    0.488"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor( TRUE)
.head 6 -  Set dtFechaI = dfFechaI
.head 6 -  Set dtFechaF = dfFechaF
.head 6 -  Set sFechaI=  SalFmtFormatDateTime( dfFechaI, "MM/dd/yyyy" )
.head 6 -  Set sFechaF=  SalFmtFormatDateTime( dfFechaF, "MM/dd/yyyy" )
.head 6 -  Set nHoraTC=0
.head 6 +  If SqlPrepareAndExecute(hSql4, "DELETE FROM Asistencia WHERE fecha between :dfFechaI AND :dfFechaF AND cod_planilla=:dfCodPlani" )
.head 7 -  Call SqlPrepareAndExecute( hSql4,"commit")
.head 7 -  Set sql2= "	SELECT 
			distinct 
				c.cod_empleado,
				b.primer_nom + ' ' + b.segundo_nom + ' ' + b.primer_ape,
				b.cod_depto
		FROM 
			det_planilla a,
			empleados b,
			det_asistencia c 
		into 
			:nCod,
			:sNombre,
			:nDepto
		WHERE 
			a.cod_empleado=b.cod_empleado  AND
			a.cod_empleado= c.cod_empleado AND 
			b.cod_empleado=c.cod_empleado AND 
			c.fecha between :dfFechaI AND :dfFechaF AND 
			b.forma_pago=:cmbTipo
		order by 
			c.cod_empleado"
.head 7 -  Call SqlPrepareAndExecute( hSql1, sql2 )
.head 7 +  While SqlFetchNext( hSql1, nFin )
.head 8 -  ! Call SqlPrepareAndExecute( hSql1,"commit")
.head 8 +  While dtFechaI <= dtFechaF
.head 9 -  Set nHoraTC=0
.head 9 -  Set nHoraT=0
.head 9 -  Set nHoraT2=0
.head 9 -  Set nHoraE=0
.head 9 -  Set sFechaI=  SalFmtFormatDateTime( dtFechaI, "MM/dd/yyyy" )
.head 9 -  Set df9= dtFechaI
.head 9 -  Set df2=nCod
.head 9 -  Call SqlPrepareAndExecute( hSql2, "SELECT IsNull(min(horaT), 0) FROM DET_ASISTENCIA INTO :nHoraT WHERE Fecha = :dtFechaI AND Tipo_Hora=1  AND cod_empleado=:nCod")
.head 9 -  Call SqlFetchNext( hSql2, nFin2 )
.head 9 -  Call SqlPrepareAndExecute( hSql2,"commit")
.head 9 -  Call SqlPrepareAndExecute( hSql2, "SELECT IsNull(max(horaT),0) FROM DET_ASISTENCIA INTO :nHoraT2 WHERE Fecha = :dtFechaI AND Tipo_Hora=3  AND cod_empleado=:nCod")
.head 9 -  Call SqlFetchNext( hSql2, nFin2 )
.head 9 -  Call SqlPrepareAndExecute( hSql2,"commit")
.head 9 -  Set nHoraTT= nHoraT2-nHoraT
.head 9 -  Set nDia=SalDateWeekday( dtFechaI )
.head 9 -  Set nDom=0
.head 9 -  ! If nHoraTT>0
.head 9 +  Select Case nDepto
.head 10 -  !
.head 10 -  ! Administracion
.head 10 +  Case 1
.head 11 -  Set nHoraTT= Corregir_hora(  nDia, nHoraT, nHoraT2 )
.head 11 +  ! Select Case SalDateWeekday( dtFechaI )
.head 12 +  Case 0
.head 13 +  If nHoraTT>4
.head 14 -  Set nHoraE=nHoraTT-4
.head 13 +  Else
.head 14 -  Set nHoraE=0
.head 13 -  Break
.head 12 -  ! Domingo
.head 12 +  Case 1
.head 13 -  Break
.head 12 -  ! Lunes a Viernes
.head 12 +  Default
.head 13 +  If nHoraTT>8
.head 14 -  Set nHoraE=nHoraTT-8.00
.head 13 +  Else
.head 14 -  Set nHoraE=0
.head 13 -  Break
.head 11 -  Call TurnoN( nHoraTT, dtFechaI, nHoraE, nDom )
.head 11 -  Break
.head 10 -  ! Farmacia
.head 10 +  Case 7
.head 11 +  If nHoraT>20
.head 12 -  ! Set nHoraTT=24-nHoraT2
.head 12 -  ! Set dtFechaI=dtFechaI+1
.head 12 -  ! Call SqlPrepareAndExecute( hSql2, "SELECT min(horaT) FROM DET_ASISTENCIA INTO :nHoraT WHERE Fecha = :dtFechaI and cod_empleado=:nCod")
.head 12 +  ! If SqlFetchNext( hSql2, nFin2 )
.head 13 -  Set nHoraT=0
.head 13 -  Set nHoraE=0
.head 12 +  ! Else
.head 13 -  Set nHoraTT=nHoraTT+nHoraT
.head 13 -  Set nHoraTC=nHoraTT-6
.head 12 -  ! Call SqlPrepareAndExecute( hSql2,"commit")
.head 12 -  Call TurnoC( nCod, nHoraT, nHoraT2, dtFechaI, nHoraTT, nHoraTC )
.head 11 +  Else
.head 12 -  Set nHoraTT= Corregir_hora(  nDia, nHoraT, nHoraT2 )
.head 12 -  Call TurnoN( nHoraTT, dtFechaI, nHoraE, nDom )
.head 12 +  ! Select Case SalDateWeekday( dtFechaI )
.head 13 -  ! Sabado
.head 13 +  Case 0
.head 14 +  If nHoraTT>4
.head 15 -  Set nHoraE=nHoraTT-4
.head 14 +  Else
.head 15 -  Set nHoraE=0
.head 14 -  Break
.head 13 -  ! Domingo
.head 13 +  Case 1
.head 14 +  If nHoraTT>0
.head 15 -  Set nDom=1
.head 14 -  Break
.head 13 -  ! Lunes a Viernes
.head 13 +  Default
.head 14 +  If nHoraTT>8
.head 15 -  Set nHoraE=nHoraTT-8.00
.head 14 +  Else
.head 15 -  Set nHoraE=0
.head 14 -  Break
.head 11 -  Break
.head 10 -  Case 3
.head 10 -  Case 4
.head 10 -  Case 12
.head 10 -  Case 13
.head 10 +  Case 14
.head 11 +  ! If nHoraT>20
.head 12 -  Call TurnoC( nCod, nHoraT, nHoraT2, dtFechaI, nHoraTT, nHoraTC )
.head 11 -  Call TurnoC( nCod, nHoraT, nHoraT2, dtFechaI, nHoraTT, nHoraTC )
.head 11 -  Break
.head 10 +  Case 6
.head 11 +  ! If nHoraT>20
.head 12 -  Call TurnoC( nCod, nHoraT, nHoraT2, dtFechaI, nHoraTT, nHoraTC )
.head 12 -  Set nHoraTC=0
.head 11 -  Call TurnoC( nCod, nHoraT, nHoraT2, dtFechaI, nHoraTT, nHoraTC )
.head 11 -  Break
.head 10 +  Case 11
.head 11 +  ! If nHoraT>20
.head 12 -  Call TurnoC( nCod, nHoraT, nHoraT2, dtFechaI, nHoraTT, nHoraTC )
.head 12 -  Set nHoraTC=0
.head 11 -  Call TurnoC( nCod, nHoraT, nHoraT2, dtFechaI, nHoraTT, nHoraTC )
.head 11 -  Break
.head 10 +  Case 10
.head 11 +  If nHoraT>16.5
.head 12 -  Call TurnoC( nCod, nHoraT, nHoraT2, dtFechaI, nHoraTT, nHoraTC )
.head 11 +  Else
.head 12 -  Set nHoraTT= Corregir_hora(  nDia, nHoraT, nHoraT2 )
.head 12 -  Call TurnoN( nHoraTT, dtFechaI, nHoraE, nDom )
.head 11 -  Break
.head 10 +  Default
.head 11 -  Break
.head 9 -  Call SqlPrepareAndExecute( hSql3, "INSERT INTO Asistencia(cod_planilla,cod_empleado, fecha, horas,HE_TurnoC,Dia,HE_Normales,Turnos) VALUES(:dfCodPlani,:nCod,:dtFechaI,:nHoraTT,:nHoraTC,:nDia,:nHoraE,:nDom)" )
.head 9 -  Call SqlPrepareAndExecute( hSql3,"commit")
.head 9 -  Set dtFechaI = dtFechaI +1
.head 8 -  ! Call SqlFetchNext( hSql1, nFin )
.head 8 -  Set dtFechaI = dfFechaI
.head 7 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 7 -  Call SalMessageBox( "La tarea se realizo satisfactorimante", "Fin", 0 )
.head 6 +  Else
.head 7 -  Call SalMessageBox( "Error al realizar la tarea", "Fin", 0 )
.head 6 -  Call SalWaitCursor( FALSE)
.head 3 +  Pushbutton: pb2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Consultar Planilla
.head 4 -  Window Location and Size
.head 5 -  Left:   3.783"
.head 5 -  Top:    1.405"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set sFechaI=  SalFmtFormatDateTime( dfFechaI, "MM/dd/yyyy" )
.head 6 -  Set sFechaF=  SalFmtFormatDateTime( dfFechaF, "MM/dd/yyyy" )
.head 6 -  Set sql=" SELECT 
		A.cod_planilla,
		A.cod_empleado,
		B.primer_nom + ' ' + B.Segundo_nom + ' ' + B.Primer_ape,
		A.horas,
		A.fecha,
		a.HE_Normales,
		A.HE_TurnoC,
		A.dia,
		''
	FROM 
		Asistencia A, 
		Empleados B
	WHERE 
		A.cod_empleado=B.cod_empleado AND 
		fecha between :dfFechaI AND :dfFechaF and 
		COD_PLANILLA=:dfCodPlani "
.head 6 -  Set sql2="SELECT distinct  faltas from Asistencia into :nFaltas  WHERE cod_planilla=:dfCodPlani"
.head 6 +  If df5!=NUMBER_Null
.head 7 -  Set sql=sql || " AND A.cod_empleado=:df5"
.head 7 -  Set sql2=sql2 || " AND cod_empleado=:df5"
.head 6 -  Set sql=sql || " ORDER BY A.cod_empleado,A.fecha"
.head 6 -  Call SalTblPopulate( tbl1, hSql2, sql,  TBL_FillAll)
.head 6 -  Call SqlPrepareAndExecute(hSql2,"commit")
.head 6 -  Call SqlPrepareAndExecute( hSql3, sql2)
.head 6 -  Call SqlFetchNext( hSql3, nFin )
.head 6 -  Call SqlPrepareAndExecute(hSql3,"commit")
.head 6 -  Call tblDiaSemana( tbl1,8 , 9 )
.head 6 -  Set df6= nFaltas
.head 6 -  Set df7= SalTblColumnSum(tbl1, 6, 0, 0 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 3 -  Background Text: Fecha Inicio
.head 4 -  Resource Id: 30808
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.683"
.head 5 -  Top:    0.762"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Obtener Datos Reloj
.head 4 -  Window Location and Size
.head 5 -  Left:   7.283"
.head 5 -  Top:    0.155"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor( TRUE)
.head 6 -  Set dtFechaI = dfFechaI
.head 6 -  Set dtFechaF = dfFechaF
.head 6 -  Set sFechaI=  SalFmtFormatDateTime( dfFechaI, "MM/dd/yyyy" )
.head 6 -  Set sFechaF=  SalFmtFormatDateTime( dfFechaF, "MM/dd/yyyy" )
.head 6 -  ! Set dtFechaI=  SalStrToDate(sFechaI)
.head 6 -  ! Set dtFechaF=  SalStrToDate(sFechaF)
.head 6 +  If dfCodPlani != NUMBER_Null and dfFechaI != DATETIME_Null and dfFechaF != DATETIME_Null
.head 7 +  If SqlPrepareAndExecute(hSql1, "DELETE FROM DET_Asistencia WHERE fecha between :dfFechaI AND :dfFechaF"  )
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Call SalFileOpen( fPlani, "C:\\PLANILLA.txt", OF_Read )
.head 8 +  While SalFileGetStr( fPlani, sLinea, 3000 )
.head 9 -  Call SalStrTokenize( sLinea, '', ',', aLinea )
.head 9 -  Set nTH=SalStrToNumber( aLinea[2] )
.head 9 -  Set nCod=SalStrToNumber( aLinea[3] )
.head 9 -  Set nHora=SalStrToNumber( aLinea[5] )
.head 9 -  Set nMin=SalStrToNumber( aLinea[6] )
.head 9 -  Set nMes=SalStrToNumber( aLinea[7] )
.head 9 +  If nMes < 10
.head 10 -  Set aLinea[7]  = "0" ||  SalStrTrimX( aLinea[7] )
.head 9 -  Set nDia=SalStrToNumber( aLinea[8] )
.head 9 +  If nDia < 10
.head 10 -  Set aLinea[8]  = "0" || SalStrTrimX( aLinea[8] )
.head 9 -  Set nAnio=SalStrToNumber( aLinea[9] )+2000
.head 9 -  Set sFecha=SalNumberToStrX( nAnio, 0 )  || "/" || aLinea[7] || "/" || aLinea[8] 
.head 9 -  Set dtFecha=SalDateConstruct( nAnio, nMes, nDia, 0, 0, 0 )
.head 9 -  Set nHoraT=nHora+(nMin/60)
.head 9 -  Set df1=sFecha
.head 9 +  If (dtFecha>=dtFechaI and dtFecha<=dtFechaF)
.head 10 -  Set df1=sFecha
.head 10 -  Set nDia=SalDateWeekday( dtFecha )
.head 10 -  Call SqlPrepareAndExecute( hSql1, "INSERT INTO DET_ASISTENCIA VALUES(:dfCodPlani,:nCod,:dtFecha,:nHoraT,:nTH)")
.head 10 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 10 -  ! Call Progress( dtFecha-dtFechaI, dtFechaF-dtFechaI )
.head 8 -  Call SalMessageBox( "La tarea se realizo satisfactorimante", "Fin", 0 )
.head 8 -  Call SalFileClose( fPlani )
.head 7 +  Else
.head 8 -  Call SalMessageBox( "Error al realizar la tarea", "Fin", 0 )
.head 6 +  Else
.head 7 -  Call SalMessageBox( "Campo en blanco", "Fin", 0 )
.head 6 -  Call SalWaitCursor( FALSE)
.head 3 -  Background Text: Codigo Empleado:
.head 4 -  Resource Id: 30809
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    1.452"
.head 5 -  Width:  1.467"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Codigo Planilla:
.head 4 -  Resource Id: 23083
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.45"
.head 5 -  Top:    0.476"
.head 5 -  Width:  1.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Tipo:
.head 4 -  Resource Id: 49321
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.25"
.head 5 -  Top:    0.476"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Fecha Fin
.head 4 -  Resource Id: 30810
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.85"
.head 5 -  Top:    0.786"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.383"
.head 6 -  Top:    2.012"
.head 6 -  Width:  10.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.476"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCodPlani
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Codigo Planilla
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCod
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Codigo
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNom
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nombre
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.15"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colHoras
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Horas
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFecha
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Fecha
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colHE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: HE Normales
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colHETC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: HE Turno C
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colnDia
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: nDia
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDia
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Dia
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblPopulate( tbl2, hSql1, "Select distinct a.cod_planilla,a.cod_empleado,a.fecha,a.horaT,Null,a.tipo_hora  from det_Asistencia A where cod_empleado=:tbl1.colCod and fecha=:tbl1.colFecha and cod_planilla=:dfCodPlani order by a.tipo_hora",  
TBL_FillAllBackground)
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  Call tblHoras( tbl2, 4,5 )
.head 3 -  Background Text: Dias faltados:
.head 4 -  Resource Id: 30812
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    3.679"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: df6
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    3.655"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df7
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.25"
.head 6 -  Top:    3.655"
.head 6 -  Width:  1.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Horas Extras:
.head 4 -  Resource Id: 30813
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.983"
.head 5 -  Top:    3.679"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pb4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Imprimir
.head 4 -  Window Location and Size
.head 5 -  Left:   7.283"
.head 5 -  Top:    0.821"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Call SalCreateWindow( frmReport, hWndNULL )
.head 6 -  Call SalCreateWindow( frmImprimir, hWndForm,
"Factura",
strRepPath || "\\asistencia.QRP",
"::n1,:n2,:dt1,:n3,:n4,:n5,:n6,
:s2,:s3,:s4,:s5,:s6",

"A.COD_EMPLEADO, A.FALTAS, A.FECHA, A.HE_NORMALES, A.HE_TURNOC, A.HORAS, A.TURNOS, 
  B.CUENTA, B.PRIMER_APE, B.PRIMER_NOM, B.SEGUNDO_APE, B.SEGUNDO_NOM",

"SELECT   
	A.COD_EMPLEADO, 
	SUM(A.FALTAS), 
	A.FECHA,
	SUM( A.HE_NORMALES), 
	SUM( A.HE_TURNOC), 
	SUM(A.HORAS), 
	SUM(A.TURNOS), 
	B.CUENTA, 
	B.PRIMER_APE, 
	B.PRIMER_NOM, 
	B.SEGUNDO_APE, 
	B.SEGUNDO_NOM 
FROM 
	ASISTENCIA A, 
	EMPLEADOS B
 WHERE 
	A.COD_EMPLEADO = B.COD_EMPLEADO AND 
	A.Fecha BETWEEN :frmAsistencia.dfFechaI AND :frmAsistencia.dfFechaF
GROUP BY 
	A.cod_empleado, 
	A.fecha, 
	B.CUENTA, 
	B.PRIMER_APE, 
	B.PRIMER_NOM, 
	B.SEGUNDO_APE, 
	B.SEGUNDO_NOM

into	:n1,:n2,:dt1,:n3,:n4,:n5,:n6
	:s2,:s3,:s4,:s5,:s6",

'PLANILLA',FALSE)
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.383"
.head 6 -  Top:    3.988"
.head 6 -  Width:  9.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCodPlani
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Codigo Planilla
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCod
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Codigo
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFecha
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Fecha
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colHoraT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Horas
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.217"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMin
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Minutos
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.217"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTH
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Tipo Hora
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Data Field: df1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.283"
.head 6 -  Top:    0.238"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: df9
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.283"
.head 6 -  Top:    0.821"
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pb5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Calcular Faltas
.head 4 -  Window Location and Size
.head 5 -  Left:   5.283"
.head 5 -  Top:    1.405"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SqlPrepareAndExecute( hSql1, "	
			SELECT 
				distinct c.cod_empleado
				
			FROM 
				det_asistencia c 
			into 
				:nCod
			WHERE 
				c.fecha between :dfFechaI AND :dfFechaF AND 
				c.Cod_planilla=:dfCodPlani")
.head 6 +  While SqlFetchNext( hSql1, nFin )
.head 7 -  Call SalStatusSetText( frmAsistencia, SalNumberToStrX( nCod, 0 ) )
.head 7 -  Call SqlPrepareAndExecute( hSql2, "	SELECT 
					count(*) 
				FROM 
					asistencia 
				into 
					:nFaltas
				WHERE 
					cod_planilla=:dfCodPlani AND 
					cod_empleado=:nCod AND 
					dia<>1 AND 
					horas=0
				")
.head 7 -  Call SqlFetchNext( hSql2, nFin2 )
.head 7 -  Call SqlPrepareAndExecute( hSql2,"commit")
.head 7 -  Call SqlPrepareAndExecute( hSql3, "	UPDATE 
					asistencia 
				SET 
					faltas=:nFaltas
				WHERE 
					cod_planilla=:dfCodPlani AND 
					cod_empleado=:nCod
				")
.head 7 -  Call SqlPrepareAndExecute( hSql3,"commit")
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  Call SalWaitCursor( FALSE )
.head 3 +  Combo Box: cmbTipo
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.683"
.head 5 -  Top:    0.452"
.head 5 -  Width:  2.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.048"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 47845
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    1.905"
.head 5 -  Width:  11.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Dark Gray
.head 3 -  Frame
.head 4 -  Resource Id: 23082
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.25"
.head 5 -  Top:    3.905"
.head 5 -  Width:  10.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Dark Gray
.head 3 -  Group Box: Especifique los siguientes datos
.head 4 -  Resource Id: 23081
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.155"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Planilla por Empleado
.head 4 -  Resource Id: 23084
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    1.155"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 +  Functions
.head 3 +  Function: DiaSemana
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nDia
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDia
.head 4 +  Actions
.head 5 +  Select Case nDia
.head 6 +  Case 0
.head 7 -  Set sDia='Sábado'
.head 7 -  Break
.head 6 +  Case 1
.head 7 -  Set sDia='Domingo'
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set sDia='Lunes'
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Set sDia='Martes'
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  Set sDia='Miercoles'
.head 7 -  Break
.head 6 +  Case 5
.head 7 -  Set sDia='Jueves'
.head 7 -  Break
.head 6 +  Case 6
.head 7 -  Set sDia='Viernes'
.head 7 -  Break
.head 6 +  Default
.head 7 -  Set sDia='Error'
.head 7 -  Break
.head 5 -  Return sDia
.head 3 +  Function: tblDiaSemana
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: tbl
.head 5 -  Number: gRow
.head 5 -  Number: sRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sVal
.head 5 -  Number: nRow
.head 4 +  Actions
.head 5 -  Set nRow=0
.head 5 +  While SalTblSetContext( tbl, nRow )
.head 6 -  Call SalTblGetColumnText( tbl, gRow, sVal )
.head 6 -  Call SalTblSetColumnText( tbl, sRow, DiaSemana(SalStrToNumber( sVal )))
.head 6 -  Set nRow=nRow+1
.head 5 -  Return 1
.head 3 +  Function: TurnoC
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nCod
.head 5 -  Number: nHoraT
.head 5 -  Number: nHoraT2
.head 5 -  Receive Date/Time: dtFecha
.head 5 -  Receive Number: nHoras
.head 5 -  Receive Number: nHE
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dtFecha2
.head 5 -  Number: nHoraT3
.head 5 -  Number: nNum
.head 4 +  Actions
.head 5 -  Set nHoraT3=0
.head 5 -  Set nNum=0
.head 5 -  Call SqlPrepareAndExecute( hSql4, "SELECT count(*) FROM DET_ASISTENCIA INTO :nNum WHERE Fecha = :dtFecha AND Tipo_Hora=1 and cod_empleado=:nCod")
.head 5 -  Call SqlFetchNext( hSql4, nFin2 )
.head 5 -  Call SqlPrepareAndExecute(hSql4,"commit")
.head 5 -  Call SqlPrepareAndExecute( hSql4, "SELECT max(horaT) FROM DET_ASISTENCIA INTO :nHoraT3 WHERE Fecha = :dtFecha AND Tipo_Hora=1 and cod_empleado=:nCod")
.head 5 -  Call SqlFetchNext( hSql4, nFin2 )
.head 5 -  Call SqlPrepareAndExecute(hSql4,"commit")
.head 5 +  If nNum>1 and (nHoraT3-nHoraT)>2
.head 6 -  Set nHoras=nHoraT2-nHoraT
.head 6 -  Set dtFecha2=dtFecha+1
.head 6 -  Call SqlPrepareAndExecute( hSql4, "SELECT min(horaT) FROM DET_ASISTENCIA INTO :nHoraT WHERE Fecha = :dtFecha2 AND Tipo_Hora=3 and cod_empleado=:nCod")
.head 6 -  Call SqlFetchNext( hSql4, nFin2 )
.head 6 -  Call SqlPrepareAndExecute(hSql4,"commit")
.head 6 +  If nHoraT>0 
.head 7 -  Set nHoras = nHoras + (24-nHoraT3)
.head 7 -  Set nHoras=nHoras + nHoraT
.head 7 -  Set nHE=nHoraT - 3
.head 6 +  Else
.head 7 -  Set nHE=0
.head 5 +  If nHoraT2 < nHoraT
.head 6 -  Set dtFecha2=dtFecha+1
.head 6 -  Call SqlPrepareAndExecute( hSql4, "SELECT min(horaT) FROM DET_ASISTENCIA INTO :nHoraT3 WHERE Fecha = :dtFecha2 AND Tipo_Hora=3 and cod_empleado=:nCod")
.head 6 -  Call SqlFetchNext( hSql4, nFin2 )
.head 6 -  Call SqlPrepareAndExecute(hSql4,"commit")
.head 6 +  If nHoraT3>0 
.head 7 -  Set nHoras = (24 - nHoraT)
.head 7 -  Set nHoras=nHoras + nHoraT3
.head 7 -  Set nHE=nHoraT3 - 3
.head 6 +  Else
.head 7 -  Set nHoras = -1
.head 7 -  Set nHE=0
.head 5 -  ! If nNum>1 and ()
.head 5 -  ! Call SqlPrepareAndExecute( hSql2, "SELECT horaT FROM DET_ASISTENCIA INTO :nHoraT3 WHERE Fecha = :dtFecha AND Tipo_Hora=1 and cod_empleado=:nCod")
.head 5 -  ! Call SqlFetchNext( hSql2, nFin2 )
.head 5 +  ! If nHoraT>0
.head 6 -  Set nHora=nHora + nHoraT
.head 6 -  Set nHE=nHora-6
.head 5 +  ! Else
.head 6 -  Set nHora=-1
.head 6 -  Set nHE=0
.head 5 -  ! Call SqlPrepareAndExecute( hSql4,"commit")
.head 4 -  ! If nHoraT2<nHoraT or nHoraT2=0
.head 3 +  Function: TurnoN
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nHora
.head 5 -  Date/Time: dtFecha
.head 5 -  Receive Number: nHE
.head 5 -  Receive Number: nDom
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nDom=0
.head 5 -  Set nHE=0
.head 5 +  Select Case SalDateWeekday( dtFecha )
.head 6 -  ! Sabado
.head 6 +  Case 0
.head 7 +  If nHora>4
.head 8 -  Set nHE=nHora-4
.head 7 +  Else
.head 8 -  Set nHE=0
.head 7 -  Break
.head 6 -  ! Domingo
.head 6 +  Case 1
.head 7 +  If nHora>0
.head 8 -  Set nDom=1
.head 7 -  Break
.head 6 -  ! Lunes a Viernes
.head 6 -  Case 2
.head 6 -  Case 3
.head 6 -  Case 4
.head 6 -  Case 5
.head 6 +  Case 6
.head 7 +  If nHoraTT>8
.head 8 -  Set nHE=nHora-8.
.head 7 +  Else
.head 8 -  Set nHoraE=0
.head 7 -  Break
.head 6 +  Default
.head 7 -  Set nHE=0
.head 7 -  Break
.head 3 +  Function: Progress
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nVal
.head 5 -  Number: nMax
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLargo
.head 5 -  Number: nAncho
.head 5 -  Number: nLargo2
.head 5 -  Number: nPorcent
.head 4 +  Actions
.head 5 -  ! Call SalGetWindowSize( dfProgress2, nLargo, nAncho )
.head 5 -  ! Set nLargo2=nVal*(nLargo/nMax)
.head 5 -  ! Set nPorcent=(nVal/nMax)*100
.head 5 +  ! If nLargo2=0
.head 6 -  Set nLargo2=4
.head 5 -  ! Call SalSetWindowSize( dfProgress1, nLargo2, nAncho )
.head 5 -  ! Call SalSetWindowText( dfProgress2, '             ' || SalNumberToStrX( nPorcent, 2 )  || ' %')
.head 5 -  ! Call SalSetWindowText( dfProgress1, '             ' || SalNumberToStrX( nPorcent, 2 )  || ' %')
.head 3 +  Function: Corregir_hora
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nDia
.head 5 -  Number: nEntrada
.head 5 -  Number: nSalida
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nEntrada=NUMBER_Null and nSalida=NUMBER_Null
.head 6 -  Return 0
.head 5 +  If nEntrada=NUMBER_Null or nSalida=NUMBER_Null
.head 6 -  Return -1
.head 5 +  If nDia!=0 and nDia!=1
.head 6 -  Return (nSalida-nEntrada)-1
.head 5 -  Else
.head 5 -  Return (nSalida-nEntrada)
.head 3 +  Function: tblHoras
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: tbl
.head 5 -  Number: gRow
.head 5 -  Number: sRow
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nHora
.head 5 -  Number: nMin
.head 5 -  Number: nHoraT
.head 5 -  Number: nRow
.head 5 -  String: sVal
.head 4 +  Actions
.head 5 -  Set nRow=0
.head 5 +  While SalTblSetContext( tbl, nRow )
.head 6 -  Call SalTblGetColumnText( tbl, gRow, sVal )
.head 6 -  Set nHoraT = SalStrToNumber( sVal )
.head 6 -  Set nHora =SalNumberTruncate( nHoraT, 4, 0 )
.head 6 -  Set nMin =SalNumberMod( nHoraT, 1)*60
.head 6 -  Call SalTblSetColumnText( tbl, gRow,SalNumberToStrX( nHora,0) )
.head 6 -  Call SalTblSetColumnText( tbl, sRow,SalNumberToStrX(nMin,0) )
.head 6 -  Set nRow=nRow+1
.head 5 -  Return 1
.head 2 +  Window Parameters
.head 3 -  Number: nCodPlani
.head 3 -  Date/Time: dtFecha_i
.head 3 -  Date/Time: dtFecha_f
.head 2 +  Window Variables
.head 3 -  File Handle: fPlani
.head 3 -  String: sLinea
.head 3 -  Number: nAnio
.head 3 -  Number: nCod
.head 3 -  Number: nMes
.head 3 -  Number: nDia
.head 3 -  Number: nHora
.head 3 -  Number: nMin
.head 3 -  Number: nHora2
.head 3 -  Number: nHoraT
.head 3 -  Number: nHoraE
.head 3 -  Number: nHoraT2
.head 3 -  Number: nHoraTC
.head 3 -  Number: nMin2
.head 3 -  Number: nNum
.head 3 -  Number: nDepto
.head 3 -  Number: nComa
.head 3 -  String: sChar
.head 3 -  String: aLinea[*]
.head 3 -  String: sFecha
.head 3 -  String: sFechaF
.head 3 -  String: sFechaI
.head 3 -  Number: nFin
.head 3 -  Number: nDom
.head 3 -  Number: nHoraTT
.head 3 -  Number: nFin2
.head 3 -  Date/Time: dtFecha
.head 3 -  Date/Time: dtFechaI
.head 3 -  Date/Time: dtFechaF
.head 3 -  String: sql
.head 3 -  String: sql2
.head 3 -  String: sNombre
.head 3 -  Number: nTH
.head 3 -  Number: nFaltas
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set dfCodPlani = nCodPlani
.head 4 -  Set dfFechaI = dtFecha_i
.head 4 -  Set dfFechaF = dtFecha_f
.head 4 -  Call SalListAdd( cmbTipo, "QUINCENAL" )
.head 4 -  Call SalListAdd( cmbTipo, "MENSUAL" )
.head 4 -  Set cmbTipo = frmPlanilla.cmbFormaPago
.head 1 -  !
.head 1 +  Form Window: frmDerechos
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Pantalla de Asignacion de Derechos a los Usuarios
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.071"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.76"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbGrabar
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Salir
.head 5 -  Window Location and Size
.head 6 -  Left:   9.183"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 -  Background Text: Usuarios
.head 4 -  Resource Id: 6412
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.583"
.head 5 -  Top:    0.262"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbUsuario
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cmbBaseCodigo
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.483"
.head 5 -  Top:    0.238"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.427"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 6 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 5 +  On SAM_Create
.head 6 -  Set cmbUsuario.sNombre="NOMBRE"
.head 6 -  Set cmbUsuario.sTabla="USUARIOS"
.head 6 -  Set cmbUsuario.sCodigo ="COD_USU"
.head 6 -  Set cmbUsuario.nCaso=1
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla||" where NOMBRE<>'sysadm' and NOMBRE<>'sa'")
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Check Box: cb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Mensual / Quincenal
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    0.905"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cb2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Adicionales
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    1.155"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cb3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Personal
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    1.405"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cb4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Puestos
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    1.655"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cb5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ocupaciones
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    1.929"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cb6
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ingresos / Deducciones
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    2.202"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Group Box: Pantallas
.head 4 -  Resource Id: 6414
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.571"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Planilla
.head 4 -  Resource Id: 6416
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    0.738"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Sistema
.head 4 -  Resource Id: 6417
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.283"
.head 5 -  Top:    0.738"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: cb8
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Derechos
.head 4 -  Window Location and Size
.head 5 -  Left:   3.65"
.head 5 -  Top:    1.893"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cb7
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Consultas
.head 4 -  Window Location and Size
.head 5 -  Left:   3.65"
.head 5 -  Top:    0.929"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cb9
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Usuarios
.head 4 -  Window Location and Size
.head 5 -  Left:   3.65"
.head 5 -  Top:    2.202"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Limpiar
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 4 +  Actions
.head 5 -  Set hWndHijo=SalGetFirstChild( hWndForm, TYPE_CheckBox)
.head 5 +  While hWndHijo != hWndNULL
.head 6 -  Call SalClearField(hWndHijo)
.head 6 -  Set hWndHijo=SalGetNextChild( hWndHijo, TYPE_CheckBox)
.head 5 -  Return TRUE
.head 3 +  Function: ActualizarSeguridad
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sS1=''
.head 5 -  Set sS1=SalNumberToStrX(cb1,0)||SalNumberToStrX(cb2,0)||
	SalNumberToStrX(cb3,0)||SalNumberToStrX(cb4,0)||SalNumberToStrX(cb5,0)||
	SalNumberToStrX(cb6,0)||SalNumberToStrX(cb7,0)||SalNumberToStrX(cb8,0)||
	SalNumberToStrX(cb9,0)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sSeguridad
.head 3 -  String: sUpdate
.head 3 -  Boolean: arrBooleans[*]
.head 3 -  Boolean: bBueno
.head 3 -  Number: nContador
.head 3 -  String: sS1
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sUpdate="update USUARIOS
		set	derechos_planilla=:sS1
	where	COD_USU=:cmbUsuario.nCodigo"
.head 3 +  On MU_ACTUALIZAR
.head 4 -  Call Limpiar()
.head 4 +  If SqlImmediate("select derechos_planilla	from USUARIOS
	where COD_USU=:cmbUsuario.nCodigo into :sS1")
.head 5 -  Set sS1=SalStrTrimX(sS1)
.head 5 -  Set sSeguridad=''||sS1
.head 5 +  If SalStrLength(sSeguridad)>0
.head 6 -  Set nContador=0
.head 6 +  While nContador <= (SalStrLength( sSeguridad )-1 )
.head 7 -  Set arrBooleans[ nContador+1 ] = SalStrToNumber( SalStrMidX( sSeguridad, nContador, 1 ) )
.head 7 -  Set nContador=nContador+1
.head 6 -  Set cb1=arrBooleans[1]
.head 6 -  Set cb2=arrBooleans[2]
.head 6 -  Set cb3=arrBooleans[3]
.head 6 -  Set cb4=arrBooleans[4]
.head 6 -  Set cb5=arrBooleans[5]
.head 6 -  Set cb6=arrBooleans[6]
.head 6 -  Set cb7=arrBooleans[7]
.head 6 -  Set cb8=arrBooleans[8]
.head 6 -  Set cb9=arrBooleans[9]
.head 4 +  Else
.head 5 -  Call SalMessageBox("NO se pudo cargar los datos","ERROR",MB_Ok)
.head 5 -  Return FALSE
.head 4 -  Call SqlClearImmediate(  )
.head 3 +  On MU_GRABAR
.head 4 -  Call ActualizarSeguridad()
.head 4 +  If SqlPrepareAndExecute(hSql1,sUpdate)
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 5 -  Call SalMessageBox("Debe de SALIR Y VOLVER A ENTRAR AL SISTEMA PARA
QUE SE REFLEJEN LOS CAMBIOS RESPECTIVOS","OJO",MB_Ok)
.head 5 -  Return TRUE
.head 4 +  Else
.head 5 -  Call SqlPrepareAndExecute(hSql1,"rollback")
.head 5 -  Call SalMessageBox("Los datos no se pudieron actualizar","ERROR",MB_Ok)
.head 5 -  Return FALSE
.head 1 +  Form Window: frmCambioContrasena
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Cambio Contrasena
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.87"
.head 4 -  Top:    0.725"
.head 4 -  Width:  8.571"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.99"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.886"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbGrabar
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.286"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pb2.nOpcion=1
.head 2 +  Contents
.head 3 -  Background Text: Usuario
.head 4 -  Resource Id: 6418
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.371"
.head 5 -  Top:    0.219"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbUsuario
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cmbBaseCodigo
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.771"
.head 5 -  Top:    0.198"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.427"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set cmbUsuario.sNombre="NOMBRE"
.head 6 -  Set cmbUsuario.sTabla="USUARIOS"
.head 6 -  Set cmbUsuario.sCodigo ="COD_USU"
.head 6 -  Set cmbUsuario.nCaso=1
.head 3 -  Background Text: Contraseña Actual
.head 4 -  Resource Id: 6419
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.386"
.head 5 -  Top:    0.677"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfActual
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.686"
.head 6 -  Top:    0.656"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Invisible
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set sActual=''
.head 6 -  Call SqlPrepareAndExecute(hSql1,"Select		CONTRASE
FROM	USUARIOS
where	NOMBRE=:cmbUsuario
into	:sActual")
.head 6 -  Call SqlFetchNext(hSql1,nSiguiente)
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 +  If sActual!=dfActual
.head 7 -  Call SalMessageBox("Contraseña Actual difiere de la ingresada","ERROR",MB_Ok)
.head 7 -  Set dfActual=''
.head 3 -  Background Text: Nueva Contraseña
.head 4 -  Resource Id: 6420
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.371"
.head 5 -  Top:    1.135"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNueva
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.671"
.head 6 -  Top:    1.115"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Invisible
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfVerificacion!=''
.head 7 +  If dfNueva!=dfVerificacion
.head 8 -  Call SalMessageBox("Contraseña Nueva no es igual a la verificada, por favor reingresar","ERROR",MB_Ok)
.head 8 -  Set dfNueva=''
.head 8 -  Set dfVerificacion=''
.head 3 -  Background Text: Verificacion Contraseña
.head 4 -  Resource Id: 6421
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.357"
.head 5 -  Top:    1.677"
.head 5 -  Width:  2.029"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfVerificacion
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: dfBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.657"
.head 6 -  Top:    1.656"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Invisible
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfNueva!=''
.head 7 +  If dfNueva!=dfVerificacion
.head 8 -  Call SalMessageBox("Contraseña Nueva no es igual a la verificada, por favor reingresar","ERROR",MB_Ok)
.head 8 -  Set dfNueva=''
.head 8 -  Set dfVerificacion=''
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sActual
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalDisableWindow(cmbUsuario)
.head 4 -  Call SalSendMsg(cmbUsuario,SAM_Create,0,0)
.head 4 -  Set cmbUsuario=sNombreUsuario
.head 3 +  On MU_GRABAR
.head 4 -  Call SqlPrepareAndExecute(hSql1,"update	USUARIOS
SET	CONTRASE=:dfNueva
where	NOMBRE=:cmbUsuario")
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  !
.head 1 -  !
