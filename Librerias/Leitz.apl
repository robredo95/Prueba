.head 0 +  Application Description: Librería general que contiene código reutilizable para:
1) Combo box,multiline,datafield,childtablewindow
2) Botones para agregar,buscar,eliminar,grabar
3) Declaración de variables globales como cursores,usuarios,
fetch,imprimir
4) Funciones globales para: Identity,Limpiar pantalla,contar filas
en table window,des/ha bilitar pantallas, manejo de errores	
.head 1 -  Outline Version - 4.0.27
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000004000000 FFFF01000D004347 5458566965775374 6174650400020000
0020: 0000000000080100 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE2FFFFFF160000 0016000000200200 000D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D0200000012496E 7465726E616C2046
0080: 756E6374696F6E73 0B53686F774D6573 7361676500000180 0200FFFFFFFF0000
00A0: 0000000000002C00 0000000000000100 0000FFFFFFFFFFFF FFFFFCFFFFFFE9FF
00C0: FFFF2C0000002C00 0000360200002301 0000000000000000 0000030000000F41
00E0: 70706C6963617469 6F6E4974656D0743 6C61737365730763 6C734C6F6E670000
0100: 0000018004000100 0000000000006800 00002C0000000000 000001000000FFFF
0120: FFFFFFFFFFFFFCFF FFFFE9FFFFFF4200 0000420000004C02 0000390100000000
0140: 0000000000000400 00000F4170706C69 636174696F6E4974 656D07436C617373
0160: 657307636C734C6F 6E670946756E6374 696F6E7300000000
.enddata
.head 2 -  Outline Window State: Maximized
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003001B00 0200000007000000 0000E91E910E0500 1D00FFFF4D61696E
0020: 0029000100040000 0000000000E91E80 0A00008600FFFF49 6E7465726E616C20
0040: 46756E6374696F6E 7300200001000400 000000000000E91E 800A0000DF00FFFF
0060: 5661726961626C65 73001E0001000400 000000000000F51E 100D0000F400FFFF
0080: 436C617373657300
.enddata
.data VIEWSIZE
0000: 8800
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0038B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.3"
.head 3 -  Top:    0.042"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 5.9"
.head 3 -  Top:    1.031"
.head 2 -  Fully Qualified External References? No
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: sybsal32.apl
.head 2 -  File Include: flatcontrols.app
.head 2 -  File Include: mtbl.apl
.head 2 -  File Include: mimg.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 3 +  Library name: user32.dll
.head 4 +  Function: OpenClipboard
.head 5 -  Description: The OpenClipboard function opens the clipboard for examination and prevents other applications from modifying the clipboard content.

Parameters:
	hWndNewOwner 		Identifies the window to be associated with the open clipboard. If this parameter is NULL,
				the open clipboard is associated with the current task.

Return Values:
	If the function succeeds, the return value is nonzero.
	If the function fails, the return value is zero. To get extended error information, call GetLastError.

Remarks
OpenClipboard fails if another window has the clipboard open.
An application should call the CloseClipboard function after every successful call to OpenClipboard.
The window identified by the hWndNewOwner parameter does not become the clipboard owner unless the EmptyClipboard function is called.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Window Handle: HWND
.head 4 +  Function: CloseClipboard
.head 5 -  Description: The CloseClipboard function closes the clipboard.

Parameters:
	This function has no parameters.

Return Values:
	If the function succeeds, the return value is nonzero.
	If the function fails, the return value is zero. To get extended error information, call GetLastError.

Remarks:
When the window has finished examining or changing the clipboard, close the clipboard by calling CloseClipboard.
This enables other windows to access the clipboard.

Do not place an object on the clipboard after calling CloseClipboard.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 -  Parameters
.head 4 +  Function: EmptyClipboard
.head 5 -  Description: The EmptyClipboard function empties the clipboard and frees handles to data in the clipboard. The function then assigns ownership of the clipboard to the window that currently has the clipboard open.

Parameters:
	This function has no parameters.

Return Values:
	If the function succeeds, the return value is nonzero.
	If the function fails, the return value is zero. To get extended error information, call GetLastError.

Remarks:
Before calling EmptyClipboard, an application must open the clipboard by using the OpenClipboard function.
If the application specifies a NULL window handle when opening the clipboard, EmptyClipboard succeeds but sets the clipboard owner to NULL.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 -  Parameters
.head 4 +  Function: SetClipboardData
.head 5 -  Description: The SetClipboardData function places data on the clipboard in a specified clipboard format. The window must be the current clipboard owner,
and the application must have called the OpenClipboard function. (When responding to the WM_RENDERFORMAT and
WM_RENDERALLFORMATS messages, the clipboard owner must not call OpenClipboard before calling SetClipboardData.)

Parameters:
	uFormat 		Specifies a clipboard format. This parameter can be a registered format or any of the standard clipboard formats
			listed in the following Remarks section. For information about registered clipboard formats,
			see the RegisterClipboardFormat function.
	hMem 		Identifies the data in the specified format. This parameter can be NULL, indicating that the window provides data
			in the specified clipboard format (renders the format) upon request. If a window delays rendering,
			it must process the WM_RENDERFORMAT and WM_RENDERALLFORMATS messages.

	Once SetClipboardData is called, the system owns the object identified by the hMem parameter. The application can read the data,
	but must not free the handle or leave it locked. If the hMem parameter identifies a memory object, the object must have been allocated
	using the GlobalAlloc function with the GMEM_MOVEABLE and GMEM_DDESHARE flags.

Return Values:
	If the function succeeds, the return value is the handle of the data.
	If the function fails, the return value is NULL. To get extended error information, call GetLastError.

Remarks:
The uFormat parameter can identify a registered clipboard format, or it can be one of the following values:
Value 			Meaning
CF_BITMAP 		A handle to a bitmap (HBITMAP).
CF_DIB 			A memory object containing a BITMAPINFO structure followed by the bitmap bits.
CF_DIF 			Software Arts Data Interchange Format.
CF_DSPBITMAP 		Bitmap display format associated with a private format. The hMem parameter must be a handle of data that can be
			displayed in bitmap format in lieu of the privately formatted data.
CF_DSPENHMETAFILE 	Enhanced metafile display format associated with a private format. The hMem parameter must be a handle of data
			that can be displayed in enhanced metafile format in lieu of the privately formatted data.
CF_DSPMETAFILEPICT 	Metafile-picture display format associated with a private format. The hMem parameter must be a handle of data
			that can be displayed in metafile-picture format in lieu of the privately formatted data.
CF_DSPTEXT 		Text display format associated with a private format. The hMem parameter must be a handle of data that can be
			displayed in text format in lieu of the privately formatted data.
CF_ENHMETAFILE 	A handle of an enhanced metafile (HENHMETAFILE).
CF_GDIOBJFIRST through  	Range of integer values for application-defined GDI object clipboard formats. Handles associated with clipboard
CF_GDIOBJLAST		formats in this range are not automatically deleted using the GlobalFree function when the
			clipboard is emptied. Also, when using values in this range, the hMem parameter is not a handle to a GDI object,
			but is a handle allocated by the GlobalAlloc function with the GMEM_DDESHARE and GMEM_MOVEABLE flags.
CF_HDROP 		A handle of type HDROP that identifies a list of files. An application can retrieve information about the files by
			passing the handle to the DragQueryFile functions.
CF_LOCALE 		The data is a handle to the locale identifier associated with text in the clipboard. When you close the clipboard,
			if it contains CF_TEXT data but no CF_LOCALE data, the system automatically sets the CF_LOCALE format to the
			current input locale. You can use the CF_LOCALE format to associate a different locale with the clipboard text.

			An application that pastes text from the clipboard can retrieve this format to determine which character set was
			used to generate the text.

			Note that the clipboard does not support plain text in multiple character sets. To achieve this, use a fomatted text
			data type such as RTF instead.

			Windows NT: The system uses the code page associated with CF_LOCALE to implicitly convert from CF_TEXT
			to CF_UNICODETEXT. Therefore, the correct code page table is used for the conversion.
CF_METAFILEPICT 	Handle of a metafile picture format as defined by the METAFILEPICT structure. When passing a
			CF_METAFILEPICT handle by means of dynamic data exchange (DDE), the application responsible for deleting
			hMem should also free the metafile referred to by the CF_METAFILEPICT handle.
CF_OEMTEXT 		Text format containing characters in the OEM character set. Each line ends with a carriage return/linefeed (CR-LF)
			combination. A null character signals the end of the data.
CF_OWNERDISPLAY 	Owner-display format. The clipboard owner must display and update the clipboard viewer window, and receive the
			WM_ASKCBFORMATNAME, WM_HSCROLLCLIPBOARD, WM_PAINTCLIPBOARD, WM_SIZECLIPBOARD, and
			WM_VSCROLLCLIPBOARD messages. The hMem parameter must be NULL.
CF_PALETTE 		Handle of a color palette. Whenever an application places data in the clipboard that depends on or assumes a
			color palette, it should place the palette on the clipboard as well.
 
			If the clipboard contains data in the CF_PALETTE (logical color palette) format, the application should use the
			SelectPalette and RealizePalette functions to realize (compare) any other data in the clipboard against that logical palette.

			When displaying clipboard data, Windows clipboard always uses as its current palette any object on the clipboard
			that is in the CF_PALETTE format.
CF_PENDATA 		Data for the pen extensions to the Microsoft Windows for Pen Computing.
CF_PRIVATEFIRST through	Range of integer values for private clipboard formats. Handles associated with private clipboard formats are not
CF_PRIVATELAST 		freed automatically; the clipboard owner must free such handles, typically in response to the
			WM_DESTROYCLIPBOARD message.
CF_RIFF 			Represents audio data more complex than can be represented in a CF_WAVE standard wave format.
CF_SYLK			Microsoft Symbolic Link (SYLK) format.
CF_TEXT 		Text format. Each line ends with a carriage return/linefeed (CR-LF) combination. A null character signals the
			end of the data. Use this format for ANSI text.
CF_WAVE 		Represents audio data in one of the standard wave formats, such as 11 kHz or 22 kHz pulse code modulation (PCM).
CF_TIFF 			Tagged-image file format.
CF_UNICODETEXT 	Windows NT only: Unicode text format. Each line ends with a carriage return/linefeed (CR-LF) combination.
			A null character signals the end of the data.
 
The operating system performs implicit data format conversions between certain clipboard formats when an application calls the GetClipboardData
function. For example, if the CF_OEMTEXT format is on the clipboard, a window can retrieve data in the CF_TEXT format.
The format on the clipboard is converted to the requested format on demand. The following table shows the clipboard data type conversions
that are available. Note that some of these automatic type conversions are not available on all platforms.
Clipboard Format 		Conversion Format 		Platform Support
CF_BITMAP 		CF_DIB 			Windows NT, Windows 95
CF_DIB 			CF_BITMAP 		Windows NT, Windows 95
CF_DIB 			CF_PALETTE 		Windows NT, Windows 95
CF_ENHMETAFILE 	CF_METAFILEPICT 	Windows NT, Windows 95
CF_METAFILEPICT 	CF_ENHMETAFILE 	Windows NT, Windows 95
CF_OEMTEXT 		CF_TEXT 		Windows NT, Windows 95
CF_OEMTEXT 		CF_UNICODETEXT 	Windows NT
CF_TEXT 		CF_OEMTEXT 		Windows NT, Windows 95
CF_TEXT 		CF_UNICODETEXT 	Windows NT
CF_UNICODETEXT 	CF_OEMTEXT 		Windows NT
CF_UNICODETEXT 	CF_TEXT 		Windows NT
 
If the operating system provides an automatic type conversion for a particular clipboard format, there is no advantage to placing the
conversion format(s) on the clipboard.

When copying bitmaps, it is best to place only the CF_DIB format on the clipboard. This is because the colors in a device-dependent bitmap
(CF_BITMAP) are relative to the system palette, which may change before the bitmap is pasted. If only the CF_DIB format is on the clipboard
and a window requests the CF_BITMAP format, the system renders the device-dependent bitmap using the current palette at that time.

If you place the CF_BITMAP format on the clipboard (and not CF_DIB), the system renders the CF_DIB clipboard format as soon as the
clipboard is closed. This ensures that the correct palette is used to generate the device-independent bitmap
(DIB). Conversions between other clipboard formats occur upon demand.

Windows platforms support two clipboard formats for metafiles: CF_ENHMETAFILE and CF_METAFILEPICT.
Specify CF_ENHMETAFILE for enhanced metafiles and CF_METAFILEPICT for Windows metafiles.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: HANDLE
.head 5 +  Parameters
.head 6 -  Number: UINT
.head 6 -  Number: HANDLE
.head 4 +  Function: SendMessageTimeoutA
.head 5 -  Description: Retrieve a string pointer in lParam
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: LONG
.head 5 +  Parameters
.head 6 -  Window Handle: HWND
.head 6 -  Number: UINT
.head 6 -  Number: WPARAM
.head 6 -  Receive String: LPVOID
.head 6 -  Number: UINT
.head 6 -  Number: UINT
.head 6 -  Receive Number: LPLONG
.head 4 +  ! Function: SetWindowPos
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Window Handle: HWND
.head 6 -  Window Handle: HWND
.head 6 -  Number: INT
.head 6 -  Number: INT
.head 6 -  Number: INT
.head 6 -  Number: INT
.head 6 -  Number: UINT
.head 3 +  Library name: KERNEL32.DLL
.head 4 +  Function: GetEnvironmentVariableA
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: DWORD
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  Receive String: LPSTR
.head 6 -  Number: DWORD
.head 4 +  Function: GlobalAlloc
.head 5 -  Description: The GlobalAlloc function allocates the specified number of bytes from the heap. In the linear Win32 API environment,
there is no difference between the local heap and the global heap.

Parameters:
	uFlags 		Specifies how to allocate memory. If zero is specified, the default is GMEM_FIXED. Except for the incompatible combinations that are specifically noted, any combination of the following flags can be used.
			To indicate whether the function allocates fixed or movable memory, specify one of the first four flags:
			Flag  Meaning
 			GMEM_FIXED 		Allocates fixed memory. This flag cannot be combined with the GMEM_MOVEABLE or GMEM_DISCARDABLE flag.
						The return value is a pointer to the memory block. To access the memory, the calling process simply casts the return value to a pointer.
			GMEM_MOVEABLE 	Allocates movable memory. This flag cannot be combined with the GMEM_FIXED flag. The return value is the handle of the memory object.
						The handle is a 32-bit quantity that is private to the calling process. To translate the handle into a pointer, use the GlobalLock function.
			GPTR 			Combines the GMEM_FIXED and GMEM_ZEROINIT flags.
 			GHND 			Combines the GMEM_MOVEABLE and GMEM_ZEROINIT flags.
 			GMEM_DDESHARE 	Allocates memory to be used by the dynamic data exchange (DDE) functions for a DDE conversation. Unlike Windows version 3. x, this memory is not shared globally.
						However, this flag is available for compatibility purposes. It may be used by some applications to enhance the performance of DDE operations and should, therefore,
						be specified if the memory is to be used for DDE. Only processes that use DDE or the clipboard for interprocess communications should specify this flag.
			GMEM_DISCARDABLE 	Allocates discardable memory. This flag cannot be combined with the GMEM_FIXED flag. Some Win32-based applications may ignore this flag.
			GMEM_LOWER 		Ignored. This flag is provided only for compatibility with Windows version 3. x.
			GMEM_NOCOMPACT 	Does not compact or discard memory to satisfy the allocation request.
			GMEM_NODISCARD 	Does not discard memory to satisfy the allocation request.
			GMEM_NOT_BANKED 	Ignored. This flag is provided only for compatibility with Windows version 3. x.
			GMEM_NOTIFY 		Ignored. This flag is provided only for compatibility with Windows version 3. x.
			GMEM_SHARE 		Same as the GMEM_DDESHARE flag.
			GMEM_ZEROINIT 		Initializes memory contents to zero.
	dwBytes 		Specifies the number of bytes to allocate. If this parameter is zero and the uFlags parameter specifies the GMEM_MOVEABLE flag, the function returns a handle to a memory object that is marked as discarded.

Return Values:
	If the function succeeds, the return value is the handle of the newly allocated memory object.
	If the function fails, the return value is NULL.

Remarks:
If the heap does not contain sufficient free space to satisfy the request, GlobalAlloc returns NULL.

Because NULL is used to indicate an error, virtual address zero is never allocated. It is, therefore, easy to detect the use of a NULL pointer.

All memory is created with execute access; no special function is required to execute dynamically generated code.

Memory allocated with this function is guaranteed to be aligned on an 8-byte boundary.

The GlobalAlloc and LocalAlloc functions are limited to a combined total of 65,536 handles for GMEM_MOVEABLE and LMEM_MOVEABLE memory per process. This limitation does not apply to GMEM_FIXED or LMEM_FIXED memory.

If this function succeeds, it allocates at least the amount of memory requested. If the actual amount allocated is greater than the amount requested, the process can use the entire amount.
To determine the actual number of bytes allocated, use the GlobalSize function.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: HANDLE
.head 5 +  Parameters
.head 6 -  Number: UINT
.head 6 -  Number: DWORD
.head 4 +  Function: GlobalLock
.head 5 -  Description: The GlobalLock function locks a global memory object and returns a pointer to the first byte of the objects memory block.
The memory block associated with a locked memory object cannot be moved or discarded. For memory objects allocated with the
GMEM_MOVEABLE flag, the function increments the lock count associated with the memory object.

Parameters:
	hMem 		Identifies the global memory object. This handle is returned by either the GlobalAlloc or GlobalReAlloc function.

Return Values:
	If the function succeeds, the return value is a pointer to the first byte of the memory block.
	If the function fails, the return value is NULL. To get extended error information, call GetLastError.

Remarks:
The internal data structures for each memory object include a lock count that is initially zero. For movable memory objects,
GlobalLock increments the count by one, and the GlobalUnlock function decrements the count by one. For each call that a process
makes to GlobalLock for an object, it must eventually call GlobalUnlock. Locked memory will not be moved or discarded, unless the
memory object is reallocated by using the GlobalReAlloc function. The memory block of a locked memory object remains locked until its
lock count is decremented to zero, at which time it can be moved or discarded.

Memory objects allocated with the GMEM_FIXED flag always have a lock count of zero. For these objects, the value of the returned pointer
is equal to the value of the specified handle.

If the specified memory block has been discarded or if the memory block has a zero-byte size, this function returns NULL.

Discarded objects always have a lock count of zero.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: LPVOID
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 4 +  Function: GlobalUnlock
.head 5 -  Description: The GlobalUnlock function decrements the lock count associated with a memory object that was allocated with the GMEM_MOVEABLE flag.
This function has no effect on memory objects allocated with the GMEM_FIXED flag.

Parameters:
	hMem 		Identifies the global memory object. This handle is returned by either the GlobalAlloc or GlobalReAlloc function.

Return Values:
	If the memory object is still locked after decrementing the lock count, the return value is a nonzero value.
	If the function fails, the return value is zero. To get extended error information, call GetLastError. If GetLastError returns
	NO_ERROR, the memory object is unlocked.

Remarks:
The internal data structures for each memory object include a lock count that is initially zero. For movable memory objects, the GlobalLock
function increments the count by one, and GlobalUnlock decrements the count by one. For each call that a process makes to GlobalLock
for an object, it must eventually call GlobalUnlock. Locked memory will not be moved or discarded, unless the memory object is reallocated
by using the GlobalReAlloc function. The memory block of a locked memory object remains locked until its lock count is decremented to zero,
at which time it can be moved or discarded.

Memory objects allocated with the GMEM_FIXED flag always have a lock count of zero. If the specified memory block is fixed memory,
this function returns TRUE.

If the memory object is already unlocked, GlobalUnlock returns FALSE and GetLastError reports ERROR_NOT_LOCKED.
Memory objects allocated with the LMEM_FIXED flag always have a lock count of zero and cause the ERROR_NOT_LOCKED error.

A process should not rely on the return value to determine the number of times it must subsequently call GlobalUnlock for a memory object.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 3 +  Library name: msvcrt
.head 4 +  Function: memcpy
.head 5 -  Description: void *memcpy( void *dest, const void *src, size_t count );
.head 5 -  Export Ordinal: 0
.head 5 -  Returns
.head 5 +  Parameters
.head 6 -  Number: LPVOID
.head 6 -  String: LPVOID
.head 6 -  Number: DWORD
.head 3 +  Library name: CRPE32.DLL
.head 4 +  Function: PECheckFormula
.head 5 -  Description: The PECheckFormula function checks the text of a named formula for validity. Use this function to check a named formula for errors. This function works like the Check button in the Formula Editor. If the named formula contains an error, the
function returns False.

BOOL CRPE_API PECheckFormula (
	short printJob, 			//handle to print job
	char FAR *formulaName		//formula to be checked
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  String: LPSTR
.head 4 +  Function: PECheckGroupSelectionFormula
.head 5 -  Description: The PECheckGroupSelectionFormula function checks the text of the report's group selection formula for errors. Use this function when the group selection formula in a report has changed and you need to check the new group selection formula. If
there is an error in the formula, this function returns a False value.

BOOL CRPE_API PECheckGroupSelectionFormula (
	short printJob		//handle to print job
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PECheckSelectionFormula
.head 5 -  Description: Checks the text of the report's record selection formula for errors. Use this function whenever the record selection formula has been changed and you wish to check the formula for syntax errors. If the record selection formula contains an error, this
function returns a False value.

BOOL CRPE_API PECheckSelectionFormula (
	short printJob		//handle to print job
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PECanCloseEngine
.head 5 -  Description: PRO Function
The PECanCloseEngine function determines whether or not the Report Engine can be closed. Use this function before calling PECloseEngine to verify that the engine is no longer processing print jobs.  If the Report Engine closes while a print job
is still running, an error can occur in your application or on the users system.

BOOL CRPE_API PECanCloseEngine (void);

.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 -  Parameters
.head 4 +  Function: PECloseEngine
.head 5 -  Description: PECloseEngine terminates the Report Engine. All printing is stopped and all windows are closed.

NOTE:  This will only happen if the calling application is the last one using CRPE.

This function stops the Report Engine from sending output, but the report may continue to print from data remaining in the spooler.

This function is a necessary part of any customprint link. It is also required for any printonly link in which you want the report to print to a window that is to remain visible after the report is printed. It is not necessary to use this function with a printonly
link where you are directing the report to a printer.

void CRPE_API PECloseEngine();
.head 5 -  Export Ordinal: 0
.head 5 -  Returns
.head 5 -  Parameters
.head 4 +  Function: PEClosePrintJob
.head 5 -  Description: PEClosePrintJob closes the print job. If printing has not yet finished, it continues; if the print window is open, it stays open. This function is used as a mandatory part of each customprint link to shut down the print job once it has finished printing to
screen or to window.

BOOL CRPE_API PEClosePrintJob (
	short printJob		//handle to print job
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PECloseWindow
.head 5 -  Description: PECloseWindow closes the print window. Use this function as part of a customprint link to enable the user to review the report in the print window and then to close the window (in response to a user event).

Use PECloseWindow to replace the Close button when PEShowPrintControls disables the Print Control buttons.

void CRPE_API PECloseWindow (
	short printJob		//handle to print job
	);
.head 5 -  Export Ordinal: 0
.head 5 -  Returns
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEDeleteNthSortField
.head 5 -  Description: The PEDeleteNthSortField function removes the specified sort field from the sort order. This function is used as part of a customprint link whenever you want to delete sort fields that were established for the report at design time. When you give the
user the ability to delete sort field(s) at print time, your link must include code to replace sortFieldN with usergenerated values.

This function can be used by itself to delete an existing sort field when the sort field number is already known.

The function can also be used as one of a series of functions: PEGetNSortFields (called once), PEGetNthSortField/ PEGetHandleString (called together as many times as needed to identify the correct sort field), and PEDeleteNthSortField (called
once, when the correct sort field is identified). The series can be used in a customprint link to identify and then delete an existing sort field and/or sort order at print time in response to a user selection.

BOOL CRPE_API PEDeleteNthSortField (
	short printJob, 		//handle to print job
	short sortFieldN		//number of sort field to delete
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetErrorCode
.head 5 -  Description: Returns a number that indicates the status of the most recent Report Engine function called. When a call to another function fails, this call gets the error code that was generated so you can take some action based on that error code.

short CRPE_API PEGetErrorCode (
	short printJob		//handle to print job
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetErrorText
.head 5 -  Description: Returns a string handle describing the status of the most recent Report Engine function called. This function is typically used together with PEGetHandleString
. These functions can be used in a customprint link to display the error string to the user as part of an error message.

BOOL CRPE_API PEGetErrorText (
	short printJob, 		//handle to print job
	HANDLE FAR *textHandle,	//pointer to error string handle
	short Far *textLength	//pointer to error string length
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetFormula
.head 5 -  Description: Returns the text of the named formula as a string handle. This function is typically used as one of a series of functions (PEGetFormula/PEGetHandleString, PESetFormula). The series can be used in a customprint link to identify and then change
an existing formula at print time in response to a user selection.

BOOL CRPE_API PEGetFormula (
	short printJob, 		//handle to print job
	char *formulaName, 	//pointer to formula name string
	HANDLE FAR *textHandle, //pointer to formula string handle
	short FAR *textLength	//pointer to formula string length
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  String: LPSTR
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetGroupSelectionFormula
.head 5 -  Description: Returns the string handle for the group selection formula used in the specified report. This function is typically used as one of a series of functions (PEGetGroupSelectionFormula, PEGetHandleString, PESetGroupSelectionFormula). This series can
be used in a customprint link to identify and then change an existing group selection formula at print time in response to a user selection.

BOOL CRPE_API PEGetGroupSelectionFormula (
	short printJob, 		//handle to print job
	HANDLE FAR *textHandle,	//handle to formula string
	short FAR *textLength	//handle to formula string length
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetHandleString
.head 5 -  Description: This function will return the text that the string handle is pointing to.  The buffer will obtain the actual text.  This function is used in conjunction with functions that return variable length strings. After your program allocates a buffer of sufficient size,
this function moves the string from the string handle to the buffer.

BOOL CRPE_API PEGetHandleString (
	HANDLE textHandle, 	// string handle
	char FAR *buffer, 	// pointer to receiving array
	short bufferLength	// length of buffer
	);
NOTE:  When you call the function that produces the string, it returns a length that includes a provision for the null byte at the end of the string. A buffer set to that length will hold the entire string including the terminating null byte.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: HANDLE
.head 6 -  Receive String: LPSTR
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetNthSortField
.head 5 -  Description: Returns information about one of the sort fields in the specified report: that is, it returns the name of the field and the direction (ascending or descending) of the sort. The name of the sort field is returned as a string handle. This function is typically
used as one of a series of functions: PEGetNSortFields (called once), PEGetNthSortField/, PEGetHandleString (called together as many times as needed to identify the correct sort field), and PESetNthSortField (called once when the correct sort
field is identified). The series can be used in a customprint link to identify and then change an existing sort field and/or sort order at print time in response to a user selection.

BOOL CRPE_API PEGetNthSortField (
	short printJob,		//handle to print job
	short sortFieldN,		//number of sort field
	HANDLE FAR *nameHandle,	//field name string handle pointer
	short FAR *nameLength,	//field name string length pointer
	short FAR *direction	//pointer to sort direction setting
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetNthTableLocation
.head 5 -  Description: The PEGetNthTableLocation function determines the location of a selected table used in the specified print job. This function is typically combined with PESetNthTableLocation to identify the location of a table and then to change it.

BOOL CRPE_API PEGetNthTableLocation (
	short printJob,		//handle to print job
	short tableN,		//number of table
	struct PETableLocation FAR *location
					//structure pointer
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  Receive String: LPSTR
.head 4 +  Function: PEGetNthTableLogOnInfo
.head 5 -  Description: The PEGetNthTableLogOnInfo function retrieves into the PELogOnInfo structure the log on information required by a report.

BOOL CRPE_API PEGetNthTableLogOnInfo (
	short printJob,	//handle to print job
	short tableN,	//number of table
	struct PELogOnInfo FAR *logOnInfo	//structure pointer
	);

struct PELogOnInfo
{
	WORD structSize;
	char ServerName [128];
	char DatabaseName [128];
	char UserID [128];
	char Password [128];
};
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 4 +  Function: PEGetNthTableType
.head 5 -  Description: The PEGetNthTableType function allows the application to determine the type of each table.

This function is one of a series of functions that enable you to retrieve and update database information in an opened report so that the report can be printed using different server, database, user, and/or table location settings.

BOOL CRPE_API PEGetNthTableType (
	short printJob,		//handle to print job
	short tableN,		//number of table
	struct PETableType FAR *tableType	//structure pointer
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  Receive String: char[64]
.head 7 -  Receive String: char[255]
.head 7 -  Receive String: char[1]
.head 7 -  Receive Number: WORD
.head 4 +  Function: PEGetNSortFields
.head 5 -  Description: Returns the number of sort fields in the specified report. This function is typically used as one of a series of functions: PEGetNSortFields (called once), PEGetNthSortField/ PEGetHandleString (called together as many times as needed to identify
the correct sort field), PESetNthSortField (called once when the correct sort field is identified). The series can be used in a customprint link to identify and then change an existing sort field and/or sort order at print time in response to a user
selection.

short CRPE_API PEGetNSortFields (
	short printJob	//handle to print job
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetNTables
.head 5 -  Description: The PEGetNTables function retrieves the number of tables in the open report.  It counts both PC and SQL databases.

This function is one of a series of functions that enable you to retrieve and update database information in an opened report so that the report can be printed using different server, database, user, and/or table location settings.

short CRPE_API PEGetNTables (
	short printJob	//handle to print job
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetSelectionFormula
.head 5 -  Description: Returns the string handle for the selection formula used in the specified report. This function is typically used as one of a series of functions (PEGetSelectionFormula, PEGetHandleString, PESetSelectionFormula). The series can be used in a
customprint link to identify and then change an existing record selection formula at print time in response to a user selection.

BOOL CRPE_API PEGetSelectionFormula (
	short printJob,	//handle to print job
	HANDLE FAR *textHandle,	//pointer to formula string handle
	short FAR *textLength	//pointer to formula string length
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetSQLQuery
.head 5 -  Description: PRO Function
The PEGetSQLQuery function returns the same query that appears in the Show SQL Query dialog box in Crystal Reports, in a syntax that is specific to the database driver you are using.

You can use this function to retrieve the SQL query that will be generated to print the report, and you can update the query using PESetSQLQuery.

BOOL CRPE_API PEGetSQLQuery (
	short printJob,		//handle to print job
	HANDLE FAR *textHandle,	//pointer to query string handle
	short FAR *textLength	//pointer to query string length
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetNParameterFields
.head 5 -  Description: The PEGetNParameterFields function determines the number of parameter (prompting) fields used in the report.

short CRPE_API PEGetNParameterFields (
	short printJob		//handle to print job
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetNthParameterField
.head 5 -  Description: Returns information about one of the parameter fields in the specified report: that is, it returns the name of the field, the
data type, and information about the value set for the field. The name of the parameter field is returned as a string handle.
This function is typically used as one of a series of functions: PEGetNParameterFields (called once), PEGetNthParameterField/,
PEGetHandleString (called together as many times as needed to identify the correct parameter field), and PESetNthParameterField
 (called once when the correct parameter field is identified). The series can be used in a customprint link to identify and then
change an existing parameter field value at print time in response to a user selection.

BOOL CRPE_API PEGetNthParameterField (
	short printJob,		//handle to print job
	short parameterN,		//parameter field number
	struct PEParameterFieldInfo FAR *parameterInfo //structure 									     //pointer
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive String: char[254]
.head 7 -  Receive String: char[2]
.head 7 -  Receive String: char[254]
.head 7 -  Receive String: char[2]
.head 7 -  Receive String: char[254]
.head 7 -  Receive String: char[2]
.head 7 -  Receive String: char[254]
.head 7 -  Receive String: char[2]
.head 7 -  Receive String: char[128]
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DOUBLE
.head 7 -  Receive Number: DOUBLE
.head 7 -  Receive String: char[254]
.head 7 -  Receive String: char[2]
.head 7 -  Receive Number: WORD
.head 4 +  Function: PELogOnServer
.head 5 -  Description: The PELogOnServer function logs on to the specified server.

BOOL CRPE_API PELogOnServer (
	char FAR *dllName,	//pointer to name of data source DLL
	struct PELogOnInfo FAR *logOnInfo	//structure pointer
	);
struct PELogOnInfo
{
	WORD structSize;
	char ServerName [128];
	char DatabaseName [128];
	char UserID [128];
	char Password [128];
};
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  String: LPSTR
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 4 +  Function: PELogOffServer
.head 5 -  Description: Logs off the specified server. Use any time you have to log off a specified server.

BOOL CRPE_API PELogOffServer (
	char FAR *dllName,	//pointer to name of data source DLL
	struct PELogOnInfo FAR *logOnInfo	//structure pointer
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  String: LPSTR
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 4 +  Function: PEPrintReport
.head 5 -  Description: Prints the specified report to either the printer or to a print window.  This function establishes a printonly link where changes are made during runtime by other PE calls are ignored. Use any time you simply want to print a report from an application
without giving the user the ability to customize the report.

short CRPE_API PEPrintReport (
	char FAR *reportFilePath,
				//pointer to path string
	BOOL toDefaultPrinter,
				//send to default printer setting
	BOOL toWindow,
				//send to window setting
	char FAR *title,
				//pointer to title string
	int left,		//x coordinate of window top left corner
	int top,		//y coordinate of window top left corner
	int width,		//width of window
	int height,		//height of window
	DWORD style,	//window style
	HWND parentWindow	//parent window handle
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  ! Report File and Path
.head 6 -  String: LPSTR
.head 6 -  ! ToDefaultPrinter
.head 6 -  Boolean: BOOL
.head 6 -  ! To Window
.head 6 -  Boolean: BOOL
.head 6 -  ! Title
.head 6 -  String: LPSTR
.head 6 -  ! Left
.head 6 -  Number: INT
.head 6 -  ! Top
.head 6 -  Number: INT
.head 6 -  ! Width
.head 6 -  Number: INT
.head 6 -  ! Height
.head 6 -  Number: INT
.head 6 -  ! Style
.head 6 -  Number: DWORD
.head 6 -  ! ParentWindow
.head 6 -  Window Handle: HWND
.head 4 +  Function: PEOpenEngine
.head 5 -  Description: Prepares the Report Engine for requests. This function is a necessary part of any customprint link. It is also required for any printonly link in which you want the report to print to a window that is to remain visible after the report is printed. It is not
necessary to use this function with a printonly link where you are directing the report to a printer.

BOOL CRPE_API PEOpenEngine ();
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 -  Parameters
.head 4 +  Function: PEOpenPrintJob
.head 5 -  Description: Prepares to print a report and returns a number which identifies the particular print job. The number returned is called a print job handle, and must be used in all subsequent calls related to the new print job (where a print job handle is required). This
function is used as a mandatory part of a customprint link to generate the return of a print job handle. The handle is then used as the printJob parameter in each additional customprint link function call (where a printJob parameter is required).

short PEOpenPrintJob (
	char *reportFilePath	//pointer to filename and path
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  String: LPSTR
.head 4 +  Function: PEOutputToWindow
.head 5 -  Description: Prepares to direct printed output to a print window . This function is used as part of a customprint link to whenever you want the report printed to the print window instead of to the printer.

BOOL CRPE_API PEOutputToWindow (
	short printJob,	//handle to print job
	char FAR *title,	//pointer to title string
	short left,		//x coordinate, top left of print window
	short top,		//y coordinate, top left of print window
	short width,	//width of print window
	short height,	//height of print window
	long style,		//window style setting
	HWND parentWindow	//handle to parent window (if any)
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  String: LPSTR
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: LONG
.head 6 -  Window Handle: HWND
.head 4 +  Function: PEOutputToPrinter
.head 5 -  Description: The PEOutputToPrinter function prepares to direct printed output to a printer.

  If a printer has been specified via the PESelectPrinter function, output will be sent to that printer.

  If there is no PESelectPrinter selection but there is a printer specified in the report via the Print|Select Printer menu command, output will be sent to that printer.

  If there is no PESelectPrinter selection, and there is no printer specified in the report, output will be to the Windows default printer.

  PEOpenPrintJob opens the print job with the printer specified in the report (if there is one) or with the Windows default printer (if no printer is specified in the report).
BOOL CRPE_API PEOutputToPrinter (
	short printJob,		//handle to print job
	short nCopies		//number of copies to be printed
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PESetFormula
.head 5 -  Description: Changes the specified formula to the formula string you supply as a parameter. This function will only change the text of a formula which already exists in the report; you can not use it to add a formula. This function can be used by itself to replace
the formula string for a known formula.

This function can also be used as one of a series of functions (PEGetFormula, PEGetHandleString, PESetFormula). The series can be used in a customprint link to identify and then change an existing formula at print time in response to a user
selection.

When you give the user the ability to change the formula at print time, your link must include code to replace formulaString with a usergenerated value.

BOOL CRPE_API PESetFormula (
	short printJob,		//handle to print job
	char *formulaName,	//pointer to formula name string
	char FAR *formulaString	//pointer to new formula string
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  String: LPSTR
.head 6 -  String: LPSTR
.head 4 +  Function: PESetGroupSelectionFormula
.head 5 -  Description: Changes the group selection formula to the formula string you supply as a parameter. This function can be used by itself to replace a known group selection formula.

This function can also be used as one of a series of functions (PEGetGroupSelectionFormula, PEGetHandleString, PESetGroupSelectionFormula). The series can be used in a customprint link to identify and then change an existing group selection
formula at print time in response to a user selection.

When you give the user the ability to change the group selection formula at print time, your link must include code to replace formulaString with a user
generated value.

BOOL CRPE_API PESetGroupSelectionFormula (
	short printJob,		//handle to print job
	char FAR *formulaString
					//pointer to new formula string
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  String: LPSTR
.head 4 +  Function: PESetNthParameterField
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  Number: WORD
.head 7 -  Number: WORD
.head 7 -  Number: WORD
.head 7 -  String: char[254]
.head 7 -  String: char[2]
.head 7 -  String: char[254]
.head 7 -  String: char[2]
.head 7 -  String: char[254]
.head 7 -  String: char[2]
.head 7 -  String: char[254]
.head 7 -  String: char[2]
.head 7 -  String: char[128]
.head 7 -  Number: WORD
.head 7 -  Number: WORD
.head 7 -  Number: DOUBLE
.head 7 -  Number: DOUBLE
.head 7 -  String: char[254]
.head 7 -  String: char[2]
.head 7 -  Number: WORD
.head 4 +  Function: PESetNthSortField
.head 5 -  Description: Sets one of the sort fields in the specified report. This function can be used by itself to set a sort field/direction when there is not one already set, or to change a sort field/direction when the number and name of the sort field are known.

The function can also be used as one of a series of functions: PEGetNSortFields (called once), PEGetNthSortField/PEGetHandleString (called together as many times as needed to identify the correct sort field), and PESetNthSortField (called once
when the correct sort field is identified). The series can be used in a customprint link to identify and then change an existing sort field and/or sort order at print time in response to a user selection.

When you give the user the ability to specify sort field(s) and/or direction at print time, your link must include code to replace name, and/or direction with user
generated values.

BOOL CRPE_API PESetNthSortField (
	short printJob,	//handle to print job
	short sortFieldN,	//number of sort field
	char FAR *name,	//pointer to sort field name
	short direction	//sort direction setting
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  String: LPSTR
.head 6 -  Number: SHORT
.head 4 +  Function: PESetNthTableLocation
.head 5 -  Description: The PESetNthTableLocation function sets the location for a selected table in the specified print job. This function is typically combined with PEGetNthTableLocation to identify the location of a table and then to change it.

BOOL CRPE_API PESetNthTableLocation (
	short printJob,	//handle to print job
	short tableN,	//table number
	struct PETableLocation FAR *location //structure pointer
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  String: LPSTR
.head 4 +  Function: PESetNthTableLogOnInfo
.head 5 -  Description: The PESetNthTableLogOnInfo function sets the log on information for the specified print job to the values in the PELogOnInfo structure.

BOOL CRPE_API PESetNthTableLogOnInfo (
	short printJob,	//handle to print job
	short tableN,	//table number
	struct PELogOnInfo FAR *logOnInfo,
				//structure pointer
	BOOL propagateAcrossTables
				//apply to other tables setting
	);
struct PELogOnInfo
{
	WORD structSize;
	char ServerName [128];
	char DatabaseName [128];
	char UserID [128];
	char Password [128];
};
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 6 -  Boolean: BOOL
.head 4 +  Function: PESetSelectionFormula
.head 5 -  Description: Changes the selection formula to the formula string you supply as a parameter. This function can be used by itself to replace a known record selection formula.

The function can also be used as one of a series of functions (PEGetSelectionFormula, PEGetHandleString, PESetSelectionFormula). The series can be used in a customprint link to identify and then change an existing record selection formula at
print time in response to a user selection.

When you give the user the ability to change the record selection formula at print time, your link must include code to replace formulaString with a user
generated value.

BOOL CRPE_API PESetSelectionFormula (
	short printJob,		//handle to print job
	char FAR *formulaString	//pointer to new formula string
	);


.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  String: LPSTR
.head 4 +  Function: PESetSQLQuery
.head 5 -  Description: PRO Function
The PESetSQLQuery function changes the SQL query to the query string you supply as a parameter. Use this function to update the SQL query that will be used to print the report, typically to add optimizations to the WHERE clause.

BOOL CRPE_API PESetSQLQuery (
	short printJob,		//handle to print job
	char FAR *queryString	//pointer to new query string
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  String: LPSTR
.head 4 +  Function: PEStartPrintJob
.head 5 -  Description: Starts the printing of a report. This function is used as a mandatory part of each customprint link to trigger the printing of a report to the printer or to the print window.

BOOL CRPE_API PEStartPrintJob (
	short printJob, 		//handle to print job
	BOOL waitUntilDone //return when printing starts? setting
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Boolean: BOOL
.head 4 +  Function: PESetNthParam
.head 5 -  Description: PRO Function
Sets the value of a parameter in a stored procedure. Use this function when working with stored procedures in SQL database tables to set the value of a parameter in a stored procedure.

BOOL CRPE_API PESetNthParam (
	short printJob,		//handle to print job
	short paramN,		//parameter number
	LPCSTR szParamValue	//parameter value
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  String: LPCSTR
.head 4 +  Function: PETestNthTableConnectivity
.head 5 -  Description: The PETestNthTableConnectivity function tests whether a database table's settings are valid and ready to be reported on. This function is typically used if you plan to print at a later time but you want to test now to make sure everything is in order
for logging on.

BOOL CRPE_API PETestNthTableConnectivity (
	short printJob,	//handle to print job
	short tableN	//table number
	);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PEZoomPreviewWindow
.head 5 -  Description: Changes the magnification of the preview window to a specified level. Use this function when the report has been printed to a preview window and you need to set the magnification of the preview window to a specific level. There are three default magnifications for the preview
window: Full Page, Fit One Side, and Fit Both Sides. The magnification level can also be set to a specific percentage.

BOOL CRPE_API PEZoomPreviewWindow (

Parameters

printJob	The handle of the print job being displayed in the preview window.
level	The zoom level you wish to set the preview window at. This value can be a value from 25 to 400, indicating a magnification percentage, or you can use one of the following constants:
Constant	Value	Meaning
PE_ZOOM_FULL_SIZE	0	Full Page
PE_ZOOM_SIZE_FIT_ONE_SIDE	1	Fit One Side
PE_ZOOM_SIZE_FIT_BOTH
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PEShowPrintControls
.head 5 -  Description: Displays the print controls (the First, Previous, Next, and Last Page buttons, as well as, the buttons for Cancel, Close, Export, and Print to Printer). Use any time you want to provide control over whether print controls are displayed or not.

BOOL CRPE_API PEShowPrintControls (

Parameters

printJob	Specifies the handle to the print job for which you want to display print controls.
showPrintControls	Indicates whether or not the function is to display print controls. You may use either of the following values:
Value	Meaning
TRUE	The function displays the print controls.
FALSE	The function hides the print controls.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.

Remarks

Print controls are displayed by default. It is not necessary to use this function simply to display controls but only if you want the user to control whether or not the controls are visible.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Boolean: BOOL
.head 4 +  Function: PEShowPreviousPage
.head 5 -  Description: Displays the specified page in the preview window. Use these functions any time you want to display specific pages of a report in the preview window or give the user the ability to move forward and backward through a report in the preview window. The PEShowNthPage function
has some additional considerations and is presented in a separate topic.
BOOL CRPE_API PEShowPreviousPage (
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEShowNextPage
.head 5 -  Description: Displays the specified page in the preview window. Use these functions any time you want to display specific pages of a report in the preview window or give the user the ability to move forward and backward through a report in the preview window. The PEShowNthPage function
has some additional considerations and is presented in a separate topic.
BOOL CRPE_API PEShowNextPage (
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEShowLastPage
.head 5 -  Description: Displays the specified page in the preview window. Use these functions any time you want to display specific pages of a report in the preview window or give the user the ability to move forward and backward through a report in the preview window. The PEShowNthPage function
has some additional considerations and is presented in a separate topic.
BOOL CRPE_API PEShowLastPage (
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEShowFirstPage
.head 5 -  Description: Displays the specified page in the preview window. Use these functions any time you want to display specific pages of a report in the preview window or give the user the ability to move forward and backward through a report in the preview window. The PEShowNthPage function
has some additional considerations and is presented in a separate topic.
BOOL CRPE_API PEShowFirstPage (
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEShowNthPage
.head 5 -  Description: Displays the specified report page.

BOOL CRPE_API PEShowNthPage (

Parameters

printJob	Specifies the handle to the print job from which you want to display a page.
pageN	Specifies the report page you want to display.
Return value

TRUE (1) if the call is successful; FALSE(0) if an error occurs.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PESetWindowOptions
.head 5 -  Description: Sets display options for the preview window, including which preview window controls are available. This function must be called after PEOutputToWindow.

Syntax

BOOL CRPE_API PESetWindowOptions (

Parameters

printJob	Specifies the handle to the print job for which you wish to set preview window display options.
options	A pointer to a PEWindowOptions.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 4 +  Function: PESetTrackCursorInfo
.head 5 -  Description: Sets information for tracking the position of the mouse cursor over the preview window. This functions is only valid if the report was sent to a preview window (see PEOutputToWindow), and if events for the preview window have been enabled (see PEEnableEvent).

BOOL CRPE_API PESetTrackCursorInfo (

Parameters

printJob	Specifies the handle to the print job for which you wish to track events.
cursorInfo	Specifies a pointer to PETrackCursorInfo.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: LONG
.head 7 -  Number: LONG
.head 7 -  Number: LONG
.head 7 -  Number: LONG
.head 7 -  Number: LONG
.head 4 +  Function: PESetSectionFormatFormula
.head 5 -  Description: Changes the specified section format formula to the formula string you supply as a parameter. This function will only change the text of a formula which already exists in the report; you can not use it to add a formula.
When you give the user the ability to change the formula at print time, your link must include code to replace formulaString with a user-generated value.

BOOL CRPE_API PESetSectionFormatFormula (

Parameters

printJob			Specifies the handle of the print job for which you want to set a new selection formula string.
sectionCode		Specifies the code for the report section(s) for which you want to set formatting options. See Working with section codes.
formulaName		Specifies the name of the formula for which you want to supply a new string. Use one of the following constants:
Constant					Value	Meaning
PE_FFN_SECTION_VISIBILITY		58	Specifies that the section be visible. If not visible, no drill down will be available.
PE_FFN_SHOW_AREA			59	Specifies that the area be visible. If not visible, drill down will be available.
PE_FFN_NEW_PAGE_BEFORE		60	Specifies that a new page will be printed before the section.
PE_FFN_NEW_PAGE_AFTER		61	Specifies that a new page will be printed after the section.
PE_FFN_KEEP_TOGETHER		62	Specifies that the section will be kept together.
PE_FFN_SUPPRESS_BLANK_SECTION	63	Specifies that if the section is blank, it will not be printed.
PE_FFN_RESET_PAGE_N_AFTER		64	Specifies that page numbering will reset after the section.
PE_FFN_PRINT_AT_BOTTOM_OF_PAGE	65	Specifies that the section will be printed at the bottom of the page.
PE_FFN_UNDERLAY_SECTION		66	Specifies that the section will overlay any sections following.
PE_FFN_SECTION_BACK_COLOUR		67	Specifies the background color of the section.
formulaString	Specifies a pointer to the null-terminated string that you want to assign to the format formula.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails or if there is an error in the new formula.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  String: LPCSTR
.head 4 +  Function: PESetSectionFormat
.head 5 -  Description: Sets the section format settings for selected sections in the specified report to the values in PESectionOptions. This function can be used to provide specialized formatting for printing invoices, form letters, printing to pre-printed forms, etc. It allows you to hide a section, insert a
page break either before or after a section begins, reset the page number to 1 after a group value prints, prevent page breaks from spreading data from a single record over two pages, and to print group values only at the bottom of a page.

BOOL CRPE_API PESetSectionFormat (

Parameters

printJob	Specifies the handle of the print job for which you want to set section formatting options.
sectionCode	Specifies the code for the report section(s) for which you want to set formatting options. See Working with section codes.
options	Specifies the pointer to PESectionOptions. Use this structure to set your section options.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: LONG
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 4 +  Function: PESetReportTitle
.head 5 -  Description: This topic is only supported by the Professional Edition of Seagate Crystal Reports. For further information, see Upgrade Information.
Changes the report title in the report summary information. This function can also be used as one of a series of functions (
PEGetReportTitle, PEGetHandleString, or REFSetReportTitle). This series can be used in a Custom-Print link to identify and then change an existing report title at print time in response to a user selection.

BOOL CRPE_API PESetReportTitle (

Parameters

printJob	Specifies the handle of the print job for which you want to set the report title.
title	Specifies a null-terminated string containing the new title you want to assign to the report.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  String: LPCSTR
.head 4 +  Function: PESetReportSummaryInfo
.head 5 -  Description: The PESetReportSummaryInfo functions is used to set report summary information. Report summary information corresponds to the Summary Info dialog box in Seagate Crystal Reports.

BOOL CRPE_API PESetReportSummaryInfo (

Parameters

printJob	Specifies the print job for which you want to set summary information.
summaryInfo	Specifies the pointer to PEReportSummaryInfo.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 7 -  String: char[255]
.head 7 -  String: char[255]
.head 7 -  String: char[2]
.head 7 -  String: char[128]
.head 4 +  Function: PESetPrintOptions
.head 5 -  Description: Sets the print options for the report to the values supplied in PEPrintOptions. Use this function any time you want to set the starting page number, the ending page number, the number of report copies, and/or collation instructions for a print job at runtime in response to user
specifications.

BOOL CRPE_API PESetPrintOptions (

Parameters

printJob	Specifies the handle of the print job for which you want to set printing options.
options	Specifies the pointer to PEPrintOptions. If this parameter is set to 0 (null), the function prompts the user for these options. Using this, you can get the behavior of the print-to-printer button in the preview window by calling PESetPrintOptions with a null pointer and then
calling PEPrintWindow.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  Number: USHORT
.head 7 -  Number: USHORT
.head 7 -  Number: USHORT
.head 7 -  Number: USHORT
.head 7 -  String: char[255]
.head 7 -  String: char[255]
.head 7 -  String: char[2]
.head 4 +  Function: PESetPrintDate
.head 5 -  Description: ets a print date that may be different than the system calendar date. Use this function any time you want to show a print date (or use a print date in formulas) other than the actual date of printing.

BOOL CRPE_API PESetPrintDate (

Parameters

printJob	Specifies the handle of the print job for which you want to set the print date.
year	Specifies the year component of the print date. Enter a 4 digit year value (1994, 1993, etc.).
month	Specifies the month component of the print date. Months are numbered from 1 to 12, where January = 1 and December = 12. To use July as the print month, for example, you would enter the value 7.
day	Specifies the day component of the print date. Enter the actual day of the month you want to use (7, 18, 28, etc.).
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.


.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PESetNthTableSessionInfo
.head 5 -  Description: Sets the specified session information when opening a Microsoft Access table. Many Microsoft Access database tables require that a session be opened before the table can be used. Use PESetNthTableSessionInfo to open the session.

BOOL CRPE_API PESetNthTableSessionInfo (

Parameters

printJob	Specifies the handle of the print job for which you want to change the MS Access session information.
tableN	0 based table number specifying which table the session is being opened for.
sessionInfo	Refer to PESessionInfo for further information.
propagateAcrossTables	TRUE or FALSE value indicating whether the session information should be used for opening all tables being used in the report.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  String: char[128]
.head 7 -  String: char[128]
.head 7 -  Number: DWORD
.head 6 -  Boolean: BOOL
.head 4 +  Function: PESetNthGroupSortField
.head 5 -  Description: Sets one of the group sort fields in the specified report. This function can be used by itself to set a sort field and direction when there is not one already set, or to modify an existing sort field and direction when the sort field number, name, and direction are known.
The function can also be used as one of a series of functions: PEGetNGroupSortFields (called once), PEGetNthGroupSortField, or PEGetHandleString (called as many times as needed to identify the correct group sort field), and PESetNthGroupSortField (called once, when the
correct group sort field is identified). The series can be used in a Custom-Print link to identify and then change an existing group sort field and/or sort order at print time in response to a user selection.
When you give the user the ability to specify group sort field(s) and/or direction at print time, your link must include code to replace name, and/or direction with user-generated values.
BOOL CRPE_API PESetNthGroupSortField (
Parameters

printJob	Specifies the handle to the print job for which you want to set a group sort field.
sortFieldN	Specifies the number of the sort field you want to set. The first sort field is field 0. If the report has N sort fields, the function can be called with sortFieldN between 0 and N-1. If the report has N sort fields, you can call the function with sortFieldN = N to add a new sort field to
the end of the list of existing sort fields. If N=0, the function will create the first sort field.
name	Specifies a pointer to the null-terminated string that contains the name of the group sort field.
direction	Specifies one of the following sort directions:
Constant			Value	Meaning
PE_SF_DESCENDING	0	Sorts in Descending order (Z to A, 9 to 1).
PE_SF_ASCENDING	1	Sorts in Ascending order (A to Z, 1 to 9).
PE_SF_ORIGINAL		2	Sort in original order (Group condition only)
PE_SF_SPECIFIED	3	Sorts in a specified order (Group condition only).
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  String: LPCSTR
.head 6 -  Number: SHORT
.head 4 +  Function: PESetNDetailCopies
.head 5 -  Description: Prints multiple copies of the Details section of the report. You can use this function to print multiple copies of labels for a customer, multiple copies of a purchase order, or multiple copies of any thing set up in the Details section of your report.

BOOL CRPE_API PESetNDetailCopies (

Parameters

printJob	Specifies the handle of the print job for which you want set the number of copies to print.
nDetailCopies	Specifies the number of report copies you want to print.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PESetMargins
.head 5 -  Description: Sets the page margins for the specified report to the values you supply as parameters. Use this function any time you want to set the printer margins at runtime in response to user specifications.

BOOL CRPE_API PESetMargins (

Parameters

printJob	Specifies the handle of the print job for which you want to set new margins.
left	Specifies the left margin.*
right	Specifies the right margin.*
top	Specifies the top margin.*
bottom	Specifies the bottom margin.*
Value	Meaning
PM_SM_DEFAULT	You can use PM_SM_DEFAULT for any of the margin parameters. For each margin you specify in this way, the program will use the appropriate default margin for the currently selected printer.
*Left, right, top, and bottom values are all in twips. A twip is 1/1440 of an inch; there are 20 twips in a point. To set .5" margins, for example, you would enter the value 720.

Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PESetGroupCondition
.head 5 -  Description: Changes the group condition for a group section. Use this function whenever you want to change the grouping at print time, for example, to print one report grouped in several different ways.

BOOL CRPE_API PESetGroupCondition (

Parameters

printJob	Specifies the handle of the print job for which you want to change the group condition for a group section.
sectionCode	Specifies the code for the report section for which you want to set the group condition. See Working with section codes.
conditionField	Specifies the pointer to the name of the field that triggers a summary whenever its value changes. This parameter is a result of calling PEGetHandleString with conditionFieldHandle and conditionFieldLength, returned by PESetGroupCondition.
condition	Specifies the condition ("weekly", "monthly", "change to Yes", "change to No", etc.) that needs to be met for Date and Boolean fields.
For all field types except Date and Boolean, use PE_GC_ANYCHANGE as the condition parameter.

Constant (Date Fields Only)	Value	Meaning
PE_GC_DAILY	0	Triggers a grouping every time the date changes.
PE_GC_WEEKLY	1	Triggers a grouping every time the date changes from one week to the next. (A week runs from Sunday through Saturday.)
PE_GC_BIWEEKLY	2	Triggers a grouping every time the date changes from one two-week period to the next. (Weeks run from Sunday through Saturday.)
PE_GC_SEMIMONTHLY	3	Triggers a grouping every time the date changes from one half-month period to the next.
PE_GC_MONTHLY	4	Triggers a grouping every time the date changes from one month to the next.
PE_GC_QUARTERLY	5	Triggers a grouping every time the date changes from one calendar quarter to the next.
PE_GC_SEMIANNUALLY	6	Triggers a grouping every time the date changes from one half-year period to the next.
PE_GC_ANNUALLY	7	Triggers a grouping every time the date changes from one year to the next.
Constant (Boolean Fields Only)	Value	Meaning
PE_GC_TOYES	1	Triggers a grouping every time the sort and group by field value changes from No to Yes.
PE_GC_TONO	2	Triggers a grouping every time the sort and group by field value changes from Yes to No.
PE_GC_EVERYYES	3	Triggers a grouping every time the sort and group by field value is Yes.
PE_GC_EVERYNO	4	Triggers a grouping every time the sort and group by field value is No.
PE_GC_NEXTISYES	5	Triggers a grouping every time the next value in the sort and group by field is Yes.
PE_GC_NEXTISNO	6	Triggers a grouping every time the next value in the sort and group by field is No.
sortDirection	Specifies one of the following sort directions:
Constant	Value	Meaning
PE_SF_DESCENDING	0	Sorts data in descending order (Z to A, 9 to 1).
PE_SF_ASCENDING	1	Sorts data in ascending order (A to Z, 1 to 9).
PE_SF_ORIGINAL	2	Sorts data in its original order (Group condition only).
PE_SF_SPECIFIED	3	Sorts data in a specified order (Group condition only).
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  String: LPCSTR
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PESetGraphType
.head 5 -  Description: Changes the type of chart displayed for the specified chart in the specified section based on one of the available chart types. Use this function to change the type of chart that is displayed in the report. There are many types of charts possible with Seagate Crystal Reports. This
function allows you to change which type of chart is being displayed.

BOOL CRPE_API PESetGraphType (

Parameters

printJob	Specifies the handle of the print job for the report containing the chart for which you want to change the type.
sectionCode	Specifies the code for the report section in which the chart appears. See Working with section codes.
graphN	Specifies which chart within the section for which you want to change the type. This value is 0 indexed. Within a section, charts are numbered from top to bottom, first, then from left to right if they have the same top.
graphType	Specifies a pointer to the type of chart you want to be displayed. Use one of the following values:
Constant				Value	Meaning
PE_SIDE_BY_SIDE_BAR_GRAPH	0	Side By Side bar chart
PE_STACKED_BAR_GRAPH			2	Stacked bar chart
PE_PERCENT_BAR_GRAPH			3	Percent bar chart
PE_FAKED_3D_SIDE_BY_SIDE_BAR_GRAPH	4	3D Side By Side bar chart
PE_FAKED_3D_STACKED_BAR_GRAPH		5	3D Stacked bar chart
PE_FAKED_3D_PERCENT_BAR_GRAPH		6	3D Percent bar chart
PE_PIE_GRAPH					40	Pie chart
PE_MULTIPLE_PIE_GRAPH			42	Multiple Pie chart
PE_PROPORTIONAL_MULTI_PIE_GRAPH		43	Weighted Pie chart
PE_LINE_GRAPH					80	Line chart
PE_AREA_GRAPH				120	Area chart
PE_THREED_BAR_GRAPH			160	3D bar chart
PE_USER_DEFINED_GRAPH			500	User Defined chart type
PE_UNKNOWN_TYPE_GRAPH	1000	Unknown chart type
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetWindowHandle
.head 5 -  Description: Returns the handle of the preview window. This function can be used in a Custom-Print link if you want to do something with the preview window (move it, change its size, etc.).
PEGetWindowHandle can also be used to determine if the user has already closed the preview window.

HWND CRPE_API PEGetWindowHandle (

Parameters

printJob	Specifies the handle of the print job from which you want to retrieve the preview window handle. If two or more preview windows are open, this function applies only to the most recently created preview window.
Return Value

This function returns the preview window handle if it is successful, 0 if an error occurs or if the preview window has already been closed.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Window Handle: HWND
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetVersion
.head 5 -  Description: Returns the version number of the DLL or the Crystal Report Engine. The high-order byte is the major version number and the low-order byte is the minor version number. This function can be used whenever you build functionality into a report that may not be available in earlier
versions of the Crystal Report Engine and you need to verify the version number first. The function can be a handy safeguard for users who have more than one version of the Crystal Report Engine with the older version earlier in the path than the new version.

 Short CRPE_API PEGetVersion (

Parameters

versionRequested	Specifies whether the DLL or Crystal Report Engine version is being requested. Use one of the following values:
Constant	Value	Meaning
PE_GV_DLL	100	Returns the version of the DLL (CRPE/CRPE32).
PE_GV_ENGINE	200	Returns the version of the Crystal Report Engine.
Return Value The version number of the DLL or the Crystal Report Engine.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetSubreportInfo
.head 5 -  Description: Retrieves information about the specified subreport.

BOOL CRPE_API PEGetSubreportInfo (

Parameters

printJob	Specifies the handle of the primary report that contains the subreport about which you want to retrieve information.
subreportHandle	Specifies the handle of the subreport about which you want to retrieve information.
subreportInfo	Specifies a pointer to PESubreportInfo that will be used for holding the information once it is retrieved.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: DWORD
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  String: char[128]
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 4 +  Function: PEGetSelectedPrinter
.head 5 -  Description: BOOL CRPE_API PEGetSelectedPrinter (
FAR *FAR *mode);

Parameters

printJob	Specifies the handle to the print job that you want to query to get information on the non-default printer that has been selected with the report.
driverHandle	Specifies a pointer to the handle of the printer driver for the printer that is selected with the print job.
driverLength	Specifies a pointer to the length of the printer driver name.
printerHandle	Specifies a pointer to the handle of the printer that is selected with the print job.
printerLength	Specifies a pointer to the length of the printer name.
portHandle	Specifies a pointer to the handle of the port to which the selected printer is connected.
portLength	Specifies a pointer to the length of the port name.
mode	Specifies a pointer to the Windows API structure DEVMODE. (Use DEVMODEA for 32-bit.) If UNICODE is defined in your application, this will be a DEVMODEA structure.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 6 +  structPointer
.head 7 -  Receive String: byte[32]
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive String: byte[32]
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 4 +  Function: PEGetSectionFormatFormula
.head 5 -  Description: BOOL CRPE_API PEGetSectionFormatFormula (

Parameters

printJob	Specifies the handle of the print job you want to query to find what section options have been set for the report using Format Section dialog box. For more information, search for Format Section dialog box in Seagate Crystal Reports online Help.
sectionCode	Specifies the code for the report section(s) for which you want to get section format information. See the table of section constants supplied in Working with section codes.
formulaName	Specifies the name of the section format formula.
Constant	Value	Meaning
PE_FFN_SECTION_VISIBILITY	58	Specifies that the section be visible. If not visible, no drill-down will be available.
PE_FFN_SHOW_AREA	59	Specifies that the area be visible. If not visible, drill down will be available.
PE_FFN_NEW_PAGE_BEFORE	60	Specifies that a new page will be printed before the section.
PE_FFN_NEW_PAGE_AFTER	61	Specifies that a new page will be printed after the section.
PE_FFN_KEEP_TOGETHER	62	Specifies that the section will be kept together.
PE_FFN_SUPPRESS_BLANK_SECTION	63	Specifies that if the section is blank, it will not be printed.
PE_FFN_RESET_PAGE_N_AFT7ER	64	Specifies that page numbering will reset after the section.
PE_FFN_PRINT_AT_BOTTOM_
PE_FFN_UNDERLAY_SECTION	66	Specifies that the section will overlay any sections following.
PE_FN_SECTION_BACK_COLOUR	67	Specifies the background color of the section.
textHandle	A handle to the memory location of the text of the actual formula.
textLength	The length of the text string specified by the textHandle parameter. Use this value to allocate a buffer for the text.
Return Value

n	TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetSectionFormat
.head 5 -  Description: Retrieves the section format settings for selected sections in the specified report and supplies them as member values for PESectionOptions. Use this function in order to update the section formats and pass them back using PESetSectionFormat.

BOOL CRPE_API PEGetSectionFormat (

Parameters

printJob	Specifies the handle of the print job you want to query to find what section options have been set for the report using the Format Section dialog box.
sectionCode	Specifies the code for the report section(s) for which you want to get section format information. See Working with section codes.
options	Specifies the pointer to PESectionOptions.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: LONG
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 4 +  Function: PEGetSectionCode
.head 5 -  Description: Retrieves the section code for the specified section. A section code indicates the section type (Page Header, Details, and so forth). If there are multiple group sections it also identifies the group number, and if there are multiple sections in an area it identifies the section number.

short CRPE_API PEGetSectionCode (

Parameters

printJob	Specifies the handle of the print job from which you want to identify a section code.
sectionN	Specifies the number of the section for which you want the section code.
Return value

Returns the section code for the specified section. See Working with section codes.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetReportTitle
.head 5 -  Description: Returns the handle of the report title string in the report summary information. If the job is a subreport, it returns the handle of the subreport name. This function is typically used as one of a series of functions (PEGetReportTitle, PEGetHandleString, or PESetReportTitle). The series
can be used in Custom-Print links to identify and change an existing report title at print time in response to a user selection.

BOOL CRPE_API PEGetReportTitle (

Parameters

printJob	Specifies the handle of the print job for which you want to get the report title.
titleHandle	Specifies a pointer to the handle of the title string.
titleLength	Specifies a pointer to the length of the title string (in bytes) including the terminating byte.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetPrintOptions
.head 5 -  Description: Retrieves the print options specified for the report (the options that are set in the Print common dialog box) and uses them to fill in PEPrintOptions. Use this function to fetch print options from the report in order to update them and pass back using PESetPrintOptions.

BOOL CRPE_API PEGetPrintOptions (

Parameters

printJob	Specifies the handle of the print job you want to query to find out which print options have been set using the Print common dialog box.
options	Specifies the pointer to PEPrintOptions.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: USHORT
.head 7 -  Receive Number: USHORT
.head 7 -  Receive Number: USHORT
.head 7 -  Receive Number: USHORT
.head 7 -  Receive String: char[255]
.head 7 -  Receive String: char[255]
.head 7 -  Receive String: char[2]
.head 4 +  Function: PEGetPrintDate
.head 5 -  Description: Determines the print date (if any) that was specified with the report. Use this function to fetch the print date and pass back using PESetPrintDate.

BOOL CRPE_API PEGetPrintDate (

Parameters

printJob	Specifies the handle of the print job you want to query to determine its print date setting.
year	Specifies a pointer to the year component of the print date.
month	Specifies a pointer to the month component of the print date.
day	Specifies a pointer to the day component of the print date.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetNthTableSessionInfo
.head 5 -  Description: Gets the session information for a Microsoft Access table being used in your report. Many MS Access database tables require that a session be opened before the information in the table can be used. Use PEGetNthTableSessionInfo to obtain the session information (User ID,
Password, and Session Handle) for a particular table.

BOOL CRPE_API PEGetNthTableSessionInfo (

Parameters

printJob	Identifies the handle of the print job that uses the table for which you need to obtain the session information.
tableN	0 indexed table number indicating which table in the report you wish to obtain the session information for.
sessionInfo	Refer to PESessionInfo,for further information.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive Number: DWORD
.head 4 +  Function: PEGetNthSubreportInSection
.head 5 -  Description: Retrieves a handle that is required to retrieve the name of the subreport.

DWORD CRPE_API PEGetNthSubreportInSection (

Parameters

printJob	Specifies the handle of the primary report.
sectionCode	Specifies the code for the report section that contains the subreport. See Working with section codes.
subreportN	Specifies the number of the subreport in the specified section. subreportN is zero based. The first report in the section will be 0, the second will be 1, etc. If there are no subreports in the section, the function will return 0.
Remarks

Use PEGetSubreportInfo to retrieve information about the subreport by passing the subreport handle returned by PEGetNthSubreportInSection.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetNthParamInfo
.head 5 -  Description: Retrieves the name and type of a specified stored procedure parameter.

BOOL CRPE_API PEGetNthParamInfo (

Parameters

printJob	Specifies the handle to the print job from which you want to gather information about a stored procedure parameter.
paramN	Specifies the number of the stored procedure parameter about which you want to gather information.
paramInfo	Specifies a pointer to PEParameterInfo that will hold the retrieved information.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive String: char[255]
.head 7 -  Receive String: char[1]
.head 7 -  Receive String: char[255]
.head 7 -  Receive String: char[1]
.head 7 -  Receive String: char[255]
.head 7 -  Receive String: char[1]
.head 7 -  Receive String: char[255]
.head 7 -  Receive String: char[1]
.head 7 -  Receive String: char[128]
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DOUBLE
.head 7 -  Receive Number: DOUBLE
.head 7 -  Receive String: char[255]
.head 7 -  Receive String: char[1]
.head 7 -  Receive Number: WORD
.head 4 +  Function: PEGetNthParam
.head 5 -  Description: Gets the Nth parameter of a stored procedure. Use this function whenever you need to find out a particular parameter required by a stored procedure in a SQL database table.

BOOL CRPE_API PEGetNthParam (

Parameters

printJob	Specifies the handle of the print job that contains the stored procedure for which you are interested in obtaining a parameter.
paramN	0 indexed parameter number, indicates which parameter in the stored procedure you wish to know.
textHandle	Specifies the pointer to the handle of the string containing the sort procedure parameter.
textLength	Specifies the pointer to the length of the parameter string (in bytes) including the terminating null byte.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetNthGroupSortField
.head 5 -  Description: Returns information about one of the group sort fields in the specified report: that is, it returns the name of the field and the direction (ascending or descending) of the sort. The name of the group sort field is returned as a string handle. See Crystal Report Engine API Variable
Length Strings, for further information.

This function is typically used as one of a series of functions: PEGetNGroupSortFields (called once), PEGetHandleString (called as many times as needed to identify the correct group sort field), and PESetNthGroupSortField (called once when the correct sort field is identified).
The series can be used in a Custom-Print link to identify and then change an existing group sort field and/or sort order at print time in response to a user selection.

A group sort field is a summary value or a summarized field that determines the sort order of groups.
BOOL CRPE_API PEGetNthGroupSortField (

Parameters

printJob	Specifies the handle of the print job from which you want to gather group sort field information.
sortFieldN	Specifies the number of the group sort field you want to retrieve. The first group sort field is field 0. If the report has N sort fields, the function can be called with sortFieldN between 0 and N-1.
nameHandle	Specifies the pointer to the handle of the string containing the sort field name.
nameLength	Specifies the pointer to the length of the field name string (in bytes) including the terminating byte.
direction	Specifies a pointer to the sort direction. See PESetNthGroupSortFieldfor a list of sort direction constants.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetNthFormula
.head 5 -  Description: Retrieves information about a specific formula in the report. Use this function to obtain the formula name and formula text of a specific formula in the report. This function can be used to get formula text, allow the user to edit the formula, then change the formula text with
PESetFormula. The first formula is formula 0.

BOOL CRPE_API PEGetNthFormula (

Parameters

printJob	Specifies the handle to the print job from which you want to gather formula information.
formulaN	Specifies the number of the formula about which you want to gather information.
nameHandle	Specifies a pointer to the handle of the string containing the formula name.
nameLength	Specifies a pointer to the length of the formula name string (in bytes) including the terminating byte.
textHandle	Specifies a pointer to the handle of the string containing the formula text.
textLength	Specifies a pointer to the length of the formula string (in bytes) including the terminating byte.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetNSubreportsInSection
.head 5 -  Description: Determines the number of subreports in the specified section.

short CRPE_API PEGetNSubreportsInSection (

Parameters

print job	Specifies the handle of the primary report from which you want to fetch information about the number of subreports in a section.
sectionCode	Specifies the section code of the section for which you want a subreport count. See Working with section codes.
Return Value

The number of subreports in the specified section. Returns -1 if an error occurs.

Remarks

sectionCode can be retrieved using PEGetSectionCode.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetNSections
.head 5 -  Description: Retrieves the number of sections in the specified report. By default, each report has five areas, each containing one section (Report Header, Page Header, Details, Report Footer, and Page Footer). Thus, if this function were applied to a default report, the return value would be
five (5). As you add groups to your report or sections to one or more areas, the number of sections in the report increases.

short CRPE_API PEGetNSections (

Parameters

printJob	Specifies the handle to the print job from which you want to get a section count.
Return Value

The number of sections in the report. Returns -1 if an error occurs.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetNPages
.head 5 -  Description: Retrieves the number of pages in the report.

short CRPE_API PEGetNPages (

Parameters

printJob	Specifies the handle of the print job for which you want to determine the number of pages.
Return Value

The number of pages in the report.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetNGroupSortFields
.head 5 -  Description: Returns the number of group sort fields in the specified report. This function is typically used as one of a series of functions: PEGetNGroupSortFields (called once), PEGetNthGroupSortField, PEGetHandleString (called as many times as needed to identify the correct group sort
field), and PESetNthGroupSortField(called once, when the correct group sort field is identified). The series can be used in a custom-print link to identify and then change an existing group sort field and/or sort order at print time in response to a user selection.

A group sort field is a summary value or a summarized field that determines the sort order of groups.
short CRPE_API PEGetNGroupSortFields (

Parameters

printJob	Specifies the handle of the print job you want to query to find out how many group sort fields it contains.
Return Value

If group sort fields have been defined, returns the number of such fields; if there are no group sort fields defined, returns 0; if an error occurs, returns -1.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetNGroups
.head 5 -  Description: Determines the number of groups in the specified report.

short CRPE_API PEGetNGroups (

Parameters

printJob	Specifies the handle of the print job you want to query to determine the number of groups it contains.
Return Value

Returns the number of groups in the report. Returns -1 if an error occurs.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetNFormulas
.head 5 -  Description: Determines the number of formulas in the specified report. Use this function to fetch the number of formulas in the report. To fetch the formula by number, use PEGetNthFormula.

short CRPE_API PEGetNFormulas (

Parameters

printJob	Specifies the handle to the print job you want to query to find the number of formulas it contains.
Return Value

The number of formulas in the report. Returns -1 if an error occurs.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEGetNDetailCopies
.head 5 -  Description: Returns the number of copies of each Details section in the report that are to be printed. Use this function to find out how many times each Details section of the report will be printed. To change the number of times each Details section is printed, use PESetNDetailCopies.

BOOL CRPE_API PEGetNDetailCopies (

Parameters

printJob	Specifies the handle of the print job from which you want to know how many times each Details section is to be printed.
nDetailCopies	Holds the number of copies of the Details section to be printed.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetMinimumSectionHeight
.head 5 -  Description: Retrieves the minimum section height information for selected sections in the specified report. The minimum section height is the height that can contain all its objects.

BOOL CRPE_API PEGetMinimumSectionHeight (

Parameters

printJob	Specifies the handle to the print job you want to query to retrieve information on minimum section height.
sectionCode	Specifies the code for the report section(s) for which you want to retrieve information on minimum section height. See Working with section codes.
minimumHeight	Specifies a pointer to the minimum height (in twips) you want to set for the selected section(s).
Return Value
TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetMargins
.head 5 -  Description: Retrieves the page margin settings for the specified report. Use this function to find out what the currently set margins for the report are. Use this function with PESetMargins. Use PEGetMargins to obtain report margins and use PESetMargins, to set the report margins.

BOOL CRPE_API PEGetMargins (

Parameters

printJob	Specifies the handle to the print job you want to query to retrieve margin information.
left	Specifies a pointer to the value of the left margin.
right	Specifies a pointer to the value of the right margin.
top	Specifies a pointer to the value of the top margin.
bottom	Specifies a pointer to the value of the bottom margin.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetJobStatus
.head 5 -  Description: Evaluates the status of a print job. You can use this function in a number of programming situations, for example:

	to trigger error messages, i.e., when a print job fails (due to insufficient memory, insufficient disk space, etc.),

	to trigger screen displays (hourglass, series of graphics, etc.) that confirm to the user that work is in progress, or

	to find out whether a job was cancelled by the user after PEStartPrintJob, returns.

short CRPE_API PEGetJobStatus (

Parameters

printJob	Specifies the handle to the print job you want to query about its printing status.
jobInfo	Specifies the pointer to PEJobInfo that will capture the information this function retrieves.
Return Value

	"0" if PEOpenEngine , or PEOpenPrintJob, has not been called successfully.

	"1" if the job has not started yet (PE_JOBNOTSTARTED).

	"2" if the job is in progress (PE_JOBINPROGRESS).

	"3" if the job has completed successfully (PE_JOBCOMPLETED).

	"4" if the job has failed (PE_JOBFAILED).

	"5" if the job has been canceled by the user (PE_JOBCANCELLED).

	"6" if the report has been halted (PE_JOBHALTED).
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: SHORT
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Boolean: BOOL
.head 4 +  Function: PEGetGroupCondition
.head 5 -  Description: Determines the group condition information for a selected group section in the specified report. Use this function to find out the group condition for a group section. Use PESetGroupCondition, to change the group condition once it is known.

BOOL CRPE_API PEGetGroupCondition (

Parameters

printJob	Specifies the handle of the print job you want to query to determine the group conditions for a selected group.
sectionCode	Specifies the code for the report section for which you want to get the group condition. See the table of section constants supplied with PESetSectionFormat.
conditionFieldHandle	Specifies a pointer to the handle of the condition field for the selected group section.
conditionFieldLength	Specifies a pointer to the length of the condition field for the selected group section.
condition	Specifies a pointer to the condition setting for the selected group section (date and Boolean fields only). See PESetGroupCondition for information on the condition constants.
sortDirection	Specifies a pointer to the sort direction setting for the selected group section.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPSHORT
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetGraphType
.head 5 -  Description: Identifies one of the available graph/chart types used for the specified graph in the specified section. Use this function to find out what type of graph is being displayed in the report. There are many types of graphs and charts possible with Seagate Crystal Reports. This function
will return the type of graph or chart being displayed in a report.

BOOL CRPE_API PEGetGraphType (

Parameters

printJob	Specifies the handle of the print job from which you want to find out the type of graph being displayed.
sectionCode	Specifies the code for the report section in which the graph appears. See the table of section constants supplied with PESetSectionFormat.
graphN	Specifies which graph within the section you want to know the type of. This value is 0 indexed. Within a section, graphs are numbered from top to bottom, first, then from left to right if they have the same top.
graphType	Returns a pointer to the type of graph being displayed. See PESetGraphType for the list of possible graph types.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetGraphText
.head 5 -  Description: Retrieves the identifying text that appears on the specified graph in the specified section. This function allows you to find out what text appears with a graph. A graph can have a title, subtitle, footnote, title for groups, title for series, title for the X axis, title for the Y axis, and title for the
Z axis (in 3D graphs).

BOOL CRPE_API PEGetGraphText (

Parameters

printJob	Specifies the handle of the print job from which you want to get the text displayed with a graph.
sectionCode	Specifies the code for the report section in which the graph appears. See the table of section constants supplied with PESetSectionFormat.
graphN	Specifies which graph within the section you want the text for. This value is 0 indexed. Within a section, graphs are numbered from top to bottom, first, then from left to right if they have the same top.
graphTextInfo	Specifies the pointer to PEGraphTextInfo.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 7 -  Receive String: char[128]
.head 4 +  Function: PEGetGraphOptions
.head 5 -  Description: Identifies the display options that are set for the specified graph in the specified section. Use this function to obtain information about any of several graph options. These options include the minimum and maximum values that can appear on the graph, whether grid lines appear,
whether risers are labeled, whether bar graphs have horizontal or vertical bars, and whether a legend appears on the graph.

BOOL CRPE_API PEGetGraphOptions (

Parameters

printJob	Specifies the handle of the print job from which you want to get information about a graph.
sectionCode	Specifies the code for the report section in which the graph appears. See the table of section constants supplied with PESetSectionFormat.
graphN	Specifies which graph within the section you want information about. This value is 0 indexed. Within a section, graphs are numbered from top to bottom, first, then from left to right if they have the same top.
graphOptions	Specifies the pointer to PEGraphOptions.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DOUBLE
.head 7 -  Receive Number: DOUBLE
.head 7 -  Receive Boolean: BOOL
.head 7 -  Receive Boolean: BOOL
.head 7 -  Receive Boolean: BOOL
.head 7 -  Receive Boolean: BOOL
.head 7 -  Receive String: char[128]
.head 4 +  Function: PEGetGraphData
.head 5 -  Description: Identifies the data on which the specified graph in the specified section is based. Use this function to find out what data in your report is being used by a specified graph when the graph is created. This information includes which groups are used to create the rows and columns of
the graph and which summary field in the report is used to set the values of the risers in the graph.

BOOL CRPE_API PEGetGraphData (

Parameters

printJob	Specifies the handle of the print job from which you want to get information about a graph.
sectionCode	Specifies the code for the report section in which the graph appears. See the table of section constants supplied with PESetSectionFormat.
graphN	Specifies which graph within the section you want data for. This value is 0 indexed. Within a section, graphs are numbered from top to bottom, first, then from left to right if they have the same top.
graphDataInfo	Specifies the pointer to PEGraphDataInfo.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 4 +  Function: PEGetExportOptions
.head 5 -  Description: Gets export options from the user before exporting the report. PEGetExportOptions can be used to present a series of dialog boxes that retrieve export options from your users. These options are used by the Crystal Report Engine to fill in the PEExportOptions structure. The
PEExportTo function can then be used to set the print job destination using the information in PEExportOptions.

BOOL CRPE_API PEGetExportOptions (

Parameters

printJob	Specifies the print job from which you want to get export options.
options	Specifies the pointer to PEExportOptions .
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive String: char[64]
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: LPVOID
.head 7 -  Receive String: char[64]
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: LPVOID
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 4 +  Function: PEGetAreaFormatFormula
.head 5 -  Description: Retrieves the text of a conditional area format formula as a string handle. Use this function in order to update the conditional area format formula and pass the changes back using PESetAreaFormatFormula.

BOOL CRPE_API PEGetAreaFormatFormula (

&&&stevefParameters

printJob	Specifies the handle of the print job from which you want to get the area format formula.
AreaCode	Specifies the code for the area for which you want to get format information. See Working with section codes for more information.
FormulaName	Specifies the name of the formatting formula for which you want to supply a new string. Use one of the following constants:
Constant	Value	Meaning
PE_FFN_AREASECTION_VISIBILITY	58	Area or section invisible.
PE_FFN_SHOW_AREA	59	Area is shown or hidden. When hidden, drill down is OK.
PE_FFN_NEW_PAGE_BEFORE	60	Start a new page before this area.
PE_FFN_NEW_PAGE_AFTER	61	Start a new page after this area.
PE_FFN_KEEP_TOGETHER	62	Keep area together.
PE_FFN_RESET_PAGE_N_AFTER	64	Reset page number after the area.
PE_FFN_PRINT_AT_BOTTOM_OF_
textHandle	Specifies the pointer to the handle of the string containing the error text.
textLength	Specifies the pointer to the length of the error string (in bytes) including the terminating byte.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 -  Receive Number: LPHANDLE
.head 6 -  Receive Number: LPSHORT
.head 4 +  Function: PEGetAreaFormat
.head 5 -  Description: Retrieves the area format settings for selected areas in the specified report and supplies them as member values for PESectionOptions. Use this function to update the area formats and pass them back using PESetAreaFormat.

BOOL CRPE_API PEGetAreaFormat (

Parameters

printJob	Specifies the handle of the print job from which you want to get the area format.
areaCode	Specifies the code for the area for which you want to get format information. See Working with section codes for more information.
options	Specifies a pointer to PESectionOptions that will receive format information for the area.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: LONG
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 4 +  Function: PEExportTo
.head 5 -  Description: Exports a print job using the name, format, and destination specified in the PEExportOptions structure. Use PEExportTo any time you want to print a report to a file or export it for use in other programs.

BOOL CRPE_API PEExportTo (

Parameters

printJob	Specifies the handle of the print job that you want to export.
Options	Specifies the pointer to PEExportOptions.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  String: char[64]
.head 7 -  Number: DWORD
.head 7 -  Number: LPVOID
.head 7 -  String: char[64]
.head 7 -  Number: DWORD
.head 7 -  Number: LPVOID
.head 7 -  Number: WORD
.head 7 -  Number: WORD
.head 4 +  Function: PEExportPrintWindow
.head 5 -  Description: Exports the report displayed in the preview window to disk file or e-mail. This function can be used in a Custom-Print link to enable the user to preview the report in the preview window, and then, if everything looks satisfactory, to export the report to disk file or e-mail (in response to
a user event).
Use PEExportPrintWindow to replace the Export button when PEShowPrintControls disables the Print Control buttons.

BOOL CRPE_API PEExportPrintWindow (

Parameters

printJob	Specifies the handle to the print job you want to print to a window.
toMail	Indicates whether or not the function is to export to e-mail.
WaitUntilDone	Indicates whether or not the function is to return as soon as printing starts. Use one of the following values:
TRUE	The function returns when printing is finished. In version 1.1 and higher of CRPE, "waitUntilDone" must be true.
FALSE	The function returns as soon as printing starts.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Boolean: BOOL
.head 6 -  Boolean: BOOL
.head 4 +  Function: PEEnableProgressDialog
.head 5 -  Description: Enables/disables the display of the Progress dialog box. The Progress dialog box displays the progress of the report when it is running (records read, records selected, and so forth).

BOOL CRPE_API PEEnableProgressDialog (

Parameters

printJob	Specifies the handle to the print job for which you want to enable/disable the Progress dialog box.
enable	Specifies whether or not the progress dialog box is enabled. If enable is set to TRUE (1), the progress dialog box is enabled. If it's set to FALSE (0), the dialog box is disabled.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Boolean: BOOL
.head 4 +  Function: PEDiscardSavedData
.head 5 -  Description: Discards data that was previously saved with the report. If a report has been saved with data, you can use this function to discard the saved data, forcing the Crystal Report Engine to retrieve new data when the report is printed.

BOOL CRPE_API PEDiscardSavedData (

Parameters

printJob	Specifies the handle to the print job for which you want to discard saved data.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEDeleteNthGroupSortField
.head 5 -  Description: Removes the specified group sort field from the sort order. This function is used as part of a Custom-Print link whenever you want to delete group sort fields that were established for the report at design time. When you give the user the ability to delete group sort field(s) at print
time, your link must include code to replace sortFieldN with user-generated values.
This function can be used by itself to delete an existing group sort field when the sort field number is already known.
This function can also be used as one of a series of functions: PEGetNSortFields called once), PEGetNthGroupSortField, PEGetHandleString (called together as many times as needed to identify the correct sort field), and PEDeleteNthGroupSortField (called once, when the
correct sort field is identified). The series can be used in a Custom-Print link to identify and then delete an existing group sort field and/or sort order at print time in response to a user selection.

BOOL CRPE_API PEDeleteNthGroupSortField (

Parameters

printJob	Specifies the handle of the print job from which you want to delete a group sort field.
sortFieldN	Specifies the number of the sort field you want to delete. The first group sort field is field 0. If N = 0, the function will delete the first group sort field. If the report has N group sort fields, the function can be called with sortFieldN between 0 and N-1.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  Number: SHORT
.head 4 +  Function: PEConvertVInfoToPFInfo
.head 5 -  Description: Converts a numeric, currency, date, Boolean, or string value contained in PEValueInfo, into the binary representation expected by PESetNthParameterField .

BOOL CRPE_API PEConvertVInfoToPFInfo(

Parameters

valueInfo	Specifies a pointer to PEValueInfo that contains the value to be converted.
valueType	Specifies a pointer used to store the type of the value being converted which should be assigned to the ValueType member of PEParameterFieldInfo.
value	Specifies a pointer used to store the value in converted form for use in PESetNthParameterField.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 +  structPointer
.head 7 -  Number: WORD
.head 7 -  Number: DOUBLE
.head 7 -  Number: DOUBLE
.head 7 -  Boolean: BOOL
.head 7 -  String: char[255]
.head 7 -  String: char[1]
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: SHORT
.head 7 -  Number: LONG
.head 7 -  Number: SHORT
.head 7 -  String: char[1]
.head 7 -  String: char[1]
.head 7 -  Number: LONG
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive String: LPVOID
.head 4 +  Function: PEConvertPFInfoToVInfo
.head 5 -  Description: Converts the value returned in the CurrentValue or DefaultValue member of the PEParameterFieldInfo, structure to the appropriate type and places the result in a PEValueInfo.

BOOL CRPE_API PEConvertPFInfoToVInfo(

Parameters

value	Specifies a pointer to the current or default parameter value (returned from PEGetNthParameterField) to convert.
valueType	Specifies the type of parameter field that the value came from.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  String: LPVOID
.head 6 -  Number: SHORT
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DOUBLE
.head 7 -  Receive Number: DOUBLE
.head 7 -  Receive Boolean: BOOL
.head 7 -  Receive String: char[255]
.head 7 -  Receive String: char[1]
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: LONG
.head 7 -  Receive Number: SHORT
.head 7 -  Receive String: char[1]
.head 7 -  Receive String: char[1]
.head 7 -  Receive Number: LONG
.head 4 +  Function: PECloseSubreport
.head 5 -  Description: Closes the specified subreport.

BOOL CRPE_API PECloseSubreport
(short printJob	//handle to subreport);

Parameters

printJob	Specifies the handle to the subreport you want to close.
Return Value

TRUE (1) if the call is successful; FALSE (0) if the call fails.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PECancelPrintJob
.head 5 -  Description: Cancels the printing of a report. This function can be tied to a control that allows the user to cancel a print job in progress.
Use this command as a replacement for the Cancel button when PEShowPrintControls disables the Print Control buttons.

void CRPE_API PECancelPrintJob
(short printJob);

Parameters

printJob	Specifies the handle to the print job.
Return Value

None
.head 5 -  Export Ordinal: 0
.head 5 -  Returns
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 4 +  Function: PEAddParameterCurrentValue
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Number: SHORT
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DOUBLE
.head 7 -  Receive Number: DOUBLE
.head 7 -  Receive Boolean: BOOL
.head 7 -  Receive String: char[254]
.head 7 -  Receive String: char[2]
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: SHORT
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: SHORT
.head 7 -  Receive String: char[1]
.head 7 -  Receive String: char[1]
.head 7 -  Receive Number: LONG
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 4 -  ! ! ! Constantes para el manejo del ClipBoard
.head 4 -  Number: GMEM_MOVEABLE    	= 0x0002
.head 4 -  Number: CF_TEXT    = 1
.head 4 -  ! ! ! Crystal Report
.head 4 -  Number: CW_USEDEFAULT = -32768
.head 4 -  Number: WS_MAXIMIZE = 16777216
.head 4 -  Number: PE_ERR_NOERROR			= 0
.head 3 +  User
.head 4 -  Number: MU_BORRAR        = SAM_User+100001
.head 4 -  Number: MU_GRABAR        = SAM_User+100002
.head 4 -  Number: MU_ACTUALIZAR  = SAM_User+100003
.head 4 -  Number: MU_REVISAR  = SAM_User+100004
.head 4 -  Number: MU_SELECCIONAR  = SAM_User+100005
.head 4 -  Number: DBP_SYBAUTOCOMMIT	= 5108
.head 4 -  ! ! Crystal Reports
.head 4 -  Number: PE_SF_DESCENDING = 0
.head 4 -  Number: PE_SF_ASCENDING = 1
.head 4 -  Number: PE_PF_NAME_LEN = 255
.head 4 -  Number: PE_PF_PROMPT_LEN  = 255
.head 4 -  Number: PE_PF_VALUE_LEN = 255
.head 4 -  Number: PE_WORD_LEN = 2
.head 4 -  ! !
.head 4 -  Number: PE_PF_NUMBER = 0
.head 4 -  Number: PE_PF_CURRENCY = 1
.head 4 -  Number: PE_PF_BOOLEAN = 2
.head 4 -  Number: PE_PF_DATE = 3
.head 4 -  Number: PE_PF_STRING = 4
.head 4 -  Number: PAM_PE_Offset = 1000
.head 4 -  Number: PAM_PEBeforePrint = SAM_User + PAM_PE_Offset
.head 2 -  Resources
.head 2 +  Variables
.head 3 -  ! ! Variables para obtener configuracion
.head 3 -  String: strRepPath
.head 3 -  String: strIniPath
.head 3 -  String: strCiudad
.head 3 -  String: strODBCLab
.head 3 -  String: sGlobalDB
.head 3 -  ! !
.head 3 -  ! estas son para cualquier busqueda o select en general
.head 3 -  Sql Handle: hSql1
.head 3 -  Sql Handle: hSql2
.head 3 -  Sql Handle: hSql3
.head 3 -  Sql Handle: hSql4
.head 3 -  Sql Handle: hSql5
.head 3 -  ! esta es para los combos,identitys
.head 3 -  Sql Handle: hSql6
.head 3 -  !
.head 3 -  Boolean: bExists
.head 3 -  Boolean: bMeConecte
.head 3 -  Number: nGlobal
.head 3 -  Number: nSiguiente
.head 3 -  ! para imprimir
.head 3 -  String: sImprimir
.head 3 -  String: sEnlace
.head 3 -  String: sCampos
.head 3 -  String: sTitulo
.head 3 -  String: sPath
.head 3 -  !
.head 3 -  Number: nUsuario
.head 3 -  String: sNombreUsuario
.head 3 -  Boolean: bArraySeg[1:*]
.head 3 -  !
.head 3 -  Number: nBaseEs
.head 3 -  ! TEMPORALES GLOBALES
.head 3 -  Number: nFila
.head 3 -  String: sTemp
.head 3 -  Date/Time: dtTemp
.head 3 -  !
.head 3 -  ! ! Crystal Reports
.head 3 -  String: SQLInitialDB
.head 3 -  String: STRING_ARRAY_Null[*]
.head 3 -  : PARAM_ARRAY_Null[*]
.head 4 -  Class: cParam
.head 2 +  Internal Functions
.head 3 -  !
.head 3 -  ! FUNCIONES PARA CHILDTABLEWINDOW
.head 3 +  Function: Validar_Unico_EnTablitas
.head 4 -  Description: Verifica que el valor de una columna en particular (estoy viendo) 
de alguna table window, sea única efectúa la verificación con todos los elementos
de esa columna que este en la table window.---exeptuando en la fila que estoy ahora


Entrada:
	Window Handle de la ChildTable
	Posición de la columna a buscar (texto) en la ChildTable
	Mensaje a emitir en el caso que ya exista

Retorna:	Verdadero si no esta
	Falso si esta
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTablita
.head 5 -  Number: nPosColumna
.head 5 -  String: sMensajes
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFila2
.head 5 -  String: sRecibe
.head 5 -  String: sBuscar
.head 5 -  Number: nFilaEstoy
.head 5 -  Window Handle: hWndColumna
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! obteniendo la fila donde estoy
.head 5 -  Call SalTblQueryFocus(hWndTablita,nFilaEstoy,hWndColumna)
.head 5 -  !
.head 5 -  ! obteniendo el texto donde estoy actualmente, lo anterior se transfiere a ser
lo que debo de buscar en este momento que sea único
.head 5 -  Call SalTblSetContext(hWndTablita,nFilaEstoy)
.head 5 -  Call SalTblGetColumnText( hWndTablita, nPosColumna, sBuscar)
.head 5 -  !
.head 5 -  ! ahora busquemos el handle de la columna donde voy a buscar, utilizando el número de
posición de esa columna (enviada en el parámetro)
.head 5 -  Set hWndColumna=SalGetFirstChild(hWndTablita,TYPE_TableColumn)
.head 5 -  Set nFila2=1
.head 5 +  While nFila2<nPosColumna
.head 6 -  Set hWndColumna=SalGetNextChild(hWndColumna,TYPE_TableColumn)
.head 6 -  Set nFila2=nFila2+1
.head 5 -  !
.head 5 -  Set nFila2=-1
.head 5 +  While SalTblFindNextRow(hWndTablita, nFila2, 0, 0 )
.head 6 -  Call SalTblSetContext( hWndTablita, nFila2)
.head 6 +  If nFila2!=nFilaEstoy
.head 7 -  Call SalTblGetColumnText( hWndTablita, nPosColumna, sRecibe )
.head 7 +  If sBuscar=sRecibe
.head 8 -  Call SalMessageBox(sMensajes,"ERROR",MB_Ok)
.head 8 -  Call SalTblSetContext( hWndTablita, nFilaEstoy)
.head 8 -  Call SalTblSetFocusRow( hWndTablita,nFilaEstoy )
.head 8 -  Call SalTblSetFocusCell(  hWndTablita,nFilaEstoy, hWndColumna,0,1)
.head 8 -  Return FALSE
.head 5 -  !
.head 5 -  ! al terminar me coloco donde estaba en la child table window
.head 5 -  Call SalTblSetContext(hWndTablita,nFilaEstoy)
.head 5 -  Call SalTblSetFocusRow( hWndTablita,nFilaEstoy )
.head 5 -  Call SalTblSetFocusCell(  hWndTablita,nFilaEstoy, hWndColumna,0,1)
.head 5 -  Return TRUE
.head 3 +  Function: RevisarTablas
.head 4 -  Description: Valida los campos de la ventana actual. (hWndForm) Para Child Tables
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTabla
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 5 -  Number: nFilaT
.head 4 +  Actions
.head 5 -  Set nFilaT=-1
.head 5 +  While SalTblFindNextRow(hWndTabla,nFilaT,ROW_New | ROW_Edited,0)
.head 6 -  Call SalTblSetContext(hWndTabla,nFilaT)
.head 6 +  If not SalTblQueryRowFlags( hWndTabla, nFilaT, ROW_MarkDeleted )
.head 7 -  Set hWndHijo=SalGetFirstChild( hWndTabla, TYPE_TableColumn)
.head 7 +  While hWndHijo != hWndNULL
.head 8 +  If NOT SalSendMsg( hWndHijo, MU_REVISAR, 0, 0 )
.head 9 +  If SalIsNull( hWndHijo)
.head 10 -  Call SalTblSetFocusRow( hWndTabla, nFilaT)
.head 10 -  Call SalTblSetFocusCell( hWndTabla, nFilaT, hWndHijo, 0, 1 )
.head 10 -  Call SalMessageBox("Campo no Puede Quedar en Blanco","ERROR",MB_Ok)
.head 10 -  Call SalTblSetFocusCell( hWndTabla, nFilaT,hWndHijo,0,-1)
.head 10 -  Return FALSE
.head 8 -  Set hWndHijo=SalGetNextChild( hWndHijo, TYPE_TableColumn)
.head 5 -  Call SalTblSetContext(hWndTabla,0)
.head 5 -  Return TRUE
.head 3 +  Function: HayFilas
.head 4 -  Description: Verifica si existe al menos 1 fila en una CHILD TABLE
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTabla
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 5 -  Number: nFila
.head 4 +  Actions
.head 5 -  Call SalTblSetContext(hWndTabla,0)
.head 5 -  Set nFila=-1
.head 5 +  While SalTblFindNextRow(hWndTabla,nFila,0,0)
.head 6 -  Call SalTblSetContext(hWndTabla,0)
.head 6 -  Return TRUE
.head 5 -  Call SalTblSetContext(hWndTabla,0)
.head 5 -  Return FALSE
.head 3 +  Function: ContarFilas
.head 4 -  Description: Verifica si existe al menos 1 fila en una CHILD TABLE
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTabla
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 5 -  Number: nFila
.head 4 +  Actions
.head 5 -  Call SalTblSetContext(hWndTabla,0)
.head 5 -  Set nFila=-1
.head 5 +  While SalTblFindNextRow(hWndTabla,nFila,0,0)
.head 6 -  Call SalTblSetContext(hWndTabla,nFila)
.head 5 -  Call SalTblSetContext(hWndTabla,0)
.head 5 -  Return nFila+1
.head 3 -  !
.head 3 -  ! FUNCIONES PARA FORMAS
.head 3 +  Function: Limpiar
.head 4 -  Description: Limpia los campos de toda la ventana
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 4 +  Actions
.head 5 -  Set hWndHijo=SalGetFirstChild( hWndForm,
	TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|TYPE_ChildTable
	|TYPE_CheckBox|TYPE_ListBox)
.head 5 +  While hWndHijo != hWndNULL
.head 6 +  If SalGetType(hWndHijo)=TYPE_ChildTable
.head 7 -  Call SalTblReset(hWndHijo)
.head 6 +  Else
.head 7 -  Call SalClearField( hWndHijo)
.head 6 -  Set hWndHijo=SalGetNextChild( hWndHijo,
	TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|TYPE_ChildTable|TYPE_CheckBox
	|TYPE_ListBox)
.head 3 +  Function: RevisarFormaLlena
.head 4 -  Description: Revisa que todos los campos de una ventana determinada (actual) tenga sus campos
con datos, haciendo los llamados respectivos para el MU_REVISAR en el caso
que no regrese TRUE, quiere decir que debe de verificarse si esta vacío
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 4 +  Actions
.head 5 -  Set hWndHijo=SalGetFirstChild( hWndForm,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|TYPE_ListBox)
.head 5 +  While hWndHijo != hWndNULL
.head 6 +  If not SalSendMsg(hWndHijo,MU_REVISAR,0,0)
.head 7 +  If SalGetType( hWndHijo )=TYPE_ListBox
.head 8 +  If not  HaySeleccionadosListBox( hWndHijo ) 
.head 9 -  Call SalMessageBox("La ventana de selección de múltiples ocurrencias (List Box), no puede quedar en blanco","ERROR",MB_Ok)
.head 9 -  Call SalSetFocus(hWndHijo)
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If SalIsNull(hWndHijo)
.head 9 -  Call SalMessageBox("Campo no puede quedar en blanco","ERROR",MB_Ok)
.head 9 -  Call SalSetFocus(hWndHijo)
.head 9 -  Return FALSE
.head 6 -  Set hWndHijo=SalGetNextChild( hWndHijo,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|TYPE_ListBox)
.head 5 -  Return TRUE
.head 3 +  Function: DeshabilitarTodo
.head 4 -  Description: Deshabilita todos los campos de una ventana
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 4 +  Actions
.head 5 -  Set hWndHijo=SalGetFirstChild( hWndForm,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|
				TYPE_ChildTable|TYPE_PushButton|TYPE_ListBox|TYPE_DataField|TYPE_RadioButton|TYPE_CheckBox)
.head 5 +  While hWndHijo != hWndNULL
.head 6 -  Call SalDisableWindow(hWndHijo)
.head 6 -  Set hWndHijo=SalGetNextChild( hWndHijo,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|
				TYPE_ChildTable|TYPE_PushButton|TYPE_ListBox|TYPE_DataField|TYPE_RadioButton|TYPE_CheckBox)
.head 5 -  Return TRUE
.head 3 +  Function: HabilitarTodo
.head 4 -  Description: Habilita todos los campos de una ventana
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 4 +  Actions
.head 5 -  Set hWndHijo=SalGetFirstChild( hWndForm,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|
				TYPE_ChildTable|TYPE_PushButton|TYPE_ListBox|TYPE_DataField|TYPE_RadioButton|TYPE_CheckBox)
.head 5 +  While hWndHijo != hWndNULL
.head 6 -  Call SalEnableWindow(hWndHijo)
.head 6 -  Set hWndHijo=SalGetNextChild( hWndHijo,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|
				TYPE_ChildTable|TYPE_PushButton|TYPE_ListBox|TYPE_DataField|TYPE_RadioButton|TYPE_CheckBox)
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: Identity_Vieja
.head 4 -  Description: ESTA FUNCION GENERA EL SIGUIENTE NUMERO (UNICO-IDENTITY) DE DETERMINADA
TABLA, RECIBE COMO PARAMETRO el numero que representa LA TABLA, Y DEVUELVE EL IDENTITY
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nTabla
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetch
.head 5 -  Number: nUltimo
.head 5 -  Number: nIdentico
.head 5 -  Boolean: bBueno
.head 4 +  Actions
.head 5 -  Set bBueno=FALSE
.head 5 +  While bBueno=FALSE
.head 6 -  Call SqlPrepareAndExecute(hSql6,'select max(MAXIMO) FROM IDENTITYS
			where COD_TABLA=:nTabla  into :nUltimo')
.head 6 -  Call SqlFetchNext(hSql6,nSiguiente)
.head 6 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 6 -  Set nUltimo=nUltimo+1
.head 6 -  !
.head 6 +  When SqlError
.head 7 -  Return TRUE
.head 6 +  If SqlPrepareAndExecute(hSql6,"insert into IDENTITYS(MAXIMO,COD_TABLA) values(:nUltimo,:nTabla)")
.head 7 -  Set bBueno=TRUE
.head 6 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 6 -  Return nUltimo
.head 3 +  Function: Identity
.head 4 -  Description: ESTA FUNCION GENERA EL SIGUIENTE NUMERO (UNICO-IDENTITY) DE DETERMINADA
TABLA, RECIBE COMO PARAMETRO el numero que representa LA TABLA, Y DEVUELVE EL IDENTITY
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nTabla
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nUltimo
.head 5 -  Number: nIdentico
.head 4 +  Actions
.head 5 -  !
.head 5 -  Set nIdentico=-1
.head 5 +  While (nIdentico=-1)
.head 6 +  When SqlError
.head 7 -  Return FALSE
.head 6 +  If SqlPrepareAndExecute(hSql6,"
select 	max(MAXIMO)
FROM 	IDENTITYS
where 	COD_TABLA=:nTabla
into 	:nUltimo")
.head 7 -  Call SqlFetchNext(hSql6,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql6,'commit')
.head 7 -  Set nUltimo=nUltimo+1
.head 7 -  !
.head 7 +  When SqlError
.head 8 -  Return FALSE
.head 7 +  If SqlPrepareAndExecute(hSql6,"insert into IDENTITYS(MAXIMO,COD_TABLA) values(:nUltimo,:nTabla)")
.head 8 -  Set nIdentico=0
.head 8 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 5 -  !
.head 5 -  Return nUltimo
.head 3 +  Function: ConectarCursores
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Receive Sql Handle: hSql
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  When SqlError
.head 6 -  Call ProcesarErrorMSQ()
.head 6 -  Return FALSE
.head 5 +  If SqlConnect( hSql )
.head 6 -  Call SqlSetIsolationLevel( hSql,'RL' )
.head 6 -  Call SqlSetParameter( hSql , DBP_PRESERVE, TRUE, '')
.head 6 -  Call SqlSetResultSet( hSql, FALSE )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Call SalMessageBox("No se pudo conectar el cursor","ERROR",MB_Ok)
.head 6 -  Return FALSE
.head 3 +  Function: EsUsuario
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sId
.head 5 -  String: sContrasena
.head 5 -  Receive Number: nUsuario
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlExists( "select COD_USU
	from USUARIOS 
	where NOMBRE=:sId and CONTRASE=:sContrasena
	into	:nUsuario",bExists)
.head 6 -  Call SqlClearImmediate()
.head 6 +  If bExists
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Call SalMessageBox("Los datos no se pudieron leer","ERROR",MB_Ok)
.head 6 -  Return FALSE
.head 3 +  Function: SacarCodigo
.head 4 -  Description: Extrae el valor dependiendo del query qure envia y lo regresa en
nCodigos
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sSacar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCodigos
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute(hSql6,sSacar)
.head 5 -  Call SqlFetchNext(hSql6,nSiguiente)
.head 5 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 5 -  Return nCodigos
.head 3 +  Function: CargarSeguridad
.head 4 -  Description: Esta función carga la seguridad de el usuario dependiendo
de la aplicación que se consulte. Esta información la
devuelve en un arreglo de variables booleanas.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sUser
.head 5 -  Receive Boolean: arrBooleanas[*]
.head 5 -  ! Number: nCasoSeguridad
.head 5 -  String: sConsulta
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nContador
.head 5 -  Number: nFetch
.head 5 -  String: sSeguridad
.head 5 -  String: sS1
.head 4 +  Actions
.head 5 +  ! Select Case nCasoSeguridad
.head 6 +  Case 1
.head 7 -  Set sConsulta='derechos_contabilidad'
.head 7 -  Break 
.head 6 +  Case 2
.head 7 -  Set sConsulta='derechos_facturacion'
.head 7 -  Break 
.head 6 +  Case 3
.head 7 -  Set sConsulta='derechos_planilla'
.head 7 -  Break 
.head 6 +  Case 4
.head 7 -  Set sConsulta='derechos_inventario'
.head 7 -  Break 
.head 5 -  Call SqlPrepareAndExecute(hSql1,'SELECT ' || sConsulta || '
FROM USUARIOS
WHERE NOMBRE=:sUser INTO :sS1')
.head 5 -  Call SqlFetchNext(hSql1,nFetch)
.head 5 -  Call SqlPrepareAndExecute(hSql1,'commit')
.head 5 -  Set sS1=SalStrTrimX(sS1)
.head 5 -  Set sSeguridad=''||sS1
.head 5 -  Set nContador=0
.head 5 +  While nContador <= (SalStrLength( sSeguridad ) - 1)
.head 6 -  Set arrBooleanas[ nContador+1 ] = SalStrToNumber( SalStrMidX( sSeguridad, nContador, 1 ) )
.head 6 -  Set nContador=nContador+1
.head 5 -  Return TRUE
.head 3 -  !
.head 3 -  ! PARA MANEJO DE ERRORES
.head 3 +  Function: ProcesarErrorMSQ
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlError
.head 5 -  Number: nError
.head 5 -  Number: nPos
.head 5 -  String: sTexto
.head 5 -  Boolean: bBandera
.head 4 +  Actions
.head 5 -  !
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql1,"rollback tran")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql2,"rollback tran")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql3,"rollback tran")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql4,"rollback tran")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql5,"rollback tran")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql6,"rollback tran")
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SqlExtractArgs( wParam,lParam,hSqlError, nError,nPos )
.head 5 -  Call SqlGetErrorText( nError, sTexto )
.head 5 -  !
.head 5 +  Select Case nError
.head 6 +  Case 20087
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"La base de Datos no ha sido levantada hasta este momento")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20030
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Esta tratando de eliminar un registro que tiene otras dependencias, debe de eliminar primero las otras dependencias y luego eliminar este registro")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20033
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no existe ó Contraseña incorrecta")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20026
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Error en asignación de valores, Revise tipos")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20050
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Tabla no existe")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20054
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Nombre de Campo Incorrecto")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20038
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no tiene derechos para accesar ese 
objeto")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 201
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Comando no ha sido compilado")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 -  Case 22601
.head 6 +  Case 2601
.head 7 +  If nGlobal != -11
.head 8 -  Call SalModalDialog(dlgError,hWndForm,nError,"No puede ingresar un dato que ya existe, verifique los datos")
.head 7 +  Else
.head 8 +  If nGlobal = -11
.head 9 -  Return FALSE
.head 7 -  Break
.head 6 +  Default
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,sTexto)
.head 7 -  Break
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return FALSE
.head 3 +  Function: ProcesarErrorSQLbase
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlError
.head 5 -  Number: nError
.head 5 -  Number: nPos
.head 5 -  String: sTexto
.head 5 -  Boolean: bBandera
.head 4 +  Actions
.head 5 -  !
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql1,"rollback")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql2,"rollback")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql3,"rollback")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql4,"rollback")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql5,"rollback")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql6,"rollback")
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SqlExtractArgs( wParam,lParam,hSqlError, nError,nPos )
.head 5 -  Call SqlGetErrorText( nError, sTexto )
.head 5 -  !
.head 5 +  Select Case nError
.head 6 +  Case 20087
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"La base de Datos no ha sido levantada hasta este momento")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20030
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Esta tratando de eliminar un registro que tiene otras dependencias, debe de eliminar primero las otras dependencias y luego eliminar este registro")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20033
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no existe ó Contraseña incorrecta")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20026
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Error en asignación de valores, Revise tipos")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20050
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Tabla no existe")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20054
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Nombre de Campo Incorrecto")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20038
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no tiene derechos para accesar ese 
objeto")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 201
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Comando no ha sido compilado")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 -  Case 22601
.head 6 +  Case 2601
.head 7 +  If nGlobal != -11
.head 8 -  Call SalModalDialog(dlgError,hWndForm,nError,"No puede ingresar un dato que ya existe, verifique los datos")
.head 7 +  Else
.head 8 +  If nGlobal = -11
.head 9 -  Return FALSE
.head 7 -  Break
.head 6 +  Default
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,sTexto)
.head 7 -  Break
.head 5 -  !
.head 5 -  Return FALSE
.head 3 +  ! Function: ProcesarError
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Sql Handle: hSqlError
.head 5 -  Number: nError
.head 5 -  Number: nPos
.head 5 -  String: sTexto
.head 5 -  Boolean: bBandera
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SqlExtractArgs( wParam,lParam,hSqlError, nError,nPos )
.head 5 -  Call SqlGetErrorText( nError, sTexto )
.head 5 -  ! es SQLBase
.head 5 +  Select Case nBaseEs
.head 6 -  ! es SQLBASE
.head 6 +  Case 1
.head 7 +  Select Case nError
.head 8 +  Case 404
.head 9 -  Call SalMessageBox( 'Contraseña de Usuario Inválido, verifique esa contraseña','ERROR',MB_Ok)
.head 9 -  Return FALSE
.head 9 -  Break 
.head 8 +  Case 405
.head 9 -  Call SalMessageBox( 'Usuario Inválido, verifique que el usuario exista','ERROR',MB_Ok)
.head 9 -  Return FALSE
.head 8 +  Case 410
.head 9 -  Call SalMessageBox( 'No se pudo abrir la base de datos','ERROR',MB_Ok)
.head 9 -  Return FALSE
.head 8 +  Default 
.head 9 -  Call SalMessageBox("El error actual no esta documentado por la rutina de error, a continuación se le presentará
una pantalla donde aparece la descripción del error y el número, por favor comuniqueselo a los desarrolladores de la aplicación:
Descripción ==> "||sTexto||
" 	
Numero de Error ==> "||SalNumberToStrX(nError,0),
"DESCRIPCION DEL ERROR",MB_Ok)
.head 9 -  Break 
.head 6 -  Case 8
.head 6 -  Case 28
.head 6 -  Case 31
.head 6 +  Case 4	! es SYBASE,ORACLE7,ORACLE,MSSQLSERVER
.head 7 +  Select Case nError
.head 8 +  Case 20087
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,"La base de Datos no ha sido levantada hasta este momento")
.head 9 -  Return FALSE
.head 9 -  Break 
.head 8 +  Case 20033
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no existe")
.head 9 -  Return FALSE
.head 9 -  Break 
.head 8 +  Default 
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,sTexto)
.head 9 -  Break 
.head 6 +  Case 0	!aqui es cuando no nos hemos conectado a la base de datos
.head 7 +  Select Case nError
.head 8 -  ! ESTOS SON PARA MICROSOFT SQLSERVER
.head 8 +  Case 20087
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,"La base de Datos no ha sido levantada hasta este momento")
.head 9 -  Return FALSE
.head 9 -  Break 
.head 8 +  Case 20033
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no existe ó contraseña Incorrecta")
.head 9 -  Return FALSE
.head 9 -  Break 
.head 8 +  Default 
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,sTexto)
.head 9 -  Break 
.head 6 +  Default 
.head 7 -  Call SalMessageBox( 'No hay errores para esa base de datos ','ERROR',MB_Ok)
.head 5 -  Return FALSE
.head 3 +  Function: FechaHoy
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Number: nCaso
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dtFecha
.head 4 +  Actions
.head 5 -  ! Call SqlImmediate("select getdate() into :dtFecha")
.head 5 -  ! 1 PARA Sqlbase
.head 5 -  ! 2 PARA Microsoft SQLServer
.head 5 +  Select Case nCaso
.head 6 +  Case 1
.head 7 -  Call SqlImmediate("SELECT SYSDATETIME FROM SYSTABLES WHERE COLCOUNT>10
 into :dtFecha")
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Call SqlImmediate("select getdate() into :dtFecha")
.head 7 -  Break
.head 5 -  Call SqlClearImmediate()
.head 5 -  Return dtFecha
.head 3 -  !
.head 3 -  ! PARA MANEJO DE LIST BOX
.head 3 -  !
.head 3 +  ! Function: Leer_ListBox
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Window Handle: lbGenerico
.head 5 -  String: sTablaVarias
.head 5 -  String: sTablaAxl
.head 5 -  String: sCodigoVarias
.head 5 -  String: sCodigoAxl
.head 5 -  Number: nUnicoValor
.head 5 -  String: sUnicoValor
.head 5 -  Receive Sql Handle: hSqlInsertar
.head 5 -  Number: nCaso
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nBuscando
.head 5 -  Number: nActual
.head 5 -  Number: nEntradas
.head 5 -  String: sBuscar
.head 5 -  String: sBuscar2
.head 4 +  Actions 
.head 5 +  Select Case nCaso
.head 6 +  Case 1	! este es para el caso que sean Entero,Entero
.head 7 +  If not SqlPrepareAndExecute(hSqlInsertar,"select "||sCodigoAxl||" from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor into :nBuscando")
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSqlInsertar,nSiguiente)
.head 8 +  If not SqlImmediate("select NOMBRE  from "||sTablaAxl||" where "||sCodigoAxl||"=:nBuscando into :sBuscar")
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 8 -  Set nActual=0
.head 8 +  While nActual<nEntradas
.head 9 +  If not SalListQueryState( lbGenerico, nActual )
.head 10 -  Set sBuscar2=SalListQueryTextX( lbGenerico,nActual)
.head 9 +  Else 
.head 10 -  ! Call SalListSetSelect( lbGenerico, nActual)
.head 10 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 9 +  If sBuscar2=sBuscar
.head 10 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 9 -  Set nActual=nActual+1
.head 7 -  Return TRUE
.head 7 -  Break 
.head 6 +  Case 2		! este es para el caso que sean Entero,Caracter
.head 7 +  If not SqlPrepareAndExecute(hSqlInsertar,"select "||sCodigoAxl||" from "||sTablaVarias||"
		where "||sCodigoVarias||"=:sUnicoValor into :nBuscando")
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSqlInsertar,nSiguiente)
.head 8 +  If not SqlImmediate("select NOMBRE  from "||sTablaAxl||" where "||sCodigoAxl||"=:nBuscando into :sBuscar")
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 8 -  Set nActual=0
.head 8 +  While nActual<nEntradas
.head 9 +  If not SalListQueryState( lbGenerico, nActual )
.head 10 -  Set sBuscar2=SalListQueryTextX( lbGenerico,nActual)
.head 9 +  Else 
.head 10 -  ! Call SalListSetSelect( lbGenerico, nActual)
.head 10 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 9 +  If sBuscar2=sBuscar
.head 10 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 9 -  Set nActual=nActual+1
.head 7 -  Return TRUE
.head 7 -  Break 
.head 3 +  ! Function: Actualizar_ListBox
.head 4 -  Description: 	Actualiza una tabla que sea de tipo N-->N
	Ejemplo:
	
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Window Handle: lbGenerico
.head 5 -  String: sTablaVarias
.head 5 -  String: sTablaAxl
.head 5 -  String: sCodigoVarias
.head 5 -  String: sCodigoAxl
.head 5 -  Number: nUnicoValor
.head 5 -  String: sUnicoValor
.head 5 -  Receive Sql Handle: hSqlInsertar
.head 5 -  Number: nCaso
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nActual
.head 5 -  Number: nEntradas
.head 5 -  Number: nCod
.head 5 -  String: sBuscar
.head 4 +  Actions 
.head 5 +  Select Case nCaso
.head 6 +  Case 1	! este es para el caso que sean Entero,Entero
.head 7 +  If SqlExists("select * from "||sTablaVarias||" where "||sCodigoVarias||"=:nUnicoValor",bExists)
.head 8 +  If bExists
.head 9 +  If not SqlPrepareAndExecute(hSqlInsertar,"delete from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor")
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 8 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 8 -  Set nActual=0
.head 8 +  While nActual<nEntradas
.head 9 +  If SalListQueryState( lbGenerico, nActual )
.head 10 -  Set sBuscar=SalListQueryTextX( lbGenerico,nActual)
.head 10 +  If not SqlImmediate("select "||sCodigoAxl||" from "||sTablaAxl||" where NOMBRE=:sBuscar into :nCod")
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 10 +  If not SqlPrepareAndExecute(hSqlInsertar,"insert into "||sTablaVarias||
		"("||sCodigoVarias||","||sCodigoAxl||")"||
		"values(:nUnicoValor,:nCod)")
		
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo grabar informacion en tabla de varias","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 9 -  Set nActual=nActual+1
.head 8 -  Return TRUE
.head 7 +  Else 
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox("No se pudo sacar la información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 7 -  Break 
.head 6 +  Case 2	! este es para el caso que sean Entero,Caracter
.head 7 +  If SqlExists("select * from "||sTablaVarias||" where "||sCodigoVarias||"=:sUnicoValor",bExists)
.head 8 +  If bExists
.head 9 +  If not SqlPrepareAndExecute(hSqlInsertar,"delete from "||sTablaVarias||"
		where "||sCodigoVarias||"=:sUnicoValor")
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 8 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 8 -  Set nActual=0
.head 8 +  While nActual<nEntradas
.head 9 +  If SalListQueryState( lbGenerico, nActual )
.head 10 -  Set sBuscar=SalListQueryTextX( lbGenerico,nActual)
.head 10 +  If not SqlImmediate("select "||sCodigoAxl||" from "||sTablaAxl||" where NOMBRE=:sBuscar into :nCod")
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 10 +  If not SqlPrepareAndExecute(hSqlInsertar,"insert into "||sTablaVarias||
		"("||sCodigoVarias||","||sCodigoAxl||")"||
		"values(:sUnicoValor,:nCod)")
		
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo grabar informacion en tabla de varias","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 9 -  Set nActual=nActual+1
.head 8 -  Return TRUE
.head 7 +  Else 
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox("No se pudo sacar la información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 7 -  Break 
.head 3 +  Function: HaySeleccionadosListBox
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: lbGenerico
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nActual
.head 5 -  Number: nEntradas
.head 4 +  Actions
.head 5 -  Set nEntradas=SalListQueryCount(lbGenerico)
.head 5 -  Set nActual=0
.head 5 +  While nActual<nEntradas
.head 6 +  If SalListQueryState( lbGenerico, nActual )
.head 7 -  Return TRUE
.head 6 -  Set nActual=nActual+1
.head 5 -  Return FALSE
.head 3 +  Function: Grabar_Auditorias
.head 4 -  Description: Recibe 2 parametros
1) Tipo de Operacion, estos pueden ser:
	1	Insertar
	2	Actualizar
	3	Eliminar
	4	Consultar
	5	Entrada al Sistema
	6	Salida del Sistema

.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nOperacion
.head 5 -  String: sHizo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dtHoy
.head 5 -  String: sOperacion
.head 4 +  Actions
.head 5 +  Select Case nOperacion
.head 6 +  Case 1
.head 7 -  Set sOperacion='Insertar'
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set sOperacion='Actualizar'
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Set sOperacion='Eliminar'
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  Set sOperacion='Consultar'
.head 7 -  Break
.head 6 +  Case 5
.head 7 -  Set sOperacion='Ent.Sistema'
.head 7 -  Break
.head 6 +  Case 6
.head 7 -  Set sOperacion='Sal.Sistema'
.head 7 -  Break
.head 5 -  Set dtHoy=FechaHoy( 1 )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"insert into
AUDITORIAS(COD_USU,FECHA,HIZO,OPERACION)
values(:nUsuario,:dtHoy,:sHizo,:sOperacion)")
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")

.head 3 -  ! del sqlwindows
.head 3 +  ! Function: Leer_ListBox
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Window Handle: lbGenerico
.head 5 -  String: sTablaVarias
.head 5 -  String: sTablaAxl
.head 5 -  String: sCodigoVarias
.head 5 -  String: sCodigoAxl
.head 5 -  Number: nUnicoValor
.head 5 -  Receive Sql Handle: hSqlInsertar
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nBuscando
.head 5 -  Number: nActual
.head 5 -  Number: nEntradas
.head 5 -  String: sBuscar
.head 5 -  String: sBuscar2
.head 4 +  Actions 
.head 5 +  If not SqlPrepareAndExecute(hSqlInsertar,"select "||sCodigoAxl||" from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor into :nBuscando")
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 6 -  Return FALSE
.head 5 +  While SqlFetchNext(hSqlInsertar,nSiguiente)
.head 6 +  If not SqlImmediate("select NOMBRE  from "||sTablaAxl||" where "||sCodigoAxl||"=:nBuscando into :sBuscar")
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 7 -  Return FALSE
.head 6 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 6 -  Set nActual=0
.head 6 +  While nActual<nEntradas
.head 7 +  If not SalListQueryState( lbGenerico, nActual )
.head 8 -  Set sBuscar2=SalListQueryTextX( lbGenerico,nActual)
.head 7 +  Else 
.head 8 -  ! Call SalListSetSelect( lbGenerico, nActual)
.head 8 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 7 +  If sBuscar2=sBuscar
.head 8 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 7 -  Set nActual=nActual+1
.head 5 -  Return TRUE
.head 3 +  ! Function: Actualizar_ListBox
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Window Handle: lbGenerico
.head 5 -  String: sTablaVarias
.head 5 -  String: sTablaAxl
.head 5 -  String: sCodigoVarias
.head 5 -  String: sCodigoAxl
.head 5 -  Number: nUnicoValor
.head 5 -  Receive Sql Handle: hSqlInsertar
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nActual
.head 5 -  Number: nEntradas
.head 5 -  Number: nCod
.head 5 -  String: sBuscar
.head 4 +  Actions 
.head 5 +  If SqlExists("select * from "||sTablaVarias||" where "||sCodigoVarias||"=:nUnicoValor",bExists)
.head 6 +  If bExists
.head 7 +  If not SqlPrepareAndExecute(hSqlInsertar,"delete from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor")
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 6 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 6 -  Set nActual=0
.head 6 +  While nActual<nEntradas
.head 7 +  If SalListQueryState( lbGenerico, nActual )
.head 8 -  Set sBuscar=SalListQueryTextX( lbGenerico,nActual)
.head 8 +  If not SqlImmediate("select "||sCodigoAxl||" from "||sTablaAxl||" where NOMBRE=:sBuscar into :nCod")
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 +  If not SqlPrepareAndExecute(hSqlInsertar,"insert into "||sTablaVarias||
		"("||sCodigoVarias||","||sCodigoAxl||")"||
		"values(:nUnicoValor,:nCod)")
		
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call SalMessageBox("No se pudo grabar informacion en tabla de varias","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 7 -  Set nActual=nActual+1
.head 6 -  Return TRUE
.head 5 +  Else 
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalMessageBox("No se pudo sacar la información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 6 -  Return FALSE
.head 3 +  Function: FechaStr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: dtFecha
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: xsFecha
.head 5 -  Number: xnMes
.head 5 -  Number: xnDia
.head 5 -  Number: xnAnio
.head 4 +  Actions
.head 5 -  Set xnMes=SalDateMonth(dtFecha)
.head 5 -  Set xnDia=SalDateDay(dtFecha)
.head 5 -  Set xnAnio=SalDateYear(dtFecha)
.head 5 -  Set xsFecha = SalNumberToStrX(xnDia,0)
.head 5 -  Set xsFecha = xsFecha || " de "
.head 5 +  Select Case xnMes
.head 6 +  Case 1
.head 7 -  Set xsFecha=xsFecha || "Enero"
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set xsFecha=xsFecha ||"Febrero"
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Set xsFecha=xsFecha ||"Marzo"
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  Set xsFecha=xsFecha ||"Abril"
.head 7 -  Break
.head 6 +  Case 5
.head 7 -  Set xsFecha=xsFecha ||"Mayo"
.head 7 -  Break
.head 6 +  Case 6
.head 7 -  Set xsFecha=xsFecha ||"Junio"
.head 7 -  Break
.head 6 +  Case 7
.head 7 -  Set xsFecha=xsFecha ||"Julio"
.head 7 -  Break
.head 6 +  Case 8
.head 7 -  Set xsFecha=xsFecha ||"Agosto"
.head 7 -  Break
.head 6 +  Case 9
.head 7 -  Set xsFecha=xsFecha ||"Septiembre"
.head 7 -  Break
.head 6 +  Case 10
.head 7 -  Set xsFecha=xsFecha ||"Octubre"
.head 7 -  Break
.head 6 +  Case 11
.head 7 -  Set xsFecha=xsFecha ||"Noviembre"
.head 7 -  Break
.head 6 +  Default
.head 7 -  Set xsFecha=xsFecha ||"Diciembre"
.head 7 -  Break
.head 5 -  Set xsFecha = xsFecha || " de "
.head 5 -  Set xsFecha = xsFecha || SalNumberToStrX(xnAnio,0)
.head 5 -  Return xsFecha
.head 3 +  Function: CopiarTabla
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTablaCopiar
.head 5 -  Number: nTipo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Long String: lsBufer
.head 5 -  Long String: lsLinea
.head 5 -  String: lsTexto
.head 5 -  Window Handle: hWndHijo
.head 5 -  Window Handle: hWndColumna
.head 5 -  Number: nFilaCopiar
.head 4 +  Actions
.head 5 -  !
.head 5 -  Set lsBufer=''
.head 5 -  Set lsLinea=''
.head 5 +  If nTipo = 1
.head 6 -  Set hWndColumna=SalGetFirstChild( hWndTablaCopiar, TYPE_TableColumn)
.head 6 +  While hWndColumna != hWndNULL
.head 7 +  If SalIsWindowVisible(  hWndColumna )
.head 8 -  Set lsTexto=''
.head 8 -  Call SalTblGetColumnTitle( hWndColumna,lsTexto,1000)
.head 8 -  Set lsTexto = StrReplace(lsTexto, SalNumberToChar( 10 ),' ')
.head 8 -  Set lsTexto = StrReplace(lsTexto, SalNumberToChar( 13 ),' ')
.head 8 -  Set lsTexto= SalStrTrimX( lsTexto ) || SalNumberToChar( 9 )
.head 8 -  Set lsLinea=lsLinea || lsTexto
.head 7 -  Set hWndColumna=SalGetNextChild( hWndColumna, TYPE_TableColumn)
.head 6 -  Set lsLinea = SalStrReplaceX( lsLinea, SalStrLength( lsLinea )-1, 1, SalNumberToChar( 13 ) )
.head 6 -  Set lsBufer = lsLinea
.head 5 -  !
.head 5 -  ! ahora saquemos los datos
.head 5 -  Set nFilaCopiar=-1
.head 5 +  While SalTblFindNextRow(hWndTablaCopiar,nFilaCopiar,0,0)
.head 6 -  Call SalTblSetContext(hWndTablaCopiar,nFilaCopiar)
.head 6 +  If SalTblQueryRowFlags( hWndTablaCopiar, nFilaCopiar,ROW_Selected)
.head 7 -  Set lsLinea=''
.head 7 -  Set hWndColumna=SalGetFirstChild( hWndTablaCopiar, TYPE_TableColumn)
.head 7 +  While hWndColumna != hWndNULL
.head 8 +  If SalIsWindowVisible(  hWndColumna )
.head 9 -  Set lsTexto=''
.head 9 -  Call SalGetWindowText( hWndColumna,lsTexto,1000)
.head 9 -  Set lsTexto = StrReplace(lsTexto, SalNumberToChar( 10 ),' ')
.head 9 -  Set lsTexto = StrReplace(lsTexto, SalNumberToChar( 13 ),' ')
.head 9 -  Set lsLinea=lsLinea || lsTexto || SalNumberToChar( 9 )
.head 8 -  Set hWndColumna=SalGetNextChild( hWndColumna, TYPE_TableColumn)
.head 7 -  Set lsLinea = SalStrReplaceX( lsLinea, SalStrLength( lsLinea )-1, 1, SalNumberToChar( 13 ) )
.head 7 -  Set lsBufer = lsBufer || lsLinea
.head 5 -  !
.head 5 -  Call Copy2Clipboard(lsBufer)
.head 3 +  Function: StrReplace
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: strSource
.head 5 -  String: strOldPattern
.head 5 -  String: strNewPattern
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nPos
.head 5 -  String: strNewString
.head 5 -  String: strStringOld
.head 4 +  Actions
.head 5 -  Set strStringOld = strSource
.head 5 -  Set nPos = SalStrScan( strStringOld, strOldPattern )
.head 5 +  While nPos != -1
.head 6 -  Set strNewString = strNewString || SalStrMidX( strStringOld, 0, nPos )  || strNewPattern
.head 6 -  Set strStringOld = SalStrMidX( strStringOld, nPos+SalStrLength(strOldPattern), SalStrLength( strStringOld ) )
.head 6 -  Set nPos = SalStrScan( strStringOld, strOldPattern )
.head 5 -  Return strNewString || strStringOld
.head 3 +  Function: Copy2Clipboard
.head 4 -  Description: Kopiert den übergebenen String in die Zwischenablage. Der String darf > 64kB sein.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: p_sText
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: hAlloc
.head 5 -  Number: nhText
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nLengthOfText
.head 5 -  Number: nSizeOfText
.head 4 +  Actions
.head 5 -  ! Open clipboard
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If OpenClipboard( hWndForm )
.head 6 -  !
.head 6 -  ! Empty clipboard
.head 6 -  Call EmptyClipboard( )
.head 6 -  !
.head 6 -  ! Allocate a buffer
.head 6 -  Set nLengthOfText = SalStrLength( p_sText )
.head 6 -  Set nSizeOfText = nLengthOfText + 1
.head 6 -  Set hAlloc = GlobalAlloc( GMEM_MOVEABLE, nSizeOfText )
.head 6 +  If hAlloc = NUMBER_Null
.head 7 -  Call CloseClipboard()
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  ! Copy string to the buffer
.head 6 -  Set nhText = GlobalLock( hAlloc )
.head 6 -  Call memcpy( nhText, p_sText, nLengthOfText )
.head 6 -  !
.head 6 -  ! Release buffer
.head 6 -  Call GlobalUnlock( hAlloc )
.head 6 -  !
.head 6 -  ! Copy buffer to clipboard
.head 6 -  Call SetClipboardData( CF_TEXT, hAlloc )
.head 6 -  !
.head 6 -  ! Close clipboard
.head 6 -  Call CloseClipboard()
.head 6 -  !
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Return FALSE
.head 3 +  Function: AutosizeColumns
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTbl
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndCol
.head 4 +  Actions
.head 5 -  ! ! Agregado el 15/Aug/2006 by Elvin Deras
.head 5 -  Set hWndCol = SalGetFirstChild( hWndTbl, TYPE_TableColumn )
.head 5 +  While hWndCol != hWndNULL
.head 6 +  If SalIsWindowVisible(  hWndCol)
.head 7 -  Call MTblAutoSizeColumn( hWndTbl, hWndCol, MTASC_ALLROWS | MTASC_SPLITROWS )
.head 6 -  Set hWndCol = SalGetNextChild( hWndCol, TYPE_TableColumn)
.head 3 +  Function: ExportToExcel
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTablaCopiar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFilaCopiar
.head 5 -  Number: nComa
.head 5 -  !
.head 5 -  Window Handle: hWndHijo
.head 5 -  Window Handle: hWndTabla
.head 5 -  Window Handle: hWndColumna
.head 5 -  Long String: lsLinea
.head 5 -  Long String: lsTexto
.head 5 -  Long String: sPath
.head 5 -  Long String: sArchivo
.head 5 -  Number: nIndice
.head 5 -  String: sFiltros[2]
.head 5 -  File Handle: fhArchivo
.head 5 -  !
.head 5 -  Number: nOpcionClipboardArchivo
.head 5 -  Number: nSize
.head 4 +  Actions
.head 5 -  !
.head 5 -  Set nSize = 255
.head 5 -  Call SalStrSetBufferLength( sPath, nSize )
.head 5 -  Call GetEnvironmentVariableA( 'TEMP', sPath, nSize )
.head 5 -  Set sPath = sPath || '\\temp' || SalFmtFormatDateTime( SalDateCurrent(), 'ddMMyyyyhhmmss' ) || ".xls"
.head 5 +  ! If SalDlgSaveFile(  hWndNULL , "Introduzca el nombre del Archivo a Guardar", sFiltros, 2, nIndice, sArchivo,sPath)
.head 6 -  !
.head 6 +  If SalFileOpen( fhArchivo, sPath, OF_Create | OF_ReadWrite)
.head 7 -  ! primero saquemos los titulos de las columnas
.head 7 -  !
.head 7 -  Set lsLinea=''
.head 7 -  Set hWndColumna=SalGetFirstChild( hWndTablaCopiar, TYPE_TableColumn)
.head 7 +  While hWndColumna != hWndNULL
.head 8 +  If SalIsWindowVisible(  hWndColumna )
.head 9 -  Set lsTexto=''
.head 9 -  Call SalTblGetColumnTitle( hWndColumna,lsTexto,1000)
.head 9 -  Set lsTexto=SalStrTrimX( lsTexto )
.head 9 -  Set nComa=SalStrScan( lsTexto, "," )
.head 9 +  If nComa != -1
.head 10 -  Set lsTexto=SalStrReplaceX( lsTexto, nComa,1,"")
.head 9 -  Call Elimina_TABSENTER_y_Demas_GLOBAL(lsTexto,lsTexto)
.head 9 -  Set lsLinea=lsLinea || lsTexto || ","
.head 8 -  Set hWndColumna=SalGetNextChild( hWndColumna, TYPE_TableColumn)
.head 7 +  If not SalFilePutStr( fhArchivo, lsLinea )
.head 8 -  Call SalMessageBox("No se pudo escribir la fila en dicho Archivo","ERROR",MB_Ok)
.head 7 -  !
.head 7 -  !
.head 7 -  ! ahora saquemos los datos
.head 7 -  Set nFilaCopiar=-1
.head 7 +  While SalTblFindNextRow(hWndTablaCopiar,nFilaCopiar,0,0)
.head 8 -  Call SalTblSetContext(hWndTablaCopiar,nFilaCopiar)
.head 8 -  !
.head 8 +  If (nCasoEstatusFila=ROW_Selected	and	SalTblQueryRowFlags( hWndTablaCopiar, nFilaCopiar,ROW_Selected ))
or	nCasoEstatusFila=NUMBER_Null
.head 9 -  Set lsLinea=''
.head 9 -  Set hWndColumna=SalGetFirstChild( hWndTablaCopiar, TYPE_TableColumn)
.head 9 +  While hWndColumna != hWndNULL
.head 10 +  If SalIsWindowVisible(  hWndColumna )
.head 11 -  Set lsTexto=''
.head 11 -  Call SalGetWindowText( hWndColumna,lsTexto,1000)
.head 11 -  Set nComa=SalStrScan( lsTexto, "," )
.head 11 +  If nComa != -1
.head 12 -  Set lsTexto=SalStrReplaceX( lsTexto, nComa,1,"")
.head 11 -  Set lsLinea=lsLinea || lsTexto || ","
.head 11 -  ! Set lsLinea=lsLinea || lsTexto || ","
.head 10 -  Set hWndColumna=SalGetNextChild( hWndColumna, TYPE_TableColumn)
.head 9 -  !
.head 9 +  If not SalFilePutStr( fhArchivo, lsLinea )
.head 10 -  Call SalMessageBox("No se pudo escribir la fila en dicho Archivo","ERROR",MB_Ok)
.head 7 -  !
.head 7 -  Call SalFileClose( fhArchivo )
.head 7 -  Call ShellExecuteA( hWndNULL, '', sPath, '', '', 1 )
.head 6 +  Else
.head 7 -  Call SalMessageBox("Archivo no pudo ser creado en dicho Path","ERROR",MB_Ok)
.head 6 -  !
.head 5 -  !
.head 5 +  If Not SalFileOpen( fhArchivo, sPath, OF_Create | OF_ReadWrite)
.head 6 +  If Not SalDlgSaveFile(  hWndNULL , "Introduzca el nombre del Archivo a Guardar", sFiltros, 2, nIndice, sArchivo,sPath)
.head 7 -  Call SalMessageBox("Archivo no pudo ser creado en dicho Path","ERROR",MB_Ok)
.head 5 -  ! primero saquemos los titulos de las columnas
.head 5 -  !
.head 5 -  Set lsLinea = "	<HTML xmlns:o='urn:schemas-microsoft-com:office:office'
		      xmlns:x='urn:schemas-microsoft-com:office:excel'
		      xmlns='http://www.w3.org/TR/REC-html40'>
		<HEAD>
		  <meta http-equiv='Content-Type' content='application/vnd.ms-excel; charset=windows-1252'>
		  <meta name=ProgId content=Excel.Sheet>
		  <meta name=Generator content='Microsoft Excel 10'>
		  <!--[if gte mso 9]><xml>
 <x:ExcelWorkbook>
  <x:ExcelWorksheets>
   <x:ExcelWorksheet>
    <x:Name>QCS</x:Name>
    <x:WorksheetOptions>
     <x:ProtectContents>False</x:ProtectContents>
     <x:ProtectObjects>False</x:ProtectObjects>
     <x:ProtectScenarios>False</x:ProtectScenarios>
    </x:WorksheetOptions>
   </x:ExcelWorksheet>
  <x:WindowHeight>8580</x:WindowHeight>
  <x:WindowWidth>11340</x:WindowWidth>
  <x:WindowTopX>480</x:WindowTopX>
  <x:WindowTopY>45</x:WindowTopY>
  <x:ProtectStructure>False</x:ProtectStructure>
  <x:ProtectWindows>False</x:ProtectWindows>
 </x:ExcelWorkbook>
</xml><![endif]-->
		</HEAD>
		<BODY>
		  <TABLE border='1'>
		    <TR>"
.head 5 +  If not SalFilePutStr( fhArchivo, lsLinea )
.head 6 -  Call SalMessageBox("No se pudo escribir la fila en dicho Archivo","ERROR",MB_Ok)
.head 5 -  Set lsLinea=''
.head 5 -  Set hWndColumna=SalGetFirstChild( hWndTablaCopiar, TYPE_TableColumn)
.head 5 +  While hWndColumna != hWndNULL
.head 6 +  If SalIsWindowVisible(  hWndColumna )
.head 7 -  Set lsTexto=''
.head 7 -  Call SalTblGetColumnTitle( hWndColumna,lsTexto,1000)
.head 7 -  Set lsTexto= "<TH bgcolor='silver'>" || SalStrTrimX( lsTexto ) || "</TH>"
.head 7 -  ! Set nComa=SalStrScan( lsTexto, "," )
.head 7 +  ! If nComa != -1
.head 8 -  Set lsTexto=SalStrReplaceX( lsTexto, nComa,1,"")
.head 7 -  Call Elimina_TABSENTER_y_Demas_GLOBAL(lsTexto,lsTexto)
.head 7 -  Set lsLinea=lsLinea || lsTexto
.head 6 -  Set hWndColumna=SalGetNextChild( hWndColumna, TYPE_TableColumn)
.head 5 -  Set lsLinea = lsLinea || "</TR>"
.head 5 +  If not SalFilePutStr( fhArchivo, lsLinea )
.head 6 -  Call SalMessageBox("No se pudo escribir la fila en dicho Archivo","ERROR",MB_Ok)
.head 5 -  !
.head 5 -  !
.head 5 -  ! ahora saquemos los datos
.head 5 -  Set nFilaCopiar=-1
.head 5 +  While SalTblFindNextRow(hWndTablaCopiar,nFilaCopiar,0,0)
.head 6 -  Call SalTblSetContext(hWndTablaCopiar,nFilaCopiar)
.head 6 -  !
.head 6 +  If SalTblQueryRowFlags( hWndTablaCopiar, nFilaCopiar,ROW_Selected)
.head 7 -  Set lsLinea='<TR>'
.head 7 -  Set hWndColumna=SalGetFirstChild( hWndTablaCopiar, TYPE_TableColumn)
.head 7 +  While hWndColumna != hWndNULL
.head 8 +  If SalIsWindowVisible(  hWndColumna )
.head 9 -  Set lsTexto=''
.head 9 -  Call SalGetWindowText( hWndColumna,lsTexto,1000)
.head 9 -  Set lsTexto = "<TD>" || lsTexto || "</TD>"
.head 9 -  ! Set nComa=SalStrScan( lsTexto, "," )
.head 9 +  ! If nComa != -1
.head 10 -  Set lsTexto=SalStrReplaceX( lsTexto, nComa,1,"")
.head 9 -  Set lsLinea=lsLinea || lsTexto
.head 9 -  ! Set lsLinea=lsLinea || lsTexto || ","
.head 8 -  Set hWndColumna=SalGetNextChild( hWndColumna, TYPE_TableColumn)
.head 7 -  !
.head 7 -  Set lsLinea = lsLinea || '</TR>'
.head 7 +  If not SalFilePutStr( fhArchivo, lsLinea )
.head 8 -  Call SalMessageBox("No se pudo escribir la fila en dicho Archivo","ERROR",MB_Ok)
.head 5 -  !
.head 5 -  Set lsLinea = "</TABLE> </BODY> </HTML>"
.head 5 +  If not SalFilePutStr( fhArchivo, lsLinea )
.head 6 -  Call SalMessageBox("No se pudo escribir la fila en dicho Archivo","ERROR",MB_Ok)
.head 5 -  Call SalFileClose( fhArchivo )
.head 5 -  Call ShellExecuteA( hWndNULL, '', sPath, '', '', 1 )
.head 5 -  !
.head 3 +  Function: Elimina_TABSENTER_y_Demas_GLOBAL
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sCadena
.head 5 -  Receive String: sCadenaDevuelve
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: n1
.head 5 -  Number: nTamano
.head 5 -  Number: nCaracter
.head 5 -  String: sCaracter
.head 5 -  String: sCaracter2
.head 4 +  Actions
.head 5 -  Set sCadenaDevuelve=''
.head 5 -  Set nTamano = SalStrLength( sCadena )
.head 5 -  Set n1 = 0
.head 5 +  While n1 < nTamano
.head 6 -  Set sCaracter = SalStrMidX( sCadena, n1,1 )
.head 6 -  Set sCaracter2 = sCaracter
.head 6 -  Set nCaracter = SalStrLop( sCaracter2 )
.head 6 +  If nCaracter = 0 or nCaracter = 13 or nCaracter = 9 or nCaracter = 10
.head 7 -  Set sCadenaDevuelve = sCadenaDevuelve || ' '
.head 6 +  Else
.head 7 -  Set sCadenaDevuelve = sCadenaDevuelve || sCaracter
.head 6 -  Set n1 = n1 + 1
.head 5 -  Return sCadenaDevuelve
.head 3 +  Function: GetParameterNValue
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: pIdParameter
.head 5 -  Number: pValueNumber
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sValues[3]
.head 5 -  Number: nReturnValue
.head 4 +  Actions
.head 5 -  Call GetParameterValues( pIdParameter, sValues[0], sValues[1], sValues[2] )
.head 5 +  If pValueNumber > 3 Or pValueNumber < 1
.head 6 -  Set pValueNumber = 1
.head 5 -  Set nReturnValue = SalStrToNumber( sValues[pValueNumber-1] )
.head 5 -  Return nReturnValue
.head 5 -  ! !
.head 3 +  Function: GetParameterValues
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: pIdParameter
.head 5 -  Receive String: pReturnValue1
.head 5 -  Receive String: pReturnValue2
.head 5 -  Receive String: pReturnValue3
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SqlImmediate( "SELECT VALOR1, VALOR2, VALOR3 FROM SYS_PARAMETROS INTO :pReturnValue1, :pReturnValue2, :pReturnValue3 WHERE SID_PARAMETRO = :pIdParameter" )
.head 5 -  Call SqlClearImmediate(  )
.head 3 +  Function: SetParameterValues
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: pIdParameter
.head 5 -  String: P_Value1
.head 5 -  String: P_Value2
.head 5 -  String: P_Value3
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute( hSql1,  "UPDATE  SYS_PARAMETROS SET VALOR1 = :P_Value1, VALOR2 = :P_Value2, VALOR3 = :P_Value3  WHERE SID_PARAMETRO = :pIdParameter" )
.head 5 -  Call SqlPrepareAndExecute( hSql1,  "COMMIT" )
.head 3 +  Function: GetPeriodoContable
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Receive Date/Time: P_Inicio
.head 5 -  Receive Date/Time: P_Fin
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sValues[3]
.head 4 +  Actions
.head 5 -  Call GetParameterValues( 'CONTABILIDAD_PERIODO_CONTABLE', sValues[0], sValues[1], sValues[2] )
.head 5 -  Set P_Inicio = SalStrToDate( sValues[0] )
.head 5 -  Set P_Fin = SalStrToDate( sValues[1] )
.head 3 +  Function: ShowMessage
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: P_Message
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalMessageBox( P_Message, ".:: Sistema de Gestión Hospitalaria ::.", MB_Ok | MB_IconExclamation )
.head 2 +  Named Menus
.head 3 +  Menu: TableMenu
.head 4 -  Resource Id: 37730
.head 4 -  Title: MenuTable
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Copiar
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 37731
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call CopiarTabla( hWndForm, 0)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Copiar Todo
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 37732
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call CopiarTabla( hWndForm, 1)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Exportar a Excel
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 37733
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  ! Call ExportToExcel( hWndForm)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 6 -  Call MTblExportToExcel(hWndForm, MTE_LNG_ENGLISH, "A1",  MTE_EXCEL_NEW_INSTANCE,  MTE_COL_HEADERS | MTE_COLORS | MTE_FONTS | MTE_GRID | MTE_SPLIT_ROWS | MTE_SHOW_STATUS, ROW_Selected,
ROW_Hidden, COL_Visible, 0 )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Seleccionar Todo
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 37734
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg( hWndForm, SAM_CornerClick, 0,0 )
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Ajustar Tamaño de columnas
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Resource Id: 37735
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call AutosizeColumns(hWndForm)
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 4F4C455F4D454E55 5F47524F55500004 000000000000
.enddata
.head 5 -  Menu Item Name:
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3963532588
0000: 0703000088010000 0000000000000000 0200000800FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F0D003C00 00077000624D656E
0040: 6F731E00C0000001 000000A3010D0000 FFFF000180150000 000100010015636D
0060: 624261007365436F 6469676F0046696C 747261646F005200 0000030000000F02
0080: 040000FE00FF1304 0000010DFB00FF0F 11000000EE0200FF 3F01800615000200
00A0: 0000F819636DFF3F 4368906172520000 033D000204FB00FF 6F0400EC010D00FF
00C0: BF11B9000200FFFF 9801801500030100 13636C734362FC43 6FBF52D9000300B3
00E0: 010D00FFFFE40D00 0002FE00FF9B1100 02FB00FF0F01800D 0019000400127000
0100: 624368426F727261 0072436869717569 74886F1E00000100 9E00010DFD00FF87
0120: 0180040000000500 00000D6672006D53 6F6C6F4E6F6D2062 72651E0000017A00
0140: 0003F4040000FF1F 0180150300060000 000DF4636D42DF52 E800030000DD0200
0160: FF7F046300010D00 FFFFCD110002FD00 FFC7018015000007 0000000B636CEF6F
0180: CF00039E00010DFD 00FF270D000002F7 00FFDF11DC000200 FF7F
.enddata
.head 3 -  !
.head 3 -  ! estos son botones mas graficos
.head 3 +  Pushbutton Class: pbMas
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\filenew.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Boton de Nueva para la aplicacion
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndFila
.head 5 -  Window Handle: hWndTabla
.head 5 -  Window Handle: hWndCampo
.head 5 -  Number: nOpcionh ! 1 para forma, 2 para table-window
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call Limpiar(  )
.head 6 -  Call HabilitarTodo(  )
.head 6 +  If nOpcionh=1
.head 7 -  Call SalSetFocus(hWndCampo)
.head 6 +  Else
.head 7 -  Call SalTblReset(hWndTabla)
.head 7 -  ! Call SalSetFocus(hWndTabla)
.head 7 -  ! Call SalTblSetFocusCell( hWndTabla, SalTblInsertRow( hWndTabla, TBL_MaxRow ), hWndFila, 0, 1 )
.head 6 -  Call SalStatusSetText(hWndForm,'                                                      ')
.head 3 +  Pushbutton Class: pbLimpia
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\eraser.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Boton usado en las ventanas de consultas, que limpia todos los datos que tenga
en pantalla
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call Limpiar(  )
.head 6 -  Call HabilitarTodo(  )
.head 3 +  Pushbutton Class: pbImprimir
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\fileprint.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Boton de Nueva para la aplicacion
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: pbBusqueda
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F3
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\search.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Boton de busqueda para las aplicaciones
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: pbMenos
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\editdelete.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 +  Class Variables
.head 5 -  Number: nFilas
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndFila
.head 5 -  Window Handle: hWndTabla
.head 5 -  Number: nOpcionh ! 1 para forma, 2 para table-window
.head 5 -  String: sTitulo
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If nOpcionh=1
.head 7 +  If SalMessageBox("Desea Eliminar "||sTitulo,"ADVERTENCIA",MB_YesNo)=IDYES
.head 8 -  Call SalSendMsg(hWndForm,MU_BORRAR,0,0)
.head 8 -  Call Limpiar(  )
.head 6 +  Else
.head 7 -  Call SalStatusSetText(hWndForm,'                                                      ')
.head 7 -  Call SalTblQueryFocus(  hWndTabla,nFilas,hWndFila)
.head 7 +  If SalTblQueryRowFlags( hWndTabla,nFilas,ROW_MarkDeleted)
.head 8 -  Call SalTblSetRowFlags( hWndTabla,nFilas, ROW_MarkDeleted,FALSE)
.head 7 +  Else
.head 8 +  If SalTblQueryRowFlags( hWndTabla,nFilas,ROW_New)
.head 9 -  Call SalTblDeleteRow( hWndTabla, nFilas, TBL_Adjust )
.head 8 +  Else
.head 9 -  Call SalTblSetRowFlags( hWndTabla,nFilas, ROW_MarkDeleted,TRUE)
.head 9 -  Call SalTblSetFocusCell( hWndTabla, nFilas, hWndFila, 0, 1 )
.head 3 +  Pushbutton Class: pbGrabar
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\filesave.bmp
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Con este botón me permite verificar para tres tipos de pantalla como
validar los datos, estos son:
1) Solo datafield, combobox,multiline
2) Solo childtablewindow
3) Ambos anteriores
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndTabla
.head 5 -  Number: nOpcion
.head 5 -  String: sTitulo
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If nOpcion=1
.head 7 +  If RevisarFormaLlena()
.head 8 +  If SalMessageBox("Desea Grabar "||sTitulo,"ADVERTENCIA",MB_YesNo)=IDYES
.head 9 -  Call SalSendMsg(hWndForm,MU_GRABAR,0,0)
.head 9 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 9 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 9 -  Return TRUE
.head 6 +  Else
.head 7 +  If nOpcion=2
.head 8 +  If RevisarTablas(hWndTabla)
.head 9 +  If SalMessageBox("Desea Aplicar los Cambios","CONFIRMACION",MB_YesNo)=IDYES
.head 10 -  Call SalSendMsg(hWndForm,MU_GRABAR,0,0)
.head 10 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 10 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 10 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If RevisarFormaLlena() and RevisarTablas(hWndTabla)
.head 9 +  If SalMessageBox("Desea Aplicar los Cambios","CONFIRMACION",MB_YesNo)=IDYES
.head 10 -  Call SalSendMsg(hWndForm,MU_GRABAR,0,0)
.head 10 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 10 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 10 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 3 +  Pushbutton Class: pbSalir
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\Logout.bmp
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Cierra una ventana ya sea si es Form ó Dialog
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalGetType( hWndForm )=TYPE_DialogBox
.head 7 -  Call SalEndDialog(hWndForm,TRUE)
.head 7 -  Call SalBringWindowToTop(hWndForm)
.head 6 +  Else
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 7 -  Call SalBringWindowToTop(hWndForm)
.head 3 -  ! los anteriores son botones mas graficos
.head 3 -  ! estos van a ser los pushbotton base y a continuacion para los FORM's
.head 3 +  ! Pushbutton Class: pbGrabar
.winattr
.head 4 -  Title: &Grabar
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.49"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: C:\SGH\icons\SAVE1.ICO
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.end
.head 4 -  Description: 
.head 4 +  Derived From 
.head 5 -  Class: pbBase
.head 4 -  Class Variables 
.head 4 +  Instance Variables 
.head 5 -  String: sMensaje
.head 4 -  Functions 
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 +  If RevisarFormaLlena()
.head 7 +  If SalMessageBox("Desea Grabar "||sMensaje,"ADVERTENCIA",MB_YesNo)=IDYES
.head 8 +  If SalSendMsg(hWndForm,MU_GRABAR,0,0)
.head 9 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 9 -  Return TRUE
.head 8 +  Else 
.head 9 -  Return FALSE
.head 3 -  ! este es para los combos de los FORM's
.head 3 +  Combo Box Class: cmbBaseCodigoFiltrado
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  2.071"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.104"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Clase generica usada para combo box  incluye ambos NUMERICOS Y CARACTER, esto se
hace inicializando el valor del nCaso de la siguiente forma
Este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER

Se debe de inicializar en el SAM_Create lo siguiente:
sTabla: el nombre de la tabla (AXL_DEPTOS)
sNombre: nombre del campo de la tabla de tipo string con el que deseo popular
	esa tabla (NOMBRE)
sCodigo: nombre del campo de la tabla de donde voy a extraer el valor del codigo (COD_DEPTO)

Los valores se almacenarán en, dependiendo de si son NUMEROS ó CARACTERES
nCodigo	NUMERICOS
sCodigos	CARACTER

NOTA: EL nCaso no es necesario inicializarlo cuando es numerico
.head 4 +  Derived From
.head 5 -  Class: cFlatComboBox
.head 4 +  Class Variables
.head 5 -  String: sComboActual
.head 5 -  Number: nTerp
.head 5 -  String: sTerp
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  !
.head 5 -  ! este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 5 -  !
.head 5 -  ! -------------Esto fue agregado en que caso de que se desee filtrar un campo entero
.head 5 -  String: sNombreFiltro
.head 5 -  Number: nValorFiltro
.head 4 +  Functions
.head 5 +  Function: Actualizar
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nCaso=1	! es numerico
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 +  Else ! es caracter
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  !
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro order by "||sNombre)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  ! On MU_ACTUALIZAR
.head 6 +  If nCaso=1	! es numerico
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 +  Else ! es caracter
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 -  !
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  !
.head 7 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 8 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 8 -  Call SalSetFocus(hWndItem)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  On SAM_Click
.head 6 -  ! aqui es para NUMERICOS
.head 6 +  If nCaso=1
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro and "||sNombre||"=:MyValue into :nTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set nCodigo=nTerp
.head 6 -  ! aqui es para CARACTER
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro and "||sNombre||"=:MyValue into :sTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set sCodigos=sTerp
.head 6 -  Call SalSendMsg(hWndItem,SAM_Validate,0,0)
.head 3 +  Combo Box Class: cmbBaseCodigoFiltradoChar
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  2.071"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.104"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Clase generica usada para combo box  incluye ambos NUMERICOS Y CARACTER, esto se
hace inicializando el valor del nCaso de la siguiente forma
Este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER

Se debe de inicializar en el SAM_Create lo siguiente:
sTabla: el nombre de la tabla (AXL_DEPTOS)
sNombre: nombre del campo de la tabla de tipo string con el que deseo popular
	esa tabla (NOMBRE)
sCodigo: nombre del campo de la tabla de donde voy a extraer el valor del codigo (COD_DEPTO)

Los valores se almacenarán en, dependiendo de si son NUMEROS ó CARACTERES
nCodigo	NUMERICOS
sCodigos	CARACTER

NOTA: EL nCaso no es necesario inicializarlo cuando es numerico
.head 4 +  Derived From
.head 5 -  Class: cFlatComboBox
.head 4 +  Class Variables
.head 5 -  String: sComboActual
.head 5 -  Number: nTerp
.head 5 -  String: sTerp
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  !
.head 5 -  ! este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 5 -  !
.head 5 -  ! -------------Esto fue agregado en que caso de que se desee filtrar un campo entero
.head 5 -  String: sNombreFiltro
.head 5 -  String: sValorFiltro
.head 4 +  Functions
.head 5 +  Function: Actualizar
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nCaso=1	! es numerico
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 +  Else ! es caracter
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  !
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla||" where "||sNombreFiltro||" = :sValorFiltro order by "||sNombre)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  ! On MU_ACTUALIZAR
.head 6 +  If nCaso=1	! es numerico
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 +  Else ! es caracter
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 -  !
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  !
.head 7 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 8 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 8 -  Call SalSetFocus(hWndItem)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  On SAM_Click
.head 6 -  ! aqui es para NUMERICOS
.head 6 +  If nCaso=1
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :sValorFiltro and "||sNombre||"=:MyValue into :nTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set nCodigo=nTerp
.head 6 -  ! aqui es para CARACTER
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :sValorFiltro and "||sNombre||"=:MyValue into :sTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set sCodigos=sTerp
.head 6 -  Call SalSendMsg(hWndItem,SAM_Validate,0,0)
.head 3 -  ! este es para los datafield
.head 3 +  Data Field Class: dfBase
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  2.271"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cFlatDataField
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 -  ! este es para los multiline
.head 3 +  Multiline Field Class: mlBase
.head 4 -  Data
.head 5 -  Maximum Data Length: 30000
.head 5 -  String Type: Long String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  5.686"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.036"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cFlatMultilineField
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 -  ! este es para los df de Numeros,fecha
.head 3 +  Data Field Class: dfNumero
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  0.788"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Class Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: dfBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Data Field Class: dfFecha
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  0.943"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Class Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Black
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Input Mask: 99/99/9999
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: dfBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 -  ! esto es para las columnas
.head 3 +  Column Class: clsNumero
.head 4 -  Title: numero
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.763"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: #0
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column Class: clsDatos
.head 4 -  Title: datos
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Left
.head 4 -  Width:  2.083"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column Class: clsLong
.head 4 -  Title: long
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 30000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  3.717"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Popup Edit
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column Class: clsFecha
.head 4 -  Title:
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: 99/99/9999
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column Class: clsCbCodigoFiltrado
.head 4 -  Title:
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description: esta es una columna tipo combo box, usada para todas las table window,
como sabemos no puede procesar el mensaje de SAM_Click, dado que es columna,
por lo que en el SAM_Validate, efectuó la valdación de las columnas,

La documentación completa de esta clase, puede leerse en esta misma libreria, en la
parte de combo box
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  Number: nTerp
.head 5 -  String: sComboActual
.head 5 -  String: sTerp
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  !
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 5 -  !
.head 5 -  ! -------------Esto fue agregado en que caso de que se desee filtrar un campo entero
.head 5 -  String: sNombreFiltro
.head 5 -  Number: nValorFiltro
.head 4 -  Functions
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro order by sNombre")
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On MU_ACTUALIZAR
.head 6 +  If nCaso=1	! es numerico
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:hWndItem")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 +  Else ! es caracter
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :hWndItem")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  !
.head 7 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 8 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 8 -  Call SalSetFocus(hWndItem)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  ! aqui es para NUMERICOS
.head 8 +  If nCaso=1
.head 9 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro and "||sNombre||"=:MyValue into :nTerp")
.head 9 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 9 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 9 -  Set nCodigo=nTerp
.head 8 -  ! aqui es para CARACTER
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro and "||sNombre||"=:MyValue into :sTerp")
.head 9 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 9 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 9 -  Set sCodigos=sTerp
.head 8 -  Return TRUE
.head 3 -  ! ESTO ES PARA LAS CHILD TABLE's
.head 3 +  Pushbutton Class: pbChBaseChiquito
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.629"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cFlatPushbutton
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: pbChAgregarChiquito
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\edit_add15.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pbChBaseChiquito
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndTabla
.head 5 -  Window Handle: hWndFila
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSetFocus(hWndTabla)
.head 6 -  Call SalTblSetFocusCell( hWndTabla, SalTblInsertRow( hWndTabla, TBL_MaxRow ), hWndFila, 0, 1 )
.head 6 -  Call SalStatusSetText(hWndForm,'			')
.head 3 +  Pushbutton Class: pbChBorrarChiquito
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\edit_remove15.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pbChBaseChiquito
.head 4 +  Class Variables
.head 5 -  Number: nFilaChild
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndFila
.head 5 -  Window Handle: hWndTabla
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalStatusSetText(hWndForm,'			')
.head 6 -  Call SalTblQueryFocus(  hWndTabla,nFilaChild,hWndFila)
.head 6 +  If SalTblQueryRowFlags( hWndTabla,nFilaChild,ROW_MarkDeleted)
.head 7 -  Call SalTblSetRowFlags( hWndTabla,nFilaChild, ROW_MarkDeleted,FALSE)
.head 6 +  Else
.head 7 +  If SalTblQueryRowFlags( hWndTabla,nFilaChild,ROW_New)
.head 8 -  Call SalTblDeleteRow( hWndTabla, nFilaChild, TBL_Adjust )
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags( hWndTabla,nFilaChild, ROW_MarkDeleted,TRUE)
.head 6 -  Call SalTblSetFocusCell( hWndTabla, nFilaChild, hWndFila, 0, 1 )
.head 3 +  Pushbutton Class: pbChBuscarChiquito
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F3
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\PBITEMS.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pbChBaseChiquito
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: pbBase
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cFlatPushbutton
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 -  ! Estas son para las formas estandares
.head 3 +  Form Window Class: frmSoloNombre
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Yes
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? No
.head 5 -  Initial State: Normal
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  6.825"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.146"
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 40
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Esta es un tipo de forma que sirve para trabajar con las tablas auxiliares
que solo contenga codigo y nombre, es decir para solo agregar los nombres
.head 4 -  Derived From
.head 4 +  Menu
.head 5 +  Popup Menu: Tablita
.head 6 -  Resource Id: 50175
.head 6 -  Enabled when:
.head 6 -  Status Text:
.head 6 -  Menu Item Name:
.head 6 +  Menu Item: (Inserta Fila)
.head 7 -  Resource Id: 57871
.head 7 -  Keyboard Accelerator: Ins
.head 7 -  Status Text:
.head 7 +  Menu Settings
.head 8 -  Enabled when:
.head 8 -  Checked when:
.head 7 +  Menu Actions
.head 8 -  Call SalSendMsg(pbAgregar,SAM_Click,0,0)
.head 7 -  Menu Item Name:
.head 6 +  Menu Item: (Marca para Borrar Fila)
.head 7 -  Resource Id: 50177
.head 7 -  Keyboard Accelerator: -
.head 7 -  Status Text:
.head 7 +  Menu Settings
.head 8 -  Enabled when:
.head 8 -  Checked when:
.head 7 +  Menu Actions
.head 8 -  Call SalSendMsg(pbBorrar,SAM_Click,0,0)
.head 7 -  Menu Item Name:
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: 0.677"
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 +  Contents
.head 6 +  ! Pushbutton: pb5
.winattr
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 24
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left: 4.088"
.head 8 -  Top:    0.073"
.head 8 -  Width:  0.8"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.5"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Keyboard Accelerator: (none)
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Picture File Name: C:\GUPTA\BITMAPS\PRINTER.ICO
.head 7 -  Picture Transparent Color: None
.head 7 -  Image Style: Single
.head 7 -  Text Color: Default
.head 7 -  Background Color: Default
.end
.head 7 +  Message Actions
.head 8 +  On SAM_Click
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  Call ArmarTabla()
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  ! If clsImpresora.Iniciare(DMORIENT_PORTRAIT,2800,3556)
.head 9 +  If ImprimirReporteSencillo(frmSoloNombre.sTitulos,"C:\\GUPTA\\PENAL\\REPORTES\\AXL_S.QRP",
			":n1,:s1","CODIGO,NOMBRE","select CODIGO,NOMBRE from AXL_TEMPORAL order by NOMBRE
			into :n1,:s1",frmSoloNombre.sObservaciones)
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  Return FALSE
.head 6 +  Pushbutton: pbAgregar
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 29
.head 7 -  Class: pbMas
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left: 0.188"
.head 8 -  Top:    0.073"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Enter
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set pbAgregar.nOpcionh=2
.head 9 -  Set pbAgregar.hWndFila=tbl1.colNombrer
.head 8 +  On SAM_Click
.head 9 -  Call SalTblSetFocusCell( hWndTabla, SalTblInsertRow( hWndTabla, TBL_MaxRow ), hWndFila, 0, 1 )
.head 9 -  Set tbl1.colCodigor=Identity(nNumeroTabla)
.head 9 -  Call SalStatusSetText(hWndForm,'                                                      ')
.head 6 +  Pushbutton: pbBorrar
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 30
.head 7 -  Class: pbMenos
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left: 1.388"
.head 8 -  Top:    0.073"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set pbBorrar.nOpcionh=2
.head 9 -  Set pbBorrar.hWndFila=tbl1.colNombrer
.head 6 +  Pushbutton: pbGrabar
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 34
.head 7 -  Class: pbGrabar
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left: 2.588"
.head 8 -  Top:    0.073"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set pbGrabar.nOpcion=2
.head 8 +  ! On SAM_Click
.head 9 +  If RevisarTablas(hWndTabla)
.head 10 +  If SalMessageBox("Desea Aplicar los Cambios","CONFIRMACION",MB_YesNo)=IDYES
.head 11 -  Call SalSendMsg(hWndForm,MU_GRABAR,0,0)
.head 11 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 11 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 11 -  Return TRUE
.head 6 +  Pushbutton: pbSalir
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 39
.head 7 -  Class: pbSalir
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left: 6.588"
.head 8 -  Top:    0.073"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 4 +  Contents
.head 5 +  Child Table: tbl1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 5
.head 6 -  Class: MyChildTable
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left: 0.488"
.head 8 -  Top:    0.156"
.head 8 -  Width:  6.9"
.head 8 -  Width Editable? Class Default
.head 8 -  Height: 3.333"
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  View: Class Default
.head 7 -  Allow Row Sizing? Class Default
.head 7 -  Lines Per Row: Class Default
.head 6 -  Memory Settings
.head 7 -  Maximum Rows in Memory: Class Default
.head 7 -  Discardable? Class Default
.head 6 +  Contents
.head 7 +  Column: colCodigor
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 25
.head 8 -  Class: clsNumero
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title:
.head 8 -  Visible? No
.head 8 -  Editable? No
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Class Default
.head 8 -  Justify: Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 -  Message Actions
.head 7 +  Column: colNombrer
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 26
.head 8 -  Class: clsDatos
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title:
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: 50
.head 8 -  Data Type: Class Default
.head 8 -  Justify: Class Default
.head 8 -  Width:  6.8"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Uppercase
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Validate
.head 10 -  Call SalStatusSetText( hWndForm,"Verificando Unicidad de nombre ...... Por Favor espere")
.head 10 -  Call SalWaitCursor(TRUE)
.head 10 +  If Validar_Unico_EnTablitas(hWndTabla,2,sMensajes_Otros)
.head 11 -  Call SalStatusSetText( hWndForm,"                                                                                             ")
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Return TRUE
.head 10 +  Else
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalStatusSetText( hWndForm,"                                                                                             ")
.head 11 -  Return FALSE
.head 6 -  Functions
.head 6 -  Window Variables
.head 6 +  Message Actions
.head 7 +  On SAM_CreateComplete
.head 8 -  Set pbAgregar.hWndTabla=tbl1
.head 8 -  Set pbBorrar.hWndTabla=tbl1
.head 8 -  Set pbGrabar.hWndTabla=tbl1
.head 8 -  Call SalTblSetColumnTitle( tbl1.colNombrer,sTitulos)
.head 4 +  Class Variables
.head 5 -  Window Handle: hWndColumna
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  String: sImprimir
.head 5 -  String: sTitulos
.head 5 -  String: sMensajes_Otros
.head 5 -  Number: nNumeroTabla
.head 5 -  Window Handle: hWndTabla
.head 4 +  Functions
.head 5 +  Function: ArmarTabla
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: s11
.head 7 -  String: sConsulta
.head 7 -  Number: n11
.head 6 +  Actions
.head 7 -  Set sConsulta="select "||sCodigo||",NOMBRE from "||sTabla||" into :n11,:s11"
.head 7 -  Call SqlImmediate("delete from AXL_TEMPORAL")
.head 7 -  Call SqlClearImmediate( )
.head 7 -  Call SqlPrepareAndExecute(hSql1,sConsulta)
.head 7 +  While SqlFetchNext(hSql1,nSiguiente)
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Call SqlImmediate("insert into AXL_TEMPORAL(CODIGO,NOMBRE) values(:n11,:s11)")
.head 8 -  Call SqlClearImmediate( )
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblPopulate(hWndTabla,hSql6,"select "||sCodigo||","||sNombre||" from "||sTabla||" 
order by NOMBRE",TBL_FillAll)
.head 6 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 6 -  Call SalSendMsg(hWndTabla,SAM_CreateComplete,0,0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On MU_GRABAR
.head 6 -  Call SalSetFocus(hWndTabla)
.head 6 -  ! !!!!!!!!!!!!!!!!!!
.head 6 -  Call SqlPrepare(hSql1,"insert into "||sTabla||"("||sCodigo||","||sNombre||")
		values(:hWndTabla.colCodigor,:hWndTabla.colNombrer)")
.head 6 -  Call SalTblDoInserts( hWndTabla,hSql1,TRUE)
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  ! !!!!!!!!!!!!!!!!!!
.head 6 -  Call SqlPrepare(hSql1,"update "||sTabla||" set "||sNombre||"=:hWndTabla.colNombrer
			where "||sCodigo||"=:hWndTabla.colCodigor")
.head 6 -  Call SalTblDoUpdates( hWndTabla,hSql1,TRUE)
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  ! !!!!!!!!!!!!!!!!!!
.head 6 -  Call SqlPrepare(hSql1,"delete from "||sTabla||" where "||sCodigo||"=:hWndTabla.colCodigor")
.head 6 -  Call SalTblDoDeletes( hWndTabla, hSql1, ROW_MarkDeleted )
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  ! !!!!!!!!!!!!!!!!!!
.head 6 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 5 +  On MU_ACTUALIZAR
.head 6 -  Call SalSendMsg(hWndForm,SAM_CreateComplete,0,0)
.head 5 +  On SAM_Destroy
.head 6 -  Call SalBringWindowToTop( hWndForm)
.head 3 +  List Box Class: clsList
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  3.288"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.813"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 4 +  Functions
.head 5 +  Function: Actualizar
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call SalListClear(MyValue)
.head 7 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Call SalWaitCursor(FALSE)
.head 5 +  Function: Leer_ListBox
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  ! Window Handle: lbGenerico
.head 7 -  String: sTablaVarias
.head 7 -  String: sTablaAxl
.head 7 -  String: sCodigoVarias
.head 7 -  String: sCodigoAxl
.head 7 -  Number: nUnicoValor
.head 7 -  String: sUnicoValor
.head 7 -  Receive Sql Handle: hSqlInsertar
.head 7 -  Number: nCaso
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nBuscando
.head 7 -  Number: nActual
.head 7 -  Number: nEntradas
.head 7 -  String: sBuscar
.head 7 -  String: sBuscar2
.head 7 -  Window Handle: lbGenerico
.head 6 +  Actions
.head 7 -  Set lbGenerico=hWndItem
.head 7 +  Select Case nCaso
.head 8 +  Case 1	! este es para el caso que sean Entero,Entero
.head 9 +  If not SqlPrepareAndExecute(hSqlInsertar,"select "||sCodigoAxl||" from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor into :nBuscando")
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 9 +  While SqlFetchNext(hSqlInsertar,nSiguiente)
.head 10 -  Call SqlPrepareAndExecute(hSqlInsertar,"commit")
.head 10 +  If not SqlImmediate("select NOMBRE  from "||sTablaAxl||" where "||sCodigoAxl||"=:nBuscando into :sBuscar")
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 10 -  Call SqlClearImmediate( )
.head 10 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 10 -  Set nActual=0
.head 10 +  While nActual<nEntradas
.head 11 +  If not SalListQueryState( lbGenerico, nActual )
.head 12 -  Set sBuscar2=SalListQueryTextX( lbGenerico,nActual)
.head 11 +  Else
.head 12 -  ! Call SalListSetSelect( lbGenerico, nActual)
.head 12 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 11 +  If sBuscar2=sBuscar
.head 12 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 11 -  Set nActual=nActual+1
.head 9 -  Return TRUE
.head 9 -  Break
.head 8 +  Case 2		! este es para el caso que sean Entero,Caracter
.head 9 +  If not SqlPrepareAndExecute(hSqlInsertar,"select "||sCodigoAxl||" from "||sTablaVarias||"
		where "||sCodigoVarias||"=:sUnicoValor into :nBuscando")
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 9 +  While SqlFetchNext(hSqlInsertar,nSiguiente)
.head 10 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 10 +  If not SqlImmediate("select NOMBRE  from "||sTablaAxl||" where "||sCodigoAxl||"=:nBuscando into :sBuscar")
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 10 -  Call SqlClearImmediate( )
.head 10 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 10 -  Set nActual=0
.head 10 +  While nActual<nEntradas
.head 11 +  If not SalListQueryState( lbGenerico, nActual )
.head 12 -  Set sBuscar2=SalListQueryTextX( lbGenerico,nActual)
.head 11 +  Else
.head 12 -  ! Call SalListSetSelect( lbGenerico, nActual)
.head 12 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 11 +  If sBuscar2=sBuscar
.head 12 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 11 -  Set nActual=nActual+1
.head 9 -  Return TRUE
.head 9 -  Break
.head 5 +  Function: Actualizar_ListBox
.head 6 -  Description: Actualiza una tabla que sea de tipo N-->N
	Ejemplo:
	
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  ! Window Handle: lbGenerico
.head 7 -  String: sTablaVarias
.head 7 -  String: sTablaAxl
.head 7 -  String: sCodigoVarias
.head 7 -  String: sCodigoAxl
.head 7 -  Number: nUnicoValor
.head 7 -  String: sUnicoValor
.head 7 -  Receive Sql Handle: hSqlInsertar
.head 7 -  Number: nCaso
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nActual
.head 7 -  Number: nEntradas
.head 7 -  Number: nCod
.head 7 -  String: sBuscar
.head 7 -  Window Handle: lbGenerico
.head 6 +  Actions
.head 7 -  Set lbGenerico=hWndItem
.head 7 +  Select Case nCaso
.head 8 +  Case 1	! este es para el caso que sean Entero,Entero
.head 9 +  If SqlExists("select * from "||sTablaVarias||" where "||sCodigoVarias||"=:nUnicoValor",bExists)
.head 10 -  Call SqlClearImmediate( )
.head 10 +  If bExists
.head 11 +  If not SqlPrepareAndExecute(hSqlInsertar,"delete from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor")
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 12 -  Return FALSE
.head 10 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 10 -  Set nActual=0
.head 10 +  While nActual<nEntradas
.head 11 +  If SalListQueryState( lbGenerico, nActual )
.head 12 -  Set sBuscar=SalListQueryTextX( lbGenerico,nActual)
.head 12 +  If not SqlImmediate("select "||sCodigoAxl||" from "||sTablaAxl||" where NOMBRE=:sBuscar into :nCod")
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 13 -  Return FALSE
.head 12 -  Call SqlClearImmediate( )
.head 12 +  If not SqlPrepareAndExecute(hSqlInsertar,"insert into "||sTablaVarias||
		"("||sCodigoVarias||","||sCodigoAxl||")"||
		"values(:nUnicoValor,:nCod)")
		
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call SalMessageBox("No se pudo grabar informacion en tabla de varias","ERROR",MB_Ok)
.head 13 -  Return FALSE
.head 12 -  Call SqlPrepareAndExecute(hSqlInsertar,"commit")
.head 11 -  Set nActual=nActual+1
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo sacar la información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 9 -  Break
.head 8 +  Case 2	! este es para el caso que sean Entero,Caracter
.head 9 +  If SqlExists("select * from "||sTablaVarias||" where "||sCodigoVarias||"=:sUnicoValor",bExists)
.head 10 -  Call SqlClearImmediate( )
.head 10 +  If bExists
.head 11 +  If not SqlPrepareAndExecute(hSqlInsertar,"delete from "||sTablaVarias||"
		where "||sCodigoVarias||"=:sUnicoValor")
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 12 -  Return FALSE
.head 11 -  Call SqlPrepareAndExecute(hSqlInsertar,"commit")
.head 10 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 10 -  Set nActual=0
.head 10 +  While nActual<nEntradas
.head 11 +  If SalListQueryState( lbGenerico, nActual )
.head 12 -  Set sBuscar=SalListQueryTextX( lbGenerico,nActual)
.head 12 +  If not SqlImmediate("select "||sCodigoAxl||" from "||sTablaAxl||" where NOMBRE=:sBuscar into :nCod")
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 13 -  Return FALSE
.head 12 -  Call SqlClearImmediate( )
.head 12 +  If not SqlPrepareAndExecute(hSqlInsertar,"insert into "||sTablaVarias||
		"("||sCodigoVarias||","||sCodigoAxl||")"||
		"values(:sUnicoValor,:nCod)")
		
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call SalMessageBox("No se pudo grabar informacion en tabla de varias","ERROR",MB_Ok)
.head 13 -  Return FALSE
.head 12 -  Call SqlPrepareAndExecute(hSqlInsertar,"commit")
.head 11 -  Set nActual=nActual+1
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo sacar la información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 9 -  Break
.head 5 +  Function: HaySeleccionadosListBox
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  ! Window Handle: lbGenerico
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nActual
.head 7 -  Number: nEntradas
.head 7 -  Window Handle: lbGenerico
.head 6 +  Actions
.head 7 -  Set lbGenerico=hWndItem
.head 7 -  Set nEntradas=SalListQueryCount(lbGenerico)
.head 7 -  Set nActual=0
.head 7 +  While nActual<nEntradas
.head 8 +  If SalListQueryState( lbGenerico, nActual )
.head 9 -  Return TRUE
.head 8 -  Set nActual=nActual+1
.head 7 -  Return FALSE
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Combo Box Class: cmbBaseCodigo
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  2.071"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.938"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Clase generica usada para combo box  incluye ambos NUMERICOS Y CARACTER, esto se
hace inicializando el valor del nCaso de la siguiente forma
Este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER

Se debe de inicializar en el SAM_Create lo siguiente:
sTabla: el nombre de la tabla (AXL_DEPTOS)
sNombre: nombre del campo de la tabla de tipo string con el que deseo popular
	esa tabla (NOMBRE)
sCodigo: nombre del campo de la tabla de donde voy a extraer el valor del codigo (COD_DEPTO)

Los valores se almacenarán en, dependiendo de si son NUMEROS ó CARACTERES
nCodigo	NUMERICOS
sCodigos	CARACTER

NOTA: EL nCaso no es necesario inicializarlo cuando es numerico
.head 4 +  Derived From
.head 5 -  Class: cFlatComboBox
.head 4 +  Class Variables
.head 5 -  String: sComboActual
.head 5 -  Number: nTerp
.head 5 -  String: sTerp
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  !
.head 5 -  ! este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 5 -  !
.head 4 +  Functions
.head 5 +  Function: Actualizar
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nCaso=1	! es numerico
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 +  Else ! es caracter
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  !
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla||" order by "||sNombre)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  ! On MU_ACTUALIZAR
.head 6 +  If nCaso=1	! es numerico
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 +  Else ! es caracter
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 -  !
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  !
.head 7 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 8 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 8 -  Call SalSetFocus(hWndItem)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  On SAM_Click
.head 6 -  ! aqui es para NUMERICOS
.head 6 +  If nCaso=1
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombre||"=:MyValue into :nTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set nCodigo=nTerp
.head 6 -  ! aqui es para CARACTER
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombre||"=:MyValue into :sTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set sCodigos=sTerp
.head 6 -  Call SalSendMsg(hWndItem,SAM_Validate,0,0)
.head 3 +  Column Class: clsCbCodigo
.head 4 -  Title:
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 400
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Left
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description: esta es una columna tipo combo box, usada para todas las table window,
como sabemos no puede procesar el mensaje de SAM_Click, dado que es columna,
por lo que en el SAM_Validate, efectuó la valdación de las columnas,

La documentación completa de esta clase, puede leerse en esta misma libreria, en la
parte de combo box
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  Number: nTerp
.head 5 -  String: sComboActual
.head 5 -  String: sTerp
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  !
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 4 -  Functions
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On MU_ACTUALIZAR
.head 6 +  If nCaso=1	! es numerico
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:hWndItem")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 +  Else ! es caracter
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :hWndItem")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  !
.head 7 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 8 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 8 -  Call SalSetFocus(hWndItem)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  ! aqui es para NUMERICOS
.head 8 +  If nCaso=1
.head 9 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombre||"=:MyValue into :nTerp")
.head 9 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 9 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 9 -  Set nCodigo=nTerp
.head 8 -  ! aqui es para CARACTER
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombre||"=:MyValue into :sTerp")
.head 9 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 9 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 9 -  Set sCodigos=sTerp
.head 8 -  Return TRUE
.head 3 +  Functional Class: lcConfiguration
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: LoadConfiguration
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalFileGetCurrentDirectory( strIniPath )
.head 7 -  Set strIniPath = strIniPath || "\\SGH.ini"
.head 7 -  Call SalUseRegistry( FALSE, "" )
.head 7 +  If SalGetProfileString( "Reportes", "Path", "", strRepPath, strIniPath ) = 0
.head 8 -  Call SalMessageBox( "Error al cargar las opciones de Reportes en el archivo " || strIniPath, "ERROR", MB_Ok )
.head 8 -  Call SalQuit()
.head 7 +  If SalGetProfileString( "Ciudad", "Nombre", "", strCiudad, strIniPath ) = 0
.head 8 -  Call SalMessageBox( "Error al cargar la opcion de Ciudad en el archivo " || strIniPath, "Advertencia", MB_Ok )
.head 8 -  Call SalQuit()
.head 7 +  If SalGetProfileString( "LabODBC", "DataSourceName", "", strODBCLab, strIniPath ) = 0
.head 8 -  Call SalMessageBox( "Error al cargar la opcion de LabODBC en el archivo " || strIniPath, "Advertencia", MB_Ok )
.head 8 -  Call SalQuit()
.head 7 +  If SalGetProfileString( "DataSource", "Name", "", sGlobalDB, strIniPath ) = 0
.head 8 -  Call SalMessageBox( "Error al cargar la opcion de DataSource en el archivo " || strIniPath, "Advertencia", MB_Ok )
.head 8 -  Call SalQuit()
.head 3 +  Child Table Class: MyChildTable
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  6.388"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.281"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Cambio hecho por Elvin Joel Deras Tábora
Tabla Generica que agrega la siguiente funcionalidad
	- Copiar al Clipboard
	- Exportar a Excel
	- Seleccionar todas las lineas(menu, CornerClick)
Utiliza el PopopMenu TableMenu
.head 4 -  Derived From
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_ContextMenu
.head 6 -  Call SalContextMenuSetPopup( hWndForm, 'TableMenu', 0 )
.head 5 +  On SAM_CornerClick
.head 6 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_Selected, TRUE ,0, 0)
.head 5 +  On SAM_Create
.head 6 -  ! ! Agregado el 14/Aug/2006 by Elvin Deras
.head 6 -  Call MTblSubClass ( hWndForm )
.head 6 -  Call MTblEnableMWheelScroll( hWndForm, TRUE )
.head 6 -  Call MTblEnableExtMsgs( hWndForm, TRUE )
.head 5 +  On MTM_ColHdrSepLBtnDblClk
.head 6 -  ! ! Agregado el 14/Aug/2006 by Elvin Deras
.head 6 -  Call MTblAutoSizeColumn( hWndForm, SalNumberToWindowHandle( wParam ), MTASC_ALLROWS | MTASC_SPLITROWS )
.head 3 +  General Window Class: cCrystalContainer
.head 4 -  Description: Abstract Crystal Reports Framework class.
Derive this class into a window class that can be  instantiated

Already has the fnClose on SAM_Destroy for cleanup purposes
Trap PAM_PEBeforePrint to manipulate report before it is printed or previewed

.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: niJobNo
.head 5 -  ! ! ! Override LOGON info
.head 5 -  Boolean: biLogonDefaultOverriden
.head 5 -  String: striServer
.head 5 -  String: striDBName
.head 5 -  String: striUser
.head 5 -  String: striPassword
.head 5 -  String: striReportFileName
.head 4 +  Functions
.head 5 +  Function: fnAddSortField
.head 6 -  Description: Appends a new sort field to the report.
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: parnFieldName
.head 7 -  Number: nSortOrder
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nNoOfFields
.head 7 -  Number: biOK
.head 6 +  Actions
.head 7 -  Set nNoOfFields = PEGetNSortFields( niJobNo )
.head 7 -  Set biOK =  PESetNthSortField( niJobNo, nNoOfFields, parnFieldName, nSortOrder )
.head 7 -  Return biOK
.head 5 +  Function: fnClose
.head 6 -  Description: Closes a report, the preview window (if any) and the engine.
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 6 +  Actions
.head 7 -  ! Only needed if OutputToWindow, but doesn't hurt
.head 7 -  Call PECloseWindow( niJobNo )
.head 7 -  Set bOk =  PEClosePrintJob( niJobNo )
.head 7 +  If bOk AND PECanCloseEngine () ! Pro Edition Function
.head 8 -  Call PECloseEngine( )
.head 8 -  Set niJobNo = NUMBER_Null
.head 7 -  Return bOk
.head 5 +  Function: fnDeleteAllSortFields
.head 6 -  Description: Deletes all sort fields.
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nNoOfFields
.head 7 -  Number: n
.head 6 +  Actions
.head 7 -  Set nNoOfFields = PEGetNSortFields( niJobNo )
.head 7 -  Set n = 0
.head 7 +  While ( n < nNoOfFields )
.head 8 -  Call PEDeleteNthSortField( niJobNo, n )
.head 8 -  Set n = n + 1
.head 5 +  Function: fnDisplayError
.head 6 -  Description: This function displays the error number and text if not biOK. This prevents the need to constantly
test the boolean and call this function if TRUE

 The default function is very useful during development

The Driver functions make a late bound call to this function so that a dervided class or object w/functions
can replace this development function
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nErrorCode
.head 7 -  Number: nTextHandle
.head 7 -  Number: nTextLen
.head 7 -  String: sError
.head 6 +  Actions
.head 7 -  Set nErrorCode = PEGetErrorCode ( niJobNo )
.head 7 +  If nErrorCode != PE_ERR_NOERROR
.head 8 -  Call PEGetErrorText ( niJobNo, nTextHandle, nTextLen )
.head 8 -  Call SalStrSetBufferLength ( sError, nTextLen )
.head 8 -  Call PEGetHandleString ( nTextHandle, sError, nTextLen )
.head 8 -  Call SalMessageBox ( 'An error has occurred while printing your report.

Error Number: ' || SalNumberToStrX (nErrorCode,0) || ' ' ||  sError, 'Crystal Report Error', MB_Ok | MB_IconExclamation )
.head 7 -  Return TRUE
.head 5 +  Function: fnExportPrintWindow
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Boolean: bToMail
.head 7 -  Boolean: bWaitUntilDone
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return PEExportPrintWindow ( niJobNo, bToMail, bWaitUntilDone )
.head 5 +  Function: fnGetFilter
.head 6 -  Description: Retrieves the filter of a report
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nTextHandle
.head 7 -  Number: nTextLen
.head 7 -  String: strFilter
.head 6 +  Actions
.head 7 -  Call PEGetSelectionFormula( niJobNo, nTextHandle, nTextLen )
.head 7 -  Call SalStrSetBufferLength( strFilter,nTextLen)
.head 7 -  Call PEGetHandleString( nTextHandle, strFilter, nTextLen )
.head 7 -  Return strFilter
.head 5 +  Function: fnGetNthReportParam
.head 6 -  Description: Set a specific Parameter
Note: Parameters are zero-based, so first is 0
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: npParamNumber
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: strName
.head 7 -  String: strPrompt
.head 7 -  String: strDefaultValue
.head 7 -  String: strCurrentValue
.head 7 -  Number: nDefaultValueSet
.head 7 -  Number: nCurrentValueSet
.head 7 -  Number: nParamType
.head 7 -  Number: nStructSize
.head 7 -  String: strDummy
.head 7 -  Number: biOK
.head 7 -  String: strReportName
.head 7 -  String: strEditMask
.head 7 -  Number: nNeedsCurrentValue
.head 7 -  Number: nMandatoryPrompt
.head 7 -  Number: nMinSize
.head 7 -  Number: nMaxSize
.head 7 -  Number: nIsHidden
.head 6 +  Actions
.head 7 -  Call SalStrSetBufferLength( strName,256)
.head 7 -  Call SalStrSetBufferLength( strPrompt, 256 )
.head 7 -  Call SalStrSetBufferLength( strDefaultValue, 256 )
.head 7 -  Call SalStrSetBufferLength( strCurrentValue, 256 )
.head 7 -  ! 1032 = struct size 4 Words and 4 Char 256
.head 7 -  Set nStructSize = 1032
.head 7 -  Set biOK = PEGetNthParameterField( niJobNo, npParamNumber, nStructSize, nParamType, nDefaultValueSet, nCurrentValueSet
, strName,strDummy, strPrompt, strDummy, strDefaultValue, strDummy, strCurrentValue, strDummy,
strReportName, nNeedsCurrentValue, nMandatoryPrompt, nMinSize, nMaxSize, strEditMask, strDummy, nIsHidden )
.head 7 -  Return strName
.head 5 +  Function: fnGetNthSortField
.head 6 -  Description: Retrieved the specified Sort Field

NOTE: Zero-based list! 0 = first sort field
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: npSortNumber
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nTextHandle
.head 7 -  Number: nTextLen
.head 7 -  Number: nSortOrder
.head 7 -  String: strSortName
.head 6 +  Actions
.head 7 -  Call PEGetNthSortField( niJobNo, npSortNumber, nTextHandle, nTextLen, nSortOrder )
.head 7 -  Call SalStrSetBufferLength( strSortName,nTextLen )
.head 7 -  Call PEGetHandleString( nTextHandle, strSortName, nTextLen )
.head 7 -  Return strSortName
.head 5 +  Function: fnGetReportTitle
.head 6 -  Description: Returns report preview window caption
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTitle
.head 7 -  Number: hTitle
.head 7 -  Number: nLen
.head 6 +  Actions
.head 7 -  Set sTitle = ''
.head 7 +  If PEGetReportTitle ( niJobNo, hTitle, nLen )
.head 8 -  Call SalStrSetBufferLength( sTitle, nLen)
.head 8 -  Call PEGetHandleString ( hTitle, sTitle, nLen )
.head 7 -  Return sTitle
.head 5 +  Function: fnGetSortFieldsCount
.head 6 -  Description: Returns the number of Fields that the current report is sorting on
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return PEGetNSortFields( niJobNo )
.head 5 +  Function: fnGetSQL
.head 6 -  Description: Returns SQL From Report specified by Job No.
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nTextHandle
.head 7 -  String: strSql
.head 7 -  Number: nTextLen
.head 6 +  Actions
.head 7 -  Call PEGetSQLQuery ( niJobNo, nTextHandle, nTextLen )
.head 7 -  Call SalStrSetBufferLength ( strSql, nTextLen )
.head 7 -  Call PEGetHandleString ( nTextHandle, strSql, nTextLen )
.head 7 -  Return strSql
.head 5 +  Function: fnGetWindowHandle
.head 6 -  Description: Returns window handle of preview window
.head 6 +  Returns
.head 7 -  Window Handle:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return PEGetWindowHandle ( niJobNo )
.head 5 +  Function: fnInit
.head 6 -  Description: Inits key class variables
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: biOK
.head 6 +  Actions
.head 7 -  ! Init instance variables
.head 7 -  Set niJobNo = NUMBER_Null
.head 5 +  Function: fnLogonServer
.head 6 -  Description: This function NOOPs unless LogonDefault has been overriden
Otherwise it calls PESetNthTableLogOnInfo to specify logon information
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: biOK
.head 7 -  Number: wSize
.head 6 +  Actions
.head 7 -  Set wSize = 514
.head 7 +  If biLogonDefaultOverriden
.head 8 -  Set biOK = PESetNthTableLogOnInfo( niJobNo, 0, wSize, striServer, striDBName, striUser, striPassword, TRUE )
.head 7 -  Return biOK
.head 5 +  Function: fnOpen
.head 6 -  Description: Opens a report file.
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: biOK
.head 6 +  Actions
.head 7 -  Set biOK = PEOpenEngine (  )
.head 7 +  If biOK
.head 8 -  Set niJobNo = PEOpenPrintJob( striReportFileName )
.head 8 +  If niJobNo = 0
.head 9 -  Set biOK = FALSE
.head 7 -  Return biOK
.head 5 +  Function: fnPrintPreview
.head 6 -  Description: Driver Function
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: strpFilePathAndName
.head 7 -  String: strpTitle
.head 7 -  Number: parnLeft
.head 7 -  Number: parnTop
.head 7 -  Number: parnWidth
.head 7 -  Number: parnHeigth
.head 7 -  Number: dwStyle
.head 7 -  Window Handle: hWnd
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: biOK
.head 6 +  Actions
.head 7 -  Call fnInit ( )
.head 7 -  Call fnSetReportFileName ( strpFilePathAndName )
.head 7 +  If IsRptOpen ( )
.head 8 -  ! Prepares to direct printed output to a window
.head 8 -  Set biOK = PEOutputToWindow ( niJobNo, strpTitle, parnLeft, parnTop, parnWidth, parnHeigth, dwStyle, hWnd )
.head 8 +  If biOK
.head 9 -  ! hook to change filters and sort orders, etc...
.head 9 -  ! Call SalSendMsg ( hWndItem, PAM_PEBeforePrint, 0, 0 )
.head 9 -  Call SalSendMsg ( hWndItem, SAM_ReportStart, 0, 0 )
.head 9 -  ! Do it
.head 9 -  Call ..fnStartPrintJob (  )
.head 7 -  Return fnDisplayError( )
.head 5 +  Function: fnRefresh
.head 6 -  Description: Closes and restarts current print job. Useful when changing sorts/filters etc...
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call PECloseWindow ( niJobNo )
.head 7 -  Return fnStartPrintJob ( )
.head 5 +  Function: fnSetFilter
.head 6 -  Description: Sets a filter for a report.
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: strpFilter
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: biOK
.head 6 +  Actions
.head 7 -  Call PESetSelectionFormula ( niJobNo, strpFilter )
.head 7 -  Set biOK = PECheckSelectionFormula ( niJobNo )
.head 7 -  Return biOK
.head 5 +  Function: fnSetLogonDefaults
.head 6 -  Description: Call if you need to Set the Reports Logon Parameters

NOTE: strpServer for ODBC is the Data Source Name (DSN) as configured using your ODBC adminstrator
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: strpServer
.head 7 -  String: strpDBName
.head 7 -  String: strpUser
.head 7 -  String: strpPassword
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set biLogonDefaultOverriden = TRUE
.head 7 -  Set striServer = strpServer
.head 7 -  Set striDBName = strpDBName
.head 7 -  Set striUser = strpUser
.head 7 -  Set striPassword = strpPassword
.head 7 -  ! Prepare strings to be sent to DLL functions
.head 7 -  Call SalStrSetBufferLength ( striServer, 128 )
.head 7 -  Call SalStrSetBufferLength ( striDBName, 128 )
.head 7 -  Call SalStrSetBufferLength ( striUser, 128 )
.head 7 -  Call SalStrSetBufferLength ( striPassword, 128 )
.head 5 +  Function: fnSetNthReportParam
.head 6 -  Description: Set a specific Parameter

.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: npParamNumber
.head 7 -  Number: npParamType
.head 7 -  String: strpParamValue
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: strName
.head 7 -  String: strPrompt
.head 7 -  String: strDefaultValue
.head 7 -  String: strEditMask
.head 7 -  String: strReportName
.head 7 -  String: strDummy
.head 7 -  Number: nDefaultValueSet
.head 7 -  Number: nCurrentValueSet
.head 7 -  Number: biOK
.head 7 -  Number: nNeedsCurrentValue
.head 7 -  Number: nIsLimited
.head 7 -  Number: nIsHidden
.head 7 -  Number: nMinSize
.head 7 -  Number: nMaxSize
.head 6 +  Actions
.head 7 -  Call SalStrSetBufferLength( strName,256 )
.head 7 -  Call SalStrSetBufferLength( strPrompt, 256 )
.head 7 -  Call SalStrSetBufferLength( strDefaultValue, 256 )
.head 7 -  Call SalStrSetBufferLength( strpParamValue, 256 )
.head 7 -  Call SalStrSetBufferLength( strEditMask, 256 )
.head 7 -  Set nDefaultValueSet = FALSE
.head 7 -  Set nCurrentValueSet = TRUE
.head 7 -  ! 1032 = struct size 4 Words and 4 Char 255
.head 7 -  Set biOK = PESetNthParameterField( niJobNo, npParamNumber, 1430, npParamType, nDefaultValueSet, nCurrentValueSet
, strName,strDummy, strPrompt, strDummy, strDefaultValue, strDummy,  strpParamValue, strDummy, strReportName, nNeedsCurrentValue, nIsLimited, nMinSize, nMaxSize, strEditMask,  strDummy, nIsHidden )
.head 7 -  Return biOK
.head 5 +  Function: fnSetNthSortField
.head 6 -  Description: Set a specific sort number's sort name and direction.
For direction, use the PE_SF_ASCENDING, PE_SF_DESCENDING constants
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: npSortNumber
.head 7 -  String: strpSortName
.head 7 -  Number: npSortDirection
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: biOK
.head 6 +  Actions
.head 7 -  Set biOK = PESetNthSortField ( niJobNo, npSortNumber, strpSortName, npSortDirection )
.head 7 -  Return biOK
.head 5 +  Function: fnSetNthStoredProcParam
.head 6 -  Description: Set a specific Parameter for stored procedures
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: npParamNumber
.head 7 -  String: strpParamValue
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: biOK
.head 6 +  Actions
.head 7 -  Set biOK = PESetNthParam( niJobNo, npParamNumber, strpParamValue )
.head 7 -  Return biOK
.head 5 +  Function: fnSetReportFileName
.head 6 -  Description: Specify the Crystal Reports RPT file.
Include drive and path
Don't forget to use double slashes since a single slash is an escape character
e.g. "C:\\CRW\\TEST.RPT"
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: strpReportFileName
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set striReportFileName = strpReportFileName
.head 5 +  Function: fnSetReportTitle
.head 6 -  Description: Sets report preview window title if this window has caption
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sTitle
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return PESetReportTitle ( niJobNo, sTitle )
.head 5 +  Function: fnSetSQL
.head 6 -  Description: Sets a SQL statement for a report.
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: strpSQL
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: biOK
.head 6 +  Actions
.head 7 -  Set biOK = PESetSQLQuery ( niJobNo, strpSQL )
.head 7 -  Return biOK
.head 5 +  Function: fnSetWindowOptions
.head 6 -  Description: Sets options for preview window
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nTree
.head 7 -  Number: nCanDrillDown
.head 7 -  Number: nNavigationButtons
.head 7 -  Number: nCancelButton
.head 7 -  Number: nPrintButton
.head 7 -  Number: nExportButton
.head 7 -  Number: nZoomControl
.head 7 -  Number: nCloseButton
.head 7 -  Number: nProgressControls
.head 7 -  Number: nSearchButton
.head 7 -  Number: nPrintSetupButton
.head 7 -  Number: nRefreshButton
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: wSize
.head 7 -  Number: biOk
.head 6 +  Actions
.head 7 -  Set wSize = 26
.head 7 -  Set biOk = PESetWindowOptions ( niJobNo, wSize, nTree, nCanDrillDown, nNavigationButtons, nCancelButton,
nPrintButton, nExportButton, nZoomControl, nCloseButton, nProgressControls, nSearchButton, nPrintSetupButton,
nRefreshButton )
.head 7 -  Return biOk
.head 5 +  Function: fnStartPrintJob
.head 6 -  Description: If report is open, start print job
This function is called from driver functions: fnPrint and fnPrintPreview
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: biOK
.head 6 +  Actions
.head 7 +  If IsRptOpen ( )
.head 8 +  If fnLogonServer ( )
.head 9 -  Set biOK = PEStartPrintJob ( niJobNo,TRUE )
.head 7 -  Return biOK
.head 5 +  Function: IsRptOpen
.head 6 -  Description: If JobNo is NULL, attempts to Open the report. If that fails, it returns FALSE
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: biOK
.head 6 +  Actions
.head 7 +  If niJobNo = NUMBER_Null
.head 8 -  Set biOK =  fnOpen ()
.head 7 +  Else
.head 8 -  Set biOK =  TRUE
.head 7 -  Return biOK
.head 5 +  Function: fnPrint
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: strpFilePathAndName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 6 +  Actions
.head 7 -  Call fnInit ()
.head 7 -  Call fnSetReportFileName (strpFilePathAndName)
.head 7 -  Set bOk = PEOutputToPrinter( niJobNo, 1 ) ! Assumes one copy. Create function to specify if desired
.head 7 -  ! hook to change filters and sort orders, etc...
.head 7 -  ! Call SalSendMsg (hWndItem, PAM_PEBeforePrint, 0,0)
.head 7 -  Call SalSendMsg ( hWndItem, SAM_ReportStart, 0, 0 )
.head 7 -  ! Do it
.head 7 -  Call fnStartPrintJob (  )
.head 7 -  Return ..fnDisplayError ()
.head 4 +  Message Actions
.head 5 +  On SAM_Destroy
.head 6 -  Call fnClose ( )
.head 3 +  Form Window Class: cCrystalFormWindow
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? Class Default
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cCrystalContainer
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndReport
.head 4 +  Functions
.head 5 +  Function: OnSize
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nXT
.head 7 -  Number: nYT
.head 7 -  Number: nXB
.head 7 -  Number: nYB
.head 6 +  Actions
.head 7 +  If hWndReport != hWndNULL and SalGetWindowState ( hWndReport ) != Window_Invalid
.head 8 -  Call GetClientRect ( hWndForm, nXT, nYT, nXB, nYB )
.head 8 -  Call SetWindowPos ( hWndReport, hWndNULL, nXT, nYT , nXB, nYB, SWP_NOZORDER | SWP_NOCOPYBITS )
.head 4 +  Message Actions
.head 5 +  On WM_SIZE
.head 6 -  Call OnSize ( )
.head 3 +  Functional Class: cParam
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: Type
.head 5 -  String: Value
.head 4 -  Functions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field: cQuickMLField
.head 3 -  Pushbutton: pbGrabar
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  ActiveX:
.head 3 -  Check Box:
.head 3 -  Child Table: cQuickTable
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cQuickGraph
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 1 +  Dialog Box: dlgLogin
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Entrada al Sistema
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left: 1.525"
.head 4 -  Top:    0.917"
.head 4 -  Width:  4.563"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.896"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: White
.head 2 -  Description: Standard Login screen.
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Usuario
.head 4 -  Resource Id: 4533
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.525"
.head 5 -  Top:    1.0"
.head 5 -  Width:  1.363"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUserId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFlatDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.975"
.head 6 -  Top:    0.979"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Clave
.head 4 -  Resource Id: 4534
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.5"
.head 5 -  Top:    1.271"
.head 5 -  Width:  1.388"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPassword
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFlatDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.975"
.head 6 -  Top:    1.25"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Invisible
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalStrUpperX( dfPassword)
.head 3 +  Pushbutton: pbAceptar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Aceptar
.head 4 -  Window Location and Size
.head 5 -  Left: 1.488"
.head 5 -  Top:    1.656"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\apply.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: White
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsNull ( dfUserId )
.head 7 -  Call SalMessageBox ('Introduzca el nombre del usuario', "ERROR",MB_Ok | MB_IconHand )
.head 7 -  Call SalSetFocus ( dfUserId )
.head 7 -  Return FALSE
.head 6 +  If SalIsNull ( dfPassword )
.head 7 -  Call SalMessageBox ('Introduzca la contrasena',"ERROR", MB_Ok | MB_IconHand )
.head 7 -  Call SalSetFocus ( dfPassword )
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Set SqlDatabase = dfDatabase
.head 6 -  Set SqlUser = 'sa'
.head 6 -  Set SqlPassword = 'asaber'
.head 6 -  ! Set SqlDatabase = dfDatabase
.head 6 -  ! Set SqlUser = dfUserId
.head 6 -  ! Set SqlPassword = dfPassword
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalStatusSetText ( hWndForm, 'Conectandose a la Base de Datos ==> ' || dfDatabase || '...' )
.head 6 +  If ConectarCursores(hSql1) and ConectarCursores(hSql2) and
ConectarCursores(hSql3) and ConectarCursores(hSql4) and
ConectarCursores(hSql5) and ConectarCursores(hSql6)
.head 7 +  If EsUsuario(dfUserId,dfPassword,nUsuario)
.head 8 -  Set bMeConecte=TRUE
.head 8 -  Set sNombreUsuario=dfUserId
.head 8 -  Call SqlGetParameter( hSql1, DBP_BRAND, nBaseEs,sVersion)
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Call SalEndDialog( hWndForm, TRUE )
.head 7 +  Else
.head 8 -  Call SalMessageBox("No existe tal Usuario","ERROR",MB_Ok)
.head 8 -  Call SalWaitCursor( FALSE )
.head 3 +  Pushbutton: pbCancelar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cancelar
.head 4 -  Window Location and Size
.head 5 -  Left: 2.388"
.head 5 -  Top:    1.656"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\SGH\icons\cancel.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: 3D Highlight Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 -  Background Text: &Database:
.head 4 -  Resource Id: 4535
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.829"
.head 5 -  Top:    0.512"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDatabase
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.986"
.head 6 -  Top:    0.488"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfDatabase=sDatabaseMandan
.head 3 -  Frame
.head 4 -  Resource Id: 39373
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top:    0.073"
.head 5 -  Width:  4.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 8
.head 4 -  Border Color: Dark Green
.head 4 -  Background Color: White
.head 3 -  Line
.head 4 -  Resource Id: 59057
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.388"
.head 5 -  Begin Y:  1.573"
.head 5 -  End X:  4.188"
.head 5 -  End Y:  1.573"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Dark Green
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.388"
.head 5 -  Top:    0.24"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: C:\SGH\icons\LOGO_FINAL_BETESDA_S.bmp
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sDatabaseMandan
.head 2 +  Window Variables
.head 3 -  String: sVersion
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalSetFocus(dfUserId)
.head 4 -  Set bMeConecte=0
.head 3 +  On SAM_Help
.head 4 -  Call SalWinHelp( hWndForm,'c:\\centura\\chsa\\ayuda\\contrato.hlp',
	HELP_Key,0,'login' )
.head 1 +  Form Window: frmImprimir
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ventana de Reportes
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: 0.0"
.head 4 -  Top:    0.75"
.head 4 -  Width:  7.125"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.563"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: System Text Color
.head 3 -  Background Color: System Window Color
.head 2 -  Description: la funcion para imprimir debe recibir lo que se explica aqui: 
1) el título del reporte
2) el nombre del reporte(*.qrp) 
3) el nombre de las bind variables :s1,:n1
4) el nombre de los campos select nombre,edad ,...
5) el comando a ejecutar (SELECT)
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: &Reporte
.head 4 -  Resource Id: 4537
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Primera Página
.head 5 -  Resource Id: 4538
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdFirstPage)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Ultima página
.head 5 -  Resource Id: 4539
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdLastPage)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Siguiente página
.head 5 -  Resource Id: 4540
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdNextPage)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Página &Anterior
.head 5 -  Resource Id: 4541
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdPrevPage)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Ir a página...
.head 5 -  Resource Id: 4542
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdGoToPage)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Cerrar Reporte
.head 5 -  Resource Id: 4543
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportClose(hWndForm)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Menu Item Name:
.head 3 +  Popup Menu: &Impresión
.head 4 -  Resource Id: 4544
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Imprimir
.head 5 -  Resource Id: 4545
.head 5 -  Keyboard Accelerator: Ctrl+P
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdPrint)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Configurar impresora
.head 5 -  Resource Id: 4546
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdPrinterSetup)
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.49"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 7.188"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 -  Contents
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sTituloListado	
.head 3 -  String: sReporte		
.head 3 -  String: sVarsEnlace	
.head 3 -  String: sVarsEntrada	
.head 3 -  String: sCmdSelect	
.head 3 -  String: sObservaciones
.head 3 -  Boolean: bPrint
.head 2 +  Window Variables
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 3 -  String: s5
.head 3 -  String: s6
.head 3 -  String: s7
.head 3 -  String: s8
.head 3 -  String: s9
.head 3 -  String: s10
.head 3 -  String: s11
.head 3 -  String: s12
.head 3 -  String: s13
.head 3 -  String: s14
.head 3 -  String: s15
.head 3 -  String: s16
.head 3 -  String: s17
.head 3 -  String: s18
.head 3 -  String: s19
.head 3 -  String: s20
.head 3 -  String: s21
.head 3 -  !
.head 3 -  Number: n1
.head 3 -  Number: n2
.head 3 -  Number: n3
.head 3 -  Number: n4
.head 3 -  Number: n5
.head 3 -  Number: n6
.head 3 -  Number: n7
.head 3 -  Number: n8
.head 3 -  Number: n9
.head 3 -  Number: n10
.head 3 -  Number: n11
.head 3 -  Number: n12
.head 3 -  Number: n13
.head 3 -  Number: n14
.head 3 -  Number: n15
.head 3 -  Number: n16
.head 3 -  Number: n17
.head 3 -  Number: n18
.head 3 -  Number: n19
.head 3 -  Number: n20
.head 3 -  Number: n21
.head 3 -  Number: n22
.head 3 -  Number: n23
.head 3 -  Number: n24
.head 3 -  Number: n25
.head 3 -  Number: n26
.head 3 -  Number: n27
.head 3 -  Number: n28
.head 3 -  Number: n29
.head 3 -  Number: n30
.head 3 -  Number: n31
.head 3 -  Number: n32
.head 3 -  Number: n33
.head 3 -  Number: n34
.head 3 -  Number: n35
.head 3 -  Number: n36
.head 3 -  Number: n37
.head 3 -  Number: n38
.head 3 -  Number: n39
.head 3 -  Number: n40
.head 3 -  Number: n41
.head 3 -  Number: n42
.head 3 -  Number: n43
.head 3 -  Number: n44
.head 3 -  Number: n45
.head 3 -  Number: n46
.head 3 -  Number: n47
.head 3 -  Number: n48
.head 3 -  Number: n49
.head 3 -  Number: n50
.head 3 -  Number: n51
.head 3 -  Number: n52
.head 3 -  Number: n53
.head 3 -  Number: n54
.head 3 -  Number: n55
.head 3 -  Number: n56
.head 3 -  Number: n57
.head 3 -  Number: n58
.head 3 -  Number: n59
.head 3 -  Number: n60
.head 3 -  !
.head 3 -  Date/Time: dt1
.head 3 -  Date/Time: dt2
.head 3 -  Date/Time: dt3
.head 3 -  Date/Time: dt4
.head 3 -  Date/Time: dt5
.head 3 -  Date/Time: dt6
.head 3 -  Date/Time: dt7
.head 3 -  !
.head 3 -  Long String: ls1
.head 3 -  Long String: ls2
.head 3 -  Long String: ls3
.head 3 -  Long String: ls4
.head 3 -  Long String: ls5
.head 3 -  Long String: ls6
.head 3 -  !
.head 3 -  Number: nError
.head 3 -  Boolean: bBien
.head 3 -  Sql Handle: hSqlReport
.head 3 -  Window Handle: hWndReporte
.head 3 -  !
.head 3 -  String: sDispositivo
.head 3 -  String: sDriver
.head 3 -  String: sPuerto
.head 3 -  !
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SqlConnect( hSqlReport )
.head 4 -  ! Call SalMessageBox(sVarsEnlace,sVarsEnlace,MB_Ok)
.head 4 -  ! Call SalMessageBox(sVarsEntrada,sVarsEntrada,MB_Ok)
.head 4 -  ! Call SqlSetParameter( hSqlReport, DBP_PRESERVE, TRUE, '' )
.head 4 -  ! Call SqlSetIsolationLevel( hSqlReport, 'RO' )
.head 4 -  ! Call SqlSetResultSet( hSqlReport, TRUE )
.head 4 -  Set bBien=TRUE
.head 4 -  !
.head 4 -  ! aqui estoy haciendo la pantalla que despliega el reporte en modo previo, y guardo en una variable de tipo
handle, el "handle" de este reporte, para luego utilizar al:
1) Utilizarlo al momento de querer inicializar cualquier variable que envio al reporte
2) Utilizarlo en la funcion de SalReportDlgOptions
.head 4 -  !
.head 4 +  If bPrint
.head 5 -  !
.head 5 -  Call SalReportPrint( frmImprimir, sReporte, sVarsEnlace, sVarsEntrada, 1, RPT_PrintAll, 0, 0, nError )
.head 4 +  Else
.head 5 -  !
.head 5 -  Set hWndReporte=SalReportView( frmImprimir,frmImprimir, sReporte,sVarsEnlace, sVarsEntrada, nError )
.head 4 -  !
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  !
.head 4 -  ! ahora proceso los diferentes errores que me retorna en el nError
.head 4 -  !
.head 4 +  If nError = RPT_ErrFileOpen
.head 5 -  Call SalMessageBox( 'No se pudo encontrar la plantilla: ' ||sReporte, sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 +  If nError = RPT_ErrMaxRpts
.head 5 -  Call SalMessageBox( 'El número de reportes ha llegado al máximo!  ', sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 +  If nError = RPT_ErrRptOpen
.head 5 -  Call SalMessageBox( 'El reporte no se pudo abrir para impresión.', sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 +  If nError = RPT_ErrRptWindow
.head 5 -  Call SalMessageBox( 'No se pudo abrir la ventana de reportes. ', sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 -  !
.head 4 -  ! si hubo algún de estos errores entonces no se podrá imprimir nada, por lo que termino
.head 4 -  !
.head 4 +  If NOT bBien
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 3 +  On SAM_ReportStart
.head 4 -  !
.head 4 -  ! aqui estoy obteniendo el handle de esa ventana, para luego utilizarlo al momento de querer inicializar
cualquier variable que envio al reporte
.head 4 -  !
.head 4 -  !
.head 4 -  ! aqui estoy inicializando las opciones de la pantalla que aparecerá al momento de la impresion
.head 4 -  !
.head 4 -  Call SalReportDlgOptions( hWndReporte,sTituloListado, sReporte, 'Se está imprimiendo...',sTituloListado )
.head 4 -  Call SalPrtSetup( sDispositivo, sDriver, sPuerto, FALSE )
.head 3 +  On SAM_ReportFetchInit
.head 4 -  Call SalReportSetStringVar( hWndReporte, 'sTitulo', sTituloListado )
.head 4 -  Call SalReportSetStringVar( hWndReporte, 'sObservaciones', sObservaciones )
.head 4 -  ! ROGGER: Agregue esta linea para no bloquear por reportes algunas otras pantallas
.head 4 -  Call SqlPrepareAndExecute(hSqlReport,"set transaction isolation level 0")
.head 4 +  If NOT SqlPrepare( hSqlReport, sCmdSelect )
.head 5 -  Return FALSE
.head 4 +  Else
.head 5 +  If NOT SqlExecute( hSqlReport )
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  Return TRUE
.head 3 +  On SAM_ReportFetchNext
.head 4 +  If SqlFetchNext( hSqlReport, nSiguiente )
.head 5 -  Return TRUE
.head 4 +  Else
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_Destroy
.head 4 -  ! ROGGER: Restaurar el Isolation level a 1, aunque no es necesario ya que se desconectara
.head 4 -  Call SqlPrepareAndExecute(hSqlReport,"set transaction isolation level 1")
.head 4 -  Call SqlDisconnect( hSqlReport )
.head 4 -  Call SalBringWindowToTop( hWndForm )
.head 1 +  Form Window: frmUsuarios
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Mantenimiento de Nuevos Usuarios
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.1"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.417"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: Tablita
.head 4 -  Resource Id: 31747
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: (Inserta Fila)
.head 5 -  Resource Id: 31748
.head 5 -  Keyboard Accelerator: Ins
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(pbAgregar,SAM_Click,0,0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: (Marca para Borrar Fila)
.head 5 -  Resource Id: 31749
.head 5 -  Keyboard Accelerator: -
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(pbBorrar,SAM_Click,0,0)
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.656"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Charcoal
.head 3 +  Contents
.head 4 +  ! pbMas: pb2
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMas
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.688"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: C:\SGH\icons\ICONS\PLUS.ICO
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set pb2.hWndTabla=tbl1
.head 7 -  Set pb2.hWndFila=tbl1.colUsuario
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 7 -  Set tbl1.colCodUsuario=Identity(1)
.head 4 +  ! pbMenos: pb6
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMenos
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.488"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F3
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: C:\SGH\icons\ICONS\MINUS.ICO
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set pb6.hWndTabla=tbl1
.head 4 +  Pushbutton: pb4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbGrabar
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.088"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pb4.nOpcion=2
.head 7 -  Set pb4.hWndTabla=tbl1
.head 4 +  Pushbutton: pb7
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 6.988"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MyChildTable
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.688"
.head 6 -  Top:    0.406"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCodUsuario
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On MU_REVISAR
.head 8 -  Return TRUE
.head 5 +  Column: colUsuario
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nombre Usuario
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 8
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.575"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call SalTblQueryFocus( tbl1,nFila,tbl1.colUsuario )
.head 8 +  If NOT RevisarUsuarios(nFila,tbl1.colUsuario)
.head 9 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 5 +  Column: colContrasena
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Contrasena
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 8
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.663"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_Validate
.head 8 +  If tbl1.colContrasena!=tbl1.colReintento
.head 9 -  Call SalMessageBox("La verificacion y la contraseña deben ser iguales","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 +  Else 
.head 9 -  Return TRUE
.head 5 +  Column: colReintento
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Verificacion de Contrasena
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.263"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_Validate
.head 8 +  If tbl1.colContrasena!=tbl1.colReintento
.head 9 -  Call SalMessageBox("La verificacion y la contraseña deben ser iguales","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 +  Else 
.head 9 -  Return TRUE
.head 7 +  On MU_REVISAR
.head 8 -  Return TRUE
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbAgregar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChAgregarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top:    0.396"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbAgregar.hWndFila=tbl1.colUsuario
.head 6 -  Set pbAgregar.hWndTabla=tbl1
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 6 -  ! Call SalTblQueryFocus(tbl1,nFila,tbl1.colUsuario)
.head 6 -  ! Call SalTblSetContext(tbl1,nFila)
.head 6 -  Set tbl1.colCodUsuario=Identity(1)
.head 3 +  Pushbutton: pbBorrar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChBorrarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top:    0.729"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbBorrar.hWndFila=tbl1.colUsuario
.head 6 -  Set pbBorrar.hWndTabla=tbl1
.head 2 +  Functions
.head 3 +  Function: RevisarUsuarios
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nFila
.head 5 -  String: sActual
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFilita
.head 4 +  Actions
.head 5 -  Set nFilita=-1
.head 5 +  While SalTblFindNextRow(tbl1,nFilita,0,0)
.head 6 -  Call SalTblSetContext( tbl1,nFilita)
.head 6 +  Select Case nBaseEs
.head 7 +  Case 1
.head 8 +  If tbl1.colUsuario='SYSADM'
.head 9 -  Call SalMessageBox("Nombre de Usuario no puede ser el mismo que el del Administrador","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 -  Break
.head 7 +  Case 31
.head 8 +  If tbl1.colUsuario='sa' or tbl1.colUsuario='SA'
.head 9 -  Call SalMessageBox("Nombre de Usuario no puede ser el mismo que el del Administrador","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 -  Break
.head 6 +  If nFilita!=nFila
.head 7 +  If tbl1.colUsuario=sActual
.head 8 -  Call SalMessageBox("Nombre de Usuario ya existe, debe de introducir otro nombre","ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sInsert
.head 3 -  Sql Handle: hSqlCambiar
.head 3 -  String: sUpdate
.head 3 -  String: sDelete
.head 3 -  String: sSelect
.head 3 -  String: sDba
.head 3 -  Number: nFila
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sInsert="insert into USUARIOS(COD_USU,NOMBRE,CONTRASE)
	values(:tbl1.colCodUsuario,:tbl1.colUsuario,:tbl1.colContrasena)"
.head 4 -  Set sUpdate="update USUARIOS	set	NOMBRE=:tbl1.colUsuario,
					CONTRASE=:tbl1.colContrasena
				where	COD_USU=:tbl1.colCodUsuario"
.head 4 -  Set sDelete="delete from  USUARIOS where COD_USU=:tbl1.colCodUsuario"
.head 4 -  Set sSelect="select COD_USU,NOMBRE,CONTRASE,CONTRASE
		from	USUARIOS
		where	NOMBRE<> 'sa' and nombre <> 'sysadm'"
.head 4 +  ! Select Case nBaseEs
.head 5 +  Case 31
.head 6 -  Set sSelect=sSelect||"sa'"
.head 6 -  Break 
.head 5 +  Case 1
.head 6 -  Set sSelect=sSelect||" 'SYSADM'"
.head 6 -  Break 
.head 3 +  On MU_GRABAR
.head 4 -  !
.head 4 -  Call SqlPrepare( hSql1,sDelete )
.head 4 -  Call SalTblDoDeletes( tbl1, hSql1, ROW_MarkDeleted )
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SqlPrepare( hSql1,sInsert )
.head 4 -  Call SalTblDoInserts( tbl1, hSql1, TRUE )
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SqlPrepare( hSql1,sUpdate )
.head 4 -  Call SalTblDoUpdates( tbl1, hSql1, TRUE )
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  !
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 3 +  On MU_ACTUALIZAR
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  !
.head 4 -  Call SalTblPopulate(tbl1,hSql1,sSelect,TBL_FillAll)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Dialog Box: dlgError
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ventana de Captura de Mensajes de Errores
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left: 0.0"
.head 4 -  Top:    0.031"
.head 4 -  Width:  7.963"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.31"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.75"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbGrabarArchivo
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: &Copiar a Archivo
.head 5 -  Window Location and Size
.head 6 -  Left: 0.283"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: C:\SGH\icons\Save.ico
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbGrabarPorta
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Copiar a &Portapapeles
.head 5 -  Window Location and Size
.head 6 -  Left: 1.983"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: C:\SGH\icons\Checklis.ico
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 6.488"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 -  Background Text: Número
.head 4 -  Resource Id: 30152
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top:    0.345"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfError
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.588"
.head 6 -  Top:    0.321"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Descripción
.head 4 -  Resource Id: 30153
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top:    0.762"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Error
.head 4 -  Resource Id: 30154
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top:    0.073"
.head 5 -  Width:  7.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlDescripcion
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30000
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 1.588"
.head 6 -  Top:    0.823"
.head 6 -  Width:  6.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Razon
.head 4 -  Resource Id: 30155
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.45"
.head 5 -  Top:    1.952"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlRazon
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30000
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 1.75"
.head 6 -  Top:    1.929"
.head 6 -  Width:  7.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.976"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Por favor anote el número y descripción del error e informe al administrador
.head 4 -  Resource Id: 30156
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top:    2.677"
.head 5 -  Width:  7.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nError
.head 3 -  String: sCadena
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set dfError=nError
.head 4 -  Set mlDescripcion=sCadena
.head 1 +  Form Window: frmCrystalReport
.head 2 -  Class: cCrystalFormWindow
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Report preview
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: 1.75"
.head 4 -  Top:    0.458"
.head 4 -  Width:  8.95"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.594"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Arial
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.75"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbExport
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Export
.head 5 -  Window Location and Size
.head 6 -  Left: 0.09"
.head 6 -  Top:    0.075"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.65"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: C:\SGH\icons\Document Forward.bmp
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call frmCrystalReport.fnExportPrintWindow( FALSE, TRUE )
.head 2 -  Contents
.head 2 +  Functions
.head 3 +  Function: SetParameters
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  : RptParams[*]
.head 6 -  Class: cParam
.head 5 -  String: StProcParams[*]
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: nEnd
.head 4 +  Actions
.head 5 +  If Not SalArrayIsEmpty( RptParams )
.head 6 -  Set i = 0
.head 6 -  Call SalArrayGetUpperBound( RptParams, 1, nEnd )
.head 6 +  While i <= nEnd
.head 7 -  Call fnSetNthReportParam ( i, RptParams[i].Type, RptParams[i].Value )
.head 7 -  Set i = i + 1
.head 5 +  If Not SalArrayIsEmpty( StProcParams )
.head 6 -  Set i = 0
.head 6 -  Call SalArrayGetUpperBound( StProcParams, 1, nEnd )
.head 6 +  While i <= nEnd
.head 7 -  Call fnSetNthStoredProcParam ( i, StProcParams[i] )
.head 7 -  Set i = i + 1
.head 2 +  Window Parameters
.head 3 -  String: strRepTitle
.head 3 -  String: strPathAndFile
.head 3 -  : RptParams[*]
.head 4 -  Class: cParam
.head 3 -  String: StProcParams[*]
.head 2 +  Window Variables
.head 3 -  Number: nEnd
.head 3 -  Number: nXT
.head 3 -  Number: nYT
.head 3 -  Number: nXB
.head 3 -  Number: nYB
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  !
.head 4 -  Call GetClientRect ( hWndForm, nXT, nYT, nXB, nYB )
.head 4 -  Call fnSetLogonDefaults (SQLInitialDB , SqlDatabase, SqlUser, SqlPassword )
.head 4 -  Call fnPrintPreview ( strPathAndFile, strRepTitle,  nXT, nYT, nXB, nYB, WS_CLIPCHILDREN | WS_CLIPSIBLINGS | WS_BORDER, hWndItem )
.head 4 -  Call fnSetWindowOptions ( FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, TRUE )
.head 4 -  Call fnRefresh ( )
.head 4 -  Set hWndReport = fnGetWindowHandle ( )
.head 4 -  Call frmCrystalReport.fnSetReportTitle( strRepTitle )
.head 4 -  Call SalSetWindowText ( hWndForm, 'Report preview - [ ' || fnGetReportTitle ( ) || ' ]')
.head 4 -  Call OnSize ( )
.head 4 -  !
.head 4 -  ! Call fnPrint( strPathAndFile)
.head 3 +  On SAM_ReportStart
.head 4 -  Call SetParameters( RptParams, StProcParams )
.head 1 +  Form Window: frmCrystalRptPrint
.head 2 -  Class: cCrystalFormWindow
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Preview
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: 1.75"
.head 4 -  Top:    0.458"
.head 4 -  Width:  7.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 1.988"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Arial
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.438"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 -  Contents
.head 2 +  Functions
.head 3 +  Function: SetParameters
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  : RptParams[*]
.head 6 -  Class: cParam
.head 5 -  String: StProcParams[*]
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: nEnd
.head 4 +  Actions
.head 5 +  If Not SalArrayIsEmpty( RptParams )
.head 6 -  Set i = 0
.head 6 -  Call SalArrayGetUpperBound( RptParams, 1, nEnd )
.head 6 +  While i <= nEnd
.head 7 -  Call fnSetNthReportParam ( i, RptParams[i].Type, RptParams[i].Value )
.head 7 -  Set i = i + 1
.head 5 +  If Not SalArrayIsEmpty( StProcParams )
.head 6 -  Set i = 0
.head 6 -  Call SalArrayGetUpperBound( StProcParams, 1, nEnd )
.head 6 +  While i <= nEnd
.head 7 -  Call fnSetNthStoredProcParam ( i, StProcParams[i] )
.head 7 -  Set i = i + 1
.head 2 +  Window Parameters
.head 3 -  String: strRepTitle
.head 3 -  String: strPathAndFile
.head 3 -  : RptParams[*]
.head 4 -  Class: cParam
.head 3 -  String: StProcParams[*]
.head 2 +  Window Variables
.head 3 -  Number: nEnd
.head 3 -  Number: nXT
.head 3 -  Number: nYT
.head 3 -  Number: nXB
.head 3 -  Number: nYB
.head 3 -  String: sDevice
.head 3 -  String: sDriver
.head 3 -  String: sPort
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  !
.head 4 -  Call GetClientRect ( hWndForm, nXT, nYT, nXB, nYB )
.head 4 -  Call fnSetLogonDefaults (SQLInitialDB , SqlDatabase, SqlUser, SqlPassword )
.head 4 -  !
.head 4 -  Call fnInit ( )
.head 4 -  Call fnSetReportFileName ( strPathAndFile )
.head 4 +  If IsRptOpen ( )
.head 5 -  ! Prepares to direct printed output to a window
.head 5 -  Call PEOutputToPrinter( niJobNo, 0 )
.head 5 -  ! hook to change filters and sort orders, etc...
.head 5 -  ! Call SalSendMsg ( hWndItem, PAM_PEBeforePrint, 0, 0 )
.head 5 -  Call SalSendMsg ( hWndItem, SAM_ReportStart, 0, 0 )
.head 5 -  ! Do it
.head 5 -  Call fnStartPrintJob (  )
.head 4 -  !
.head 4 -  Call fnSetWindowOptions ( FALSE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, TRUE )
.head 4 -  Call fnRefresh ( )
.head 4 -  Set hWndReport = fnGetWindowHandle ( )
.head 4 -  Call frmCrystalRptPrint.fnSetReportTitle( strRepTitle )
.head 4 -  Call SalSetWindowText ( hWndForm, 'Printing - [ ' || fnGetReportTitle ( ) || ' ]')
.head 4 -  Call OnSize ( )
.head 4 -  !
.head 3 +  On SAM_ReportStart
.head 4 -  ! Call SalPrtSetup( sDevice, sDriver, sPort, FALSE )
.head 4 -  Call SetParameters( RptParams, StProcParams )
