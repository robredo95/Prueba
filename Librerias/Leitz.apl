.head 0 +  Application Description: Librería general que contiene código reutilizable para:
1) Combo box,multiline,datafield,childtablewindow
2) Botones para agregar,buscar,eliminar,grabar
3) Declaración de variables globales como cursores,usuarios,
fetch,imprimir
4) Funciones globales para: Identity,Limpiar pantalla,contar filas
en table window,des/ha bilitar pantallas, manejo de errores	
.head 1 -  Outline Version - 4.0.27
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000004000000 FFFF01000D004347 5458566965775374 6174650400020000
0020: 0000000000D60000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE2FFFFFF160000 0016000000200200 000D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D0400000007436C 61737365730F6C63
0080: 436F6E6669677572 6174696F6E094675 6E6374696F6E7311 4C6F6164436F6E66
00A0: 696775726174696F 6E000001800200FF FFFFFF0000000000 0000002C00000000
00C0: 00000001000000FF FFFFFFFFFFFFFFFC FFFFFFE9FFFFFF2C 0000002C00000036
00E0: 0200002301000000 0000000000000003 0000000F4170706C 69636174696F6E49
0100: 74656D07436C6173 73657307636C734C 6F6E670000000001 8004000100000000
0120: 000000680000002C 0000000000000001 000000FFFFFFFFFF FFFFFFFCFFFFFFE9
0140: FFFFFF4200000042 0000004C02000039 0100000000000000 000000040000000F
0160: 4170706C69636174 696F6E4974656D07 436C617373657307 636C734C6F6E6709
0180: 46756E6374696F6E 7300000000
.enddata
.head 2 -  Outline Window State: Maximized
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003001B00 0200000007000000 0000E91E910E0500 1D00FFFF4D61696E
0020: 0029000100040000 0000000000E91E80 0A00008600FFFF49 6E7465726E616C20
0040: 46756E6374696F6E 7300200001000400 000000000000E91E 800A0000DF00FFFF
0060: 5661726961626C65 73001E0001000400 000000000000F51E 100D0000F400FFFF
0080: 436C617373657300
.enddata
.data VIEWSIZE
0000: 8800
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0038B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.3"
.head 3 -  Top:    0.042"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 5.9"
.head 3 -  Top:    1.031"
.head 2 -  Fully Qualified External References? No
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: sybsal32.apl
.head 2 -  File Include: flatcontrols.app
.head 2 -  File Include: mtbl.apl
.head 2 -  File Include: mimg.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: System Default
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  Number: MU_BORRAR        = SAM_User+100001
.head 4 -  Number: MU_GRABAR        = SAM_User+100002
.head 4 -  Number: MU_ACTUALIZAR  = SAM_User+100003
.head 4 -  Number: MU_REVISAR  = SAM_User+100004
.head 4 -  Number: MU_SELECCIONAR  = SAM_User+100005
.head 4 -  Number: DBP_SYBAUTOCOMMIT	= 5108
.head 2 -  Resources
.head 2 +  Variables
.head 3 -  ! ! Variables para obtener configuracion
.head 3 -  String: strRepPath
.head 3 -  String: strIniPath
.head 3 -  String: strCiudad
.head 3 -  String: strODBCLab
.head 3 -  String: sGlobalDB
.head 3 -  ! !
.head 3 -  ! estas son para cualquier busqueda o select en general
.head 3 -  Sql Handle: hSql1
.head 3 -  Sql Handle: hSql2
.head 3 -  Sql Handle: hSql3
.head 3 -  Sql Handle: hSql4
.head 3 -  Sql Handle: hSql5
.head 3 -  ! esta es para los combos,identitys
.head 3 -  Sql Handle: hSql6
.head 3 -  !
.head 3 -  Boolean: bExists
.head 3 -  Boolean: bMeConecte
.head 3 -  Number: nGlobal
.head 3 -  Number: nSiguiente
.head 3 -  ! para imprimir
.head 3 -  String: sImprimir
.head 3 -  String: sEnlace
.head 3 -  String: sCampos
.head 3 -  String: sTitulo
.head 3 -  String: sPath
.head 3 -  !
.head 3 -  Number: nUsuario
.head 3 -  String: sNombreUsuario
.head 3 -  Boolean: bArraySeg[1:*]
.head 3 -  !
.head 3 -  Number: nBaseEs
.head 3 -  ! TEMPORALES GLOBALES
.head 3 -  Number: nFila
.head 3 -  String: sTemp
.head 3 -  Date/Time: dtTemp
.head 3 -  !
.head 2 +  Internal Functions
.head 3 -  !
.head 3 -  ! FUNCIONES PARA CHILDTABLEWINDOW
.head 3 +  Function: Validar_Unico_EnTablitas
.head 4 -  Description: Verifica que el valor de una columna en particular (estoy viendo) 
de alguna table window, sea única efectúa la verificación con todos los elementos
de esa columna que este en la table window.---exeptuando en la fila que estoy ahora


Entrada:
	Window Handle de la ChildTable
	Posición de la columna a buscar (texto) en la ChildTable
	Mensaje a emitir en el caso que ya exista

Retorna:	Verdadero si no esta
	Falso si esta
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTablita
.head 5 -  Number: nPosColumna
.head 5 -  String: sMensajes
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFila2
.head 5 -  String: sRecibe
.head 5 -  String: sBuscar
.head 5 -  Number: nFilaEstoy
.head 5 -  Window Handle: hWndColumna
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! obteniendo la fila donde estoy
.head 5 -  Call SalTblQueryFocus(hWndTablita,nFilaEstoy,hWndColumna)
.head 5 -  !
.head 5 -  ! obteniendo el texto donde estoy actualmente, lo anterior se transfiere a ser
lo que debo de buscar en este momento que sea único
.head 5 -  Call SalTblSetContext(hWndTablita,nFilaEstoy)
.head 5 -  Call SalTblGetColumnText( hWndTablita, nPosColumna, sBuscar)
.head 5 -  !
.head 5 -  ! ahora busquemos el handle de la columna donde voy a buscar, utilizando el número de
posición de esa columna (enviada en el parámetro)
.head 5 -  Set hWndColumna=SalGetFirstChild(hWndTablita,TYPE_TableColumn)
.head 5 -  Set nFila2=1
.head 5 +  While nFila2<nPosColumna
.head 6 -  Set hWndColumna=SalGetNextChild(hWndColumna,TYPE_TableColumn)
.head 6 -  Set nFila2=nFila2+1
.head 5 -  !
.head 5 -  Set nFila2=-1
.head 5 +  While SalTblFindNextRow(hWndTablita, nFila2, 0, 0 )
.head 6 -  Call SalTblSetContext( hWndTablita, nFila2)
.head 6 +  If nFila2!=nFilaEstoy
.head 7 -  Call SalTblGetColumnText( hWndTablita, nPosColumna, sRecibe )
.head 7 +  If sBuscar=sRecibe
.head 8 -  Call SalMessageBox(sMensajes,"ERROR",MB_Ok)
.head 8 -  Call SalTblSetContext( hWndTablita, nFilaEstoy)
.head 8 -  Call SalTblSetFocusRow( hWndTablita,nFilaEstoy )
.head 8 -  Call SalTblSetFocusCell(  hWndTablita,nFilaEstoy, hWndColumna,0,1)
.head 8 -  Return FALSE
.head 5 -  !
.head 5 -  ! al terminar me coloco donde estaba en la child table window
.head 5 -  Call SalTblSetContext(hWndTablita,nFilaEstoy)
.head 5 -  Call SalTblSetFocusRow( hWndTablita,nFilaEstoy )
.head 5 -  Call SalTblSetFocusCell(  hWndTablita,nFilaEstoy, hWndColumna,0,1)
.head 5 -  Return TRUE
.head 3 +  Function: RevisarTablas
.head 4 -  Description: Valida los campos de la ventana actual. (hWndForm) Para Child Tables
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTabla
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 5 -  Number: nFilaT
.head 4 +  Actions
.head 5 -  Set nFilaT=-1
.head 5 +  While SalTblFindNextRow(hWndTabla,nFilaT,ROW_New | ROW_Edited,0)
.head 6 -  Call SalTblSetContext(hWndTabla,nFilaT)
.head 6 +  If not SalTblQueryRowFlags( hWndTabla, nFilaT, ROW_MarkDeleted )
.head 7 -  Set hWndHijo=SalGetFirstChild( hWndTabla, TYPE_TableColumn)
.head 7 +  While hWndHijo != hWndNULL
.head 8 +  If NOT SalSendMsg( hWndHijo, MU_REVISAR, 0, 0 )
.head 9 +  If SalIsNull( hWndHijo)
.head 10 -  Call SalTblSetFocusRow( hWndTabla, nFilaT)
.head 10 -  Call SalTblSetFocusCell( hWndTabla, nFilaT, hWndHijo, 0, 1 )
.head 10 -  Call SalMessageBox("Campo no Puede Quedar en Blanco","ERROR",MB_Ok)
.head 10 -  Call SalTblSetFocusCell( hWndTabla, nFilaT,hWndHijo,0,-1)
.head 10 -  Return FALSE
.head 8 -  Set hWndHijo=SalGetNextChild( hWndHijo, TYPE_TableColumn)
.head 5 -  Call SalTblSetContext(hWndTabla,0)
.head 5 -  Return TRUE
.head 3 +  Function: HayFilas
.head 4 -  Description: Verifica si existe al menos 1 fila en una CHILD TABLE
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTabla
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 5 -  Number: nFila
.head 4 +  Actions
.head 5 -  Call SalTblSetContext(hWndTabla,0)
.head 5 -  Set nFila=-1
.head 5 +  While SalTblFindNextRow(hWndTabla,nFila,0,0)
.head 6 -  Call SalTblSetContext(hWndTabla,0)
.head 6 -  Return TRUE
.head 5 -  Call SalTblSetContext(hWndTabla,0)
.head 5 -  Return FALSE
.head 3 +  Function: ContarFilas
.head 4 -  Description: Verifica si existe al menos 1 fila en una CHILD TABLE
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTabla
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 5 -  Number: nFila
.head 4 +  Actions
.head 5 -  Call SalTblSetContext(hWndTabla,0)
.head 5 -  Set nFila=-1
.head 5 +  While SalTblFindNextRow(hWndTabla,nFila,0,0)
.head 6 -  Call SalTblSetContext(hWndTabla,nFila)
.head 5 -  Call SalTblSetContext(hWndTabla,0)
.head 5 -  Return nFila+1
.head 3 -  !
.head 3 -  ! FUNCIONES PARA FORMAS
.head 3 +  Function: Limpiar
.head 4 -  Description: Limpia los campos de toda la ventana
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 4 +  Actions
.head 5 -  Set hWndHijo=SalGetFirstChild( hWndForm,
	TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|TYPE_ChildTable
	|TYPE_CheckBox|TYPE_ListBox)
.head 5 +  While hWndHijo != hWndNULL
.head 6 +  If SalGetType(hWndHijo)=TYPE_ChildTable
.head 7 -  Call SalTblReset(hWndHijo)
.head 6 +  Else
.head 7 -  Call SalClearField( hWndHijo)
.head 6 -  Set hWndHijo=SalGetNextChild( hWndHijo,
	TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|TYPE_ChildTable|TYPE_CheckBox
	|TYPE_ListBox)
.head 3 +  Function: RevisarFormaLlena
.head 4 -  Description: Revisa que todos los campos de una ventana determinada (actual) tenga sus campos
con datos, haciendo los llamados respectivos para el MU_REVISAR en el caso
que no regrese TRUE, quiere decir que debe de verificarse si esta vacío
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 4 +  Actions
.head 5 -  Set hWndHijo=SalGetFirstChild( hWndForm,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|TYPE_ListBox)
.head 5 +  While hWndHijo != hWndNULL
.head 6 +  If not SalSendMsg(hWndHijo,MU_REVISAR,0,0)
.head 7 +  If SalGetType( hWndHijo )=TYPE_ListBox
.head 8 +  If not  HaySeleccionadosListBox( hWndHijo ) 
.head 9 -  Call SalMessageBox("La ventana de selección de múltiples ocurrencias (List Box), no puede quedar en blanco","ERROR",MB_Ok)
.head 9 -  Call SalSetFocus(hWndHijo)
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If SalIsNull(hWndHijo)
.head 9 -  Call SalMessageBox("Campo no puede quedar en blanco","ERROR",MB_Ok)
.head 9 -  Call SalSetFocus(hWndHijo)
.head 9 -  Return FALSE
.head 6 -  Set hWndHijo=SalGetNextChild( hWndHijo,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|TYPE_ListBox)
.head 5 -  Return TRUE
.head 3 +  Function: DeshabilitarTodo
.head 4 -  Description: Deshabilita todos los campos de una ventana
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 4 +  Actions
.head 5 -  Set hWndHijo=SalGetFirstChild( hWndForm,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|
				TYPE_ChildTable|TYPE_PushButton|TYPE_ListBox|TYPE_DataField|TYPE_RadioButton|TYPE_CheckBox)
.head 5 +  While hWndHijo != hWndNULL
.head 6 -  Call SalDisableWindow(hWndHijo)
.head 6 -  Set hWndHijo=SalGetNextChild( hWndHijo,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|
				TYPE_ChildTable|TYPE_PushButton|TYPE_ListBox|TYPE_DataField|TYPE_RadioButton|TYPE_CheckBox)
.head 5 -  Return TRUE
.head 3 +  Function: HabilitarTodo
.head 4 -  Description: Habilita todos los campos de una ventana
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndHijo
.head 4 +  Actions
.head 5 -  Set hWndHijo=SalGetFirstChild( hWndForm,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|
				TYPE_ChildTable|TYPE_PushButton|TYPE_ListBox|TYPE_DataField|TYPE_RadioButton|TYPE_CheckBox)
.head 5 +  While hWndHijo != hWndNULL
.head 6 -  Call SalEnableWindow(hWndHijo)
.head 6 -  Set hWndHijo=SalGetNextChild( hWndHijo,TYPE_ComboBox|TYPE_DataField|TYPE_MultilineText|
				TYPE_ChildTable|TYPE_PushButton|TYPE_ListBox|TYPE_DataField|TYPE_RadioButton|TYPE_CheckBox)
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: Identity_Vieja
.head 4 -  Description: ESTA FUNCION GENERA EL SIGUIENTE NUMERO (UNICO-IDENTITY) DE DETERMINADA
TABLA, RECIBE COMO PARAMETRO el numero que representa LA TABLA, Y DEVUELVE EL IDENTITY
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nTabla
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetch
.head 5 -  Number: nUltimo
.head 5 -  Number: nIdentico
.head 5 -  Boolean: bBueno
.head 4 +  Actions
.head 5 -  Set bBueno=FALSE
.head 5 +  While bBueno=FALSE
.head 6 -  Call SqlPrepareAndExecute(hSql6,'select max(MAXIMO) FROM IDENTITYS
			where COD_TABLA=:nTabla  into :nUltimo')
.head 6 -  Call SqlFetchNext(hSql6,nSiguiente)
.head 6 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 6 -  Set nUltimo=nUltimo+1
.head 6 -  !
.head 6 +  When SqlError
.head 7 -  Return TRUE
.head 6 +  If SqlPrepareAndExecute(hSql6,"insert into IDENTITYS(MAXIMO,COD_TABLA) values(:nUltimo,:nTabla)")
.head 7 -  Set bBueno=TRUE
.head 6 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 6 -  Return nUltimo
.head 3 +  Function: Identity
.head 4 -  Description: ESTA FUNCION GENERA EL SIGUIENTE NUMERO (UNICO-IDENTITY) DE DETERMINADA
TABLA, RECIBE COMO PARAMETRO el numero que representa LA TABLA, Y DEVUELVE EL IDENTITY
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nTabla
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nUltimo
.head 5 -  Number: nIdentico
.head 4 +  Actions
.head 5 -  !
.head 5 -  Set nIdentico=-1
.head 5 +  While (nIdentico=-1)
.head 6 +  When SqlError
.head 7 -  Return FALSE
.head 6 +  If SqlPrepareAndExecute(hSql6,"
select 	max(MAXIMO)
FROM 	IDENTITYS
where 	COD_TABLA=:nTabla
into 	:nUltimo")
.head 7 -  Call SqlFetchNext(hSql6,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql6,'commit')
.head 7 -  Set nUltimo=nUltimo+1
.head 7 -  !
.head 7 +  When SqlError
.head 8 -  Return FALSE
.head 7 +  If SqlPrepareAndExecute(hSql6,"insert into IDENTITYS(MAXIMO,COD_TABLA) values(:nUltimo,:nTabla)")
.head 8 -  Set nIdentico=0
.head 8 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 5 -  !
.head 5 -  Return nUltimo
.head 3 +  Function: ConectarCursores
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Receive Sql Handle: hSql
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  When SqlError
.head 6 -  Call ProcesarErrorMSQ()
.head 6 -  Return FALSE
.head 5 +  If SqlConnect( hSql )
.head 6 -  Call SqlSetIsolationLevel( hSql,'RL' )
.head 6 -  Call SqlSetParameter( hSql , DBP_PRESERVE, TRUE, '')
.head 6 -  Call SqlSetResultSet( hSql, FALSE )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Call SalMessageBox("No se pudo conectar el cursor","ERROR",MB_Ok)
.head 6 -  Return FALSE
.head 3 +  Function: EsUsuario
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sId
.head 5 -  String: sContrasena
.head 5 -  Receive Number: nUsuario
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlExists( "select COD_USU
	from USUARIOS 
	where NOMBRE=:sId and CONTRASE=:sContrasena
	into	:nUsuario",bExists)
.head 6 -  Call SqlClearImmediate()
.head 6 +  If bExists
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Call SalMessageBox("Los datos no se pudieron leer","ERROR",MB_Ok)
.head 6 -  Return FALSE
.head 3 +  Function: SacarCodigo
.head 4 -  Description: Extrae el valor dependiendo del query qure envia y lo regresa en
nCodigos
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sSacar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nCodigos
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute(hSql6,sSacar)
.head 5 -  Call SqlFetchNext(hSql6,nSiguiente)
.head 5 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 5 -  Return nCodigos
.head 3 +  Function: CargarSeguridad
.head 4 -  Description: Esta función carga la seguridad de el usuario dependiendo
de la aplicación que se consulte. Esta información la
devuelve en un arreglo de variables booleanas.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sUser
.head 5 -  Receive Boolean: arrBooleanas[*]
.head 5 -  ! Number: nCasoSeguridad
.head 5 -  String: sConsulta
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nContador
.head 5 -  Number: nFetch
.head 5 -  String: sSeguridad
.head 5 -  String: sS1
.head 4 +  Actions
.head 5 +  ! Select Case nCasoSeguridad
.head 6 +  Case 1
.head 7 -  Set sConsulta='derechos_contabilidad'
.head 7 -  Break 
.head 6 +  Case 2
.head 7 -  Set sConsulta='derechos_facturacion'
.head 7 -  Break 
.head 6 +  Case 3
.head 7 -  Set sConsulta='derechos_planilla'
.head 7 -  Break 
.head 6 +  Case 4
.head 7 -  Set sConsulta='derechos_inventario'
.head 7 -  Break 
.head 5 -  Call SqlPrepareAndExecute(hSql1,'SELECT ' || sConsulta || '
FROM USUARIOS
WHERE NOMBRE=:sUser INTO :sS1')
.head 5 -  Call SqlFetchNext(hSql1,nFetch)
.head 5 -  Call SqlPrepareAndExecute(hSql1,'commit')
.head 5 -  Set sS1=SalStrTrimX(sS1)
.head 5 -  Set sSeguridad=''||sS1
.head 5 -  Set nContador=0
.head 5 +  While nContador <= (SalStrLength( sSeguridad ) - 1)
.head 6 -  Set arrBooleanas[ nContador+1 ] = SalStrToNumber( SalStrMidX( sSeguridad, nContador, 1 ) )
.head 6 -  Set nContador=nContador+1
.head 5 -  Return TRUE
.head 3 -  !
.head 3 -  ! PARA MANEJO DE ERRORES
.head 3 +  Function: ProcesarErrorMSQ
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlError
.head 5 -  Number: nError
.head 5 -  Number: nPos
.head 5 -  String: sTexto
.head 5 -  Boolean: bBandera
.head 4 +  Actions
.head 5 -  !
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql1,"rollback tran")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql2,"rollback tran")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql3,"rollback tran")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql4,"rollback tran")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql5,"rollback tran")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql6,"rollback tran")
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SqlExtractArgs( wParam,lParam,hSqlError, nError,nPos )
.head 5 -  Call SqlGetErrorText( nError, sTexto )
.head 5 -  !
.head 5 +  Select Case nError
.head 6 +  Case 20087
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"La base de Datos no ha sido levantada hasta este momento")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20030
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Esta tratando de eliminar un registro que tiene otras dependencias, debe de eliminar primero las otras dependencias y luego eliminar este registro")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20033
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no existe ó Contraseña incorrecta")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20026
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Error en asignación de valores, Revise tipos")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20050
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Tabla no existe")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20054
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Nombre de Campo Incorrecto")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20038
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no tiene derechos para accesar ese 
objeto")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 201
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Comando no ha sido compilado")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 -  Case 22601
.head 6 +  Case 2601
.head 7 +  If nGlobal != -11
.head 8 -  Call SalModalDialog(dlgError,hWndForm,nError,"No puede ingresar un dato que ya existe, verifique los datos")
.head 7 +  Else
.head 8 +  If nGlobal = -11
.head 9 -  Return FALSE
.head 7 -  Break
.head 6 +  Default
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,sTexto)
.head 7 -  Break
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return FALSE
.head 3 +  Function: ProcesarErrorSQLbase
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Sql Handle: hSqlError
.head 5 -  Number: nError
.head 5 -  Number: nPos
.head 5 -  String: sTexto
.head 5 -  Boolean: bBandera
.head 4 +  Actions
.head 5 -  !
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql1,"rollback")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql2,"rollback")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql3,"rollback")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql4,"rollback")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql5,"rollback")
.head 5 +  When SqlError
.head 6 -  Set bBandera=FALSE
.head 5 +  If bMeConecte=1
.head 6 -  Call SqlPrepareAndExecute(hSql6,"rollback")
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SqlExtractArgs( wParam,lParam,hSqlError, nError,nPos )
.head 5 -  Call SqlGetErrorText( nError, sTexto )
.head 5 -  !
.head 5 +  Select Case nError
.head 6 +  Case 20087
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"La base de Datos no ha sido levantada hasta este momento")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20030
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Esta tratando de eliminar un registro que tiene otras dependencias, debe de eliminar primero las otras dependencias y luego eliminar este registro")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20033
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no existe ó Contraseña incorrecta")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20026
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Error en asignación de valores, Revise tipos")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20050
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Tabla no existe")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20054
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Nombre de Campo Incorrecto")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 20038
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no tiene derechos para accesar ese 
objeto")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 +  Case 201
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,"Comando no ha sido compilado")
.head 7 -  Return FALSE
.head 7 -  Break
.head 6 -  Case 22601
.head 6 +  Case 2601
.head 7 +  If nGlobal != -11
.head 8 -  Call SalModalDialog(dlgError,hWndForm,nError,"No puede ingresar un dato que ya existe, verifique los datos")
.head 7 +  Else
.head 8 +  If nGlobal = -11
.head 9 -  Return FALSE
.head 7 -  Break
.head 6 +  Default
.head 7 -  Call SalModalDialog(dlgError,hWndForm,nError,sTexto)
.head 7 -  Break
.head 5 -  !
.head 5 -  Return FALSE
.head 3 +  ! Function: ProcesarError
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Sql Handle: hSqlError
.head 5 -  Number: nError
.head 5 -  Number: nPos
.head 5 -  String: sTexto
.head 5 -  Boolean: bBandera
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SqlExtractArgs( wParam,lParam,hSqlError, nError,nPos )
.head 5 -  Call SqlGetErrorText( nError, sTexto )
.head 5 -  ! es SQLBase
.head 5 +  Select Case nBaseEs
.head 6 -  ! es SQLBASE
.head 6 +  Case 1
.head 7 +  Select Case nError
.head 8 +  Case 404
.head 9 -  Call SalMessageBox( 'Contraseña de Usuario Inválido, verifique esa contraseña','ERROR',MB_Ok)
.head 9 -  Return FALSE
.head 9 -  Break 
.head 8 +  Case 405
.head 9 -  Call SalMessageBox( 'Usuario Inválido, verifique que el usuario exista','ERROR',MB_Ok)
.head 9 -  Return FALSE
.head 8 +  Case 410
.head 9 -  Call SalMessageBox( 'No se pudo abrir la base de datos','ERROR',MB_Ok)
.head 9 -  Return FALSE
.head 8 +  Default 
.head 9 -  Call SalMessageBox("El error actual no esta documentado por la rutina de error, a continuación se le presentará
una pantalla donde aparece la descripción del error y el número, por favor comuniqueselo a los desarrolladores de la aplicación:
Descripción ==> "||sTexto||
" 	
Numero de Error ==> "||SalNumberToStrX(nError,0),
"DESCRIPCION DEL ERROR",MB_Ok)
.head 9 -  Break 
.head 6 -  Case 8
.head 6 -  Case 28
.head 6 -  Case 31
.head 6 +  Case 4	! es SYBASE,ORACLE7,ORACLE,MSSQLSERVER
.head 7 +  Select Case nError
.head 8 +  Case 20087
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,"La base de Datos no ha sido levantada hasta este momento")
.head 9 -  Return FALSE
.head 9 -  Break 
.head 8 +  Case 20033
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no existe")
.head 9 -  Return FALSE
.head 9 -  Break 
.head 8 +  Default 
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,sTexto)
.head 9 -  Break 
.head 6 +  Case 0	!aqui es cuando no nos hemos conectado a la base de datos
.head 7 +  Select Case nError
.head 8 -  ! ESTOS SON PARA MICROSOFT SQLSERVER
.head 8 +  Case 20087
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,"La base de Datos no ha sido levantada hasta este momento")
.head 9 -  Return FALSE
.head 9 -  Break 
.head 8 +  Case 20033
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,"Usuario no existe ó contraseña Incorrecta")
.head 9 -  Return FALSE
.head 9 -  Break 
.head 8 +  Default 
.head 9 -  Call SalModalDialog(dlgError,hWndForm,nError,sTexto)
.head 9 -  Break 
.head 6 +  Default 
.head 7 -  Call SalMessageBox( 'No hay errores para esa base de datos ','ERROR',MB_Ok)
.head 5 -  Return FALSE
.head 3 +  Function: FechaHoy
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Number: nCaso
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dtFecha
.head 4 +  Actions
.head 5 -  ! Call SqlImmediate("select getdate() into :dtFecha")
.head 5 -  ! 1 PARA Sqlbase
.head 5 -  ! 2 PARA Microsoft SQLServer
.head 5 +  Select Case nCaso
.head 6 +  Case 1
.head 7 -  Call SqlImmediate("SELECT SYSDATETIME FROM SYSTABLES WHERE COLCOUNT>10
 into :dtFecha")
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Call SqlImmediate("select getdate() into :dtFecha")
.head 7 -  Break
.head 5 -  Call SqlClearImmediate()
.head 5 -  Return dtFecha
.head 3 -  !
.head 3 -  ! PARA MANEJO DE LIST BOX
.head 3 -  !
.head 3 +  ! Function: Leer_ListBox
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Window Handle: lbGenerico
.head 5 -  String: sTablaVarias
.head 5 -  String: sTablaAxl
.head 5 -  String: sCodigoVarias
.head 5 -  String: sCodigoAxl
.head 5 -  Number: nUnicoValor
.head 5 -  String: sUnicoValor
.head 5 -  Receive Sql Handle: hSqlInsertar
.head 5 -  Number: nCaso
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nBuscando
.head 5 -  Number: nActual
.head 5 -  Number: nEntradas
.head 5 -  String: sBuscar
.head 5 -  String: sBuscar2
.head 4 +  Actions 
.head 5 +  Select Case nCaso
.head 6 +  Case 1	! este es para el caso que sean Entero,Entero
.head 7 +  If not SqlPrepareAndExecute(hSqlInsertar,"select "||sCodigoAxl||" from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor into :nBuscando")
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSqlInsertar,nSiguiente)
.head 8 +  If not SqlImmediate("select NOMBRE  from "||sTablaAxl||" where "||sCodigoAxl||"=:nBuscando into :sBuscar")
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 8 -  Set nActual=0
.head 8 +  While nActual<nEntradas
.head 9 +  If not SalListQueryState( lbGenerico, nActual )
.head 10 -  Set sBuscar2=SalListQueryTextX( lbGenerico,nActual)
.head 9 +  Else 
.head 10 -  ! Call SalListSetSelect( lbGenerico, nActual)
.head 10 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 9 +  If sBuscar2=sBuscar
.head 10 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 9 -  Set nActual=nActual+1
.head 7 -  Return TRUE
.head 7 -  Break 
.head 6 +  Case 2		! este es para el caso que sean Entero,Caracter
.head 7 +  If not SqlPrepareAndExecute(hSqlInsertar,"select "||sCodigoAxl||" from "||sTablaVarias||"
		where "||sCodigoVarias||"=:sUnicoValor into :nBuscando")
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 7 +  While SqlFetchNext(hSqlInsertar,nSiguiente)
.head 8 +  If not SqlImmediate("select NOMBRE  from "||sTablaAxl||" where "||sCodigoAxl||"=:nBuscando into :sBuscar")
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 8 -  Set nActual=0
.head 8 +  While nActual<nEntradas
.head 9 +  If not SalListQueryState( lbGenerico, nActual )
.head 10 -  Set sBuscar2=SalListQueryTextX( lbGenerico,nActual)
.head 9 +  Else 
.head 10 -  ! Call SalListSetSelect( lbGenerico, nActual)
.head 10 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 9 +  If sBuscar2=sBuscar
.head 10 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 9 -  Set nActual=nActual+1
.head 7 -  Return TRUE
.head 7 -  Break 
.head 3 +  ! Function: Actualizar_ListBox
.head 4 -  Description: 	Actualiza una tabla que sea de tipo N-->N
	Ejemplo:
	
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Window Handle: lbGenerico
.head 5 -  String: sTablaVarias
.head 5 -  String: sTablaAxl
.head 5 -  String: sCodigoVarias
.head 5 -  String: sCodigoAxl
.head 5 -  Number: nUnicoValor
.head 5 -  String: sUnicoValor
.head 5 -  Receive Sql Handle: hSqlInsertar
.head 5 -  Number: nCaso
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nActual
.head 5 -  Number: nEntradas
.head 5 -  Number: nCod
.head 5 -  String: sBuscar
.head 4 +  Actions 
.head 5 +  Select Case nCaso
.head 6 +  Case 1	! este es para el caso que sean Entero,Entero
.head 7 +  If SqlExists("select * from "||sTablaVarias||" where "||sCodigoVarias||"=:nUnicoValor",bExists)
.head 8 +  If bExists
.head 9 +  If not SqlPrepareAndExecute(hSqlInsertar,"delete from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor")
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 8 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 8 -  Set nActual=0
.head 8 +  While nActual<nEntradas
.head 9 +  If SalListQueryState( lbGenerico, nActual )
.head 10 -  Set sBuscar=SalListQueryTextX( lbGenerico,nActual)
.head 10 +  If not SqlImmediate("select "||sCodigoAxl||" from "||sTablaAxl||" where NOMBRE=:sBuscar into :nCod")
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 10 +  If not SqlPrepareAndExecute(hSqlInsertar,"insert into "||sTablaVarias||
		"("||sCodigoVarias||","||sCodigoAxl||")"||
		"values(:nUnicoValor,:nCod)")
		
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo grabar informacion en tabla de varias","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 9 -  Set nActual=nActual+1
.head 8 -  Return TRUE
.head 7 +  Else 
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox("No se pudo sacar la información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 7 -  Break 
.head 6 +  Case 2	! este es para el caso que sean Entero,Caracter
.head 7 +  If SqlExists("select * from "||sTablaVarias||" where "||sCodigoVarias||"=:sUnicoValor",bExists)
.head 8 +  If bExists
.head 9 +  If not SqlPrepareAndExecute(hSqlInsertar,"delete from "||sTablaVarias||"
		where "||sCodigoVarias||"=:sUnicoValor")
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 8 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 8 -  Set nActual=0
.head 8 +  While nActual<nEntradas
.head 9 +  If SalListQueryState( lbGenerico, nActual )
.head 10 -  Set sBuscar=SalListQueryTextX( lbGenerico,nActual)
.head 10 +  If not SqlImmediate("select "||sCodigoAxl||" from "||sTablaAxl||" where NOMBRE=:sBuscar into :nCod")
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 10 +  If not SqlPrepareAndExecute(hSqlInsertar,"insert into "||sTablaVarias||
		"("||sCodigoVarias||","||sCodigoAxl||")"||
		"values(:sUnicoValor,:nCod)")
		
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo grabar informacion en tabla de varias","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 9 -  Set nActual=nActual+1
.head 8 -  Return TRUE
.head 7 +  Else 
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox("No se pudo sacar la información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 7 -  Break 
.head 3 +  Function: HaySeleccionadosListBox
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: lbGenerico
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nActual
.head 5 -  Number: nEntradas
.head 4 +  Actions
.head 5 -  Set nEntradas=SalListQueryCount(lbGenerico)
.head 5 -  Set nActual=0
.head 5 +  While nActual<nEntradas
.head 6 +  If SalListQueryState( lbGenerico, nActual )
.head 7 -  Return TRUE
.head 6 -  Set nActual=nActual+1
.head 5 -  Return FALSE
.head 3 +  Function: Grabar_Auditorias
.head 4 -  Description: Recibe 2 parametros
1) Tipo de Operacion, estos pueden ser:
	1	Insertar
	2	Actualizar
	3	Eliminar
	4	Consultar
	5	Entrada al Sistema
	6	Salida del Sistema

.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nOperacion
.head 5 -  String: sHizo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dtHoy
.head 5 -  String: sOperacion
.head 4 +  Actions
.head 5 +  Select Case nOperacion
.head 6 +  Case 1
.head 7 -  Set sOperacion='Insertar'
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set sOperacion='Actualizar'
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Set sOperacion='Eliminar'
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  Set sOperacion='Consultar'
.head 7 -  Break
.head 6 +  Case 5
.head 7 -  Set sOperacion='Ent.Sistema'
.head 7 -  Break
.head 6 +  Case 6
.head 7 -  Set sOperacion='Sal.Sistema'
.head 7 -  Break
.head 5 -  Set dtHoy=FechaHoy( 1 )
.head 5 -  Call SqlPrepareAndExecute(hSql1,"insert into
AUDITORIAS(COD_USU,FECHA,HIZO,OPERACION)
values(:nUsuario,:dtHoy,:sHizo,:sOperacion)")
.head 5 -  Call SqlPrepareAndExecute(hSql1,"commit")

.head 3 -  ! del sqlwindows
.head 3 +  ! Function: Leer_ListBox
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Window Handle: lbGenerico
.head 5 -  String: sTablaVarias
.head 5 -  String: sTablaAxl
.head 5 -  String: sCodigoVarias
.head 5 -  String: sCodigoAxl
.head 5 -  Number: nUnicoValor
.head 5 -  Receive Sql Handle: hSqlInsertar
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nBuscando
.head 5 -  Number: nActual
.head 5 -  Number: nEntradas
.head 5 -  String: sBuscar
.head 5 -  String: sBuscar2
.head 4 +  Actions 
.head 5 +  If not SqlPrepareAndExecute(hSqlInsertar,"select "||sCodigoAxl||" from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor into :nBuscando")
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 6 -  Return FALSE
.head 5 +  While SqlFetchNext(hSqlInsertar,nSiguiente)
.head 6 +  If not SqlImmediate("select NOMBRE  from "||sTablaAxl||" where "||sCodigoAxl||"=:nBuscando into :sBuscar")
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 7 -  Return FALSE
.head 6 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 6 -  Set nActual=0
.head 6 +  While nActual<nEntradas
.head 7 +  If not SalListQueryState( lbGenerico, nActual )
.head 8 -  Set sBuscar2=SalListQueryTextX( lbGenerico,nActual)
.head 7 +  Else 
.head 8 -  ! Call SalListSetSelect( lbGenerico, nActual)
.head 8 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 7 +  If sBuscar2=sBuscar
.head 8 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 7 -  Set nActual=nActual+1
.head 5 -  Return TRUE
.head 3 +  ! Function: Actualizar_ListBox
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Window Handle: lbGenerico
.head 5 -  String: sTablaVarias
.head 5 -  String: sTablaAxl
.head 5 -  String: sCodigoVarias
.head 5 -  String: sCodigoAxl
.head 5 -  Number: nUnicoValor
.head 5 -  Receive Sql Handle: hSqlInsertar
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nActual
.head 5 -  Number: nEntradas
.head 5 -  Number: nCod
.head 5 -  String: sBuscar
.head 4 +  Actions 
.head 5 +  If SqlExists("select * from "||sTablaVarias||" where "||sCodigoVarias||"=:nUnicoValor",bExists)
.head 6 +  If bExists
.head 7 +  If not SqlPrepareAndExecute(hSqlInsertar,"delete from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor")
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 6 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 6 -  Set nActual=0
.head 6 +  While nActual<nEntradas
.head 7 +  If SalListQueryState( lbGenerico, nActual )
.head 8 -  Set sBuscar=SalListQueryTextX( lbGenerico,nActual)
.head 8 +  If not SqlImmediate("select "||sCodigoAxl||" from "||sTablaAxl||" where NOMBRE=:sBuscar into :nCod")
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 +  If not SqlPrepareAndExecute(hSqlInsertar,"insert into "||sTablaVarias||
		"("||sCodigoVarias||","||sCodigoAxl||")"||
		"values(:nUnicoValor,:nCod)")
		
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call SalMessageBox("No se pudo grabar informacion en tabla de varias","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 7 -  Set nActual=nActual+1
.head 6 -  Return TRUE
.head 5 +  Else 
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalMessageBox("No se pudo sacar la información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 6 -  Return FALSE
.head 3 +  Function: FechaStr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: dtFecha
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: xsFecha
.head 5 -  Number: xnMes
.head 5 -  Number: xnDia
.head 5 -  Number: xnAnio
.head 4 +  Actions
.head 5 -  Set xnMes=SalDateMonth(dtFecha)
.head 5 -  Set xnDia=SalDateDay(dtFecha)
.head 5 -  Set xnAnio=SalDateYear(dtFecha)
.head 5 -  Set xsFecha = SalNumberToStrX(xnDia,0)
.head 5 -  Set xsFecha = xsFecha || " de "
.head 5 +  Select Case xnMes
.head 6 +  Case 1
.head 7 -  Set xsFecha=xsFecha || "Enero"
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set xsFecha=xsFecha ||"Febrero"
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Set xsFecha=xsFecha ||"Marzo"
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  Set xsFecha=xsFecha ||"Abril"
.head 7 -  Break
.head 6 +  Case 5
.head 7 -  Set xsFecha=xsFecha ||"Mayo"
.head 7 -  Break
.head 6 +  Case 6
.head 7 -  Set xsFecha=xsFecha ||"Junio"
.head 7 -  Break
.head 6 +  Case 7
.head 7 -  Set xsFecha=xsFecha ||"Julio"
.head 7 -  Break
.head 6 +  Case 8
.head 7 -  Set xsFecha=xsFecha ||"Agosto"
.head 7 -  Break
.head 6 +  Case 9
.head 7 -  Set xsFecha=xsFecha ||"Septiembre"
.head 7 -  Break
.head 6 +  Case 10
.head 7 -  Set xsFecha=xsFecha ||"Octubre"
.head 7 -  Break
.head 6 +  Case 11
.head 7 -  Set xsFecha=xsFecha ||"Noviembre"
.head 7 -  Break
.head 6 +  Default
.head 7 -  Set xsFecha=xsFecha ||"Diciembre"
.head 7 -  Break
.head 5 -  Set xsFecha = xsFecha || " de "
.head 5 -  Set xsFecha = xsFecha || SalNumberToStrX(xnAnio,0)
.head 5 -  Return xsFecha
.head 2 -  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3963532588
0000: 0703000088010000 0000000000000000 0200000800FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F0D003C00 00077000624D656E
0040: 6F731E00C0000001 000000A3010D0000 FFFF000180150000 000100010015636D
0060: 624261007365436F 6469676F0046696C 747261646F005200 0000030000000F02
0080: 040000FE00FF1304 0000010DFB00FF0F 11000000EE0200FF 3F01800615000200
00A0: 0000F819636DFF3F 4368906172520000 033D000204FB00FF 6F0400EC010D00FF
00C0: BF11B9000200FFFF 9801801500030100 13636C734362FC43 6FBF52D9000300B3
00E0: 010D00FFFFE40D00 0002FE00FF9B1100 02FB00FF0F01800D 0019000400127000
0100: 624368426F727261 0072436869717569 74886F1E00000100 9E00010DFD00FF87
0120: 0180040000000500 00000D6672006D53 6F6C6F4E6F6D2062 72651E0000017A00
0140: 0003F4040000FF1F 0180150300060000 000DF4636D42DF52 E800030000DD0200
0160: FF7F046300010D00 FFFFCD110002FD00 FFC7018015000007 0000000B636CEF6F
0180: CF00039E00010DFD 00FF270D000002F7 00FFDF11DC000200 FF7F
.enddata
.head 3 -  !
.head 3 -  ! estos son botones mas graficos
.head 3 +  Pushbutton Class: pbMas
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\filenew.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Boton de Nueva para la aplicacion
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndFila
.head 5 -  Window Handle: hWndTabla
.head 5 -  Window Handle: hWndCampo
.head 5 -  Number: nOpcionh ! 1 para forma, 2 para table-window
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call Limpiar(  )
.head 6 -  Call HabilitarTodo(  )
.head 6 +  If nOpcionh=1
.head 7 -  Call SalSetFocus(hWndCampo)
.head 6 +  Else
.head 7 -  Call SalTblReset(hWndTabla)
.head 7 -  ! Call SalSetFocus(hWndTabla)
.head 7 -  ! Call SalTblSetFocusCell( hWndTabla, SalTblInsertRow( hWndTabla, TBL_MaxRow ), hWndFila, 0, 1 )
.head 6 -  Call SalStatusSetText(hWndForm,'                                                      ')
.head 3 +  Pushbutton Class: pbLimpia
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\eraser.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Boton usado en las ventanas de consultas, que limpia todos los datos que tenga
en pantalla
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call Limpiar(  )
.head 6 -  Call HabilitarTodo(  )
.head 3 +  Pushbutton Class: pbImprimir
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\fileprint.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Boton de Nueva para la aplicacion
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: pbBusqueda
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F3
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\search.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Boton de busqueda para las aplicaciones
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: pbMenos
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\editdelete.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 +  Class Variables
.head 5 -  Number: nFilas
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndFila
.head 5 -  Window Handle: hWndTabla
.head 5 -  Number: nOpcionh ! 1 para forma, 2 para table-window
.head 5 -  String: sTitulo
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If nOpcionh=1
.head 7 +  If SalMessageBox("Desea Eliminar "||sTitulo,"ADVERTENCIA",MB_YesNo)=IDYES
.head 8 -  Call SalSendMsg(hWndForm,MU_BORRAR,0,0)
.head 8 -  Call Limpiar(  )
.head 6 +  Else
.head 7 -  Call SalStatusSetText(hWndForm,'                                                      ')
.head 7 -  Call SalTblQueryFocus(  hWndTabla,nFilas,hWndFila)
.head 7 +  If SalTblQueryRowFlags( hWndTabla,nFilas,ROW_MarkDeleted)
.head 8 -  Call SalTblSetRowFlags( hWndTabla,nFilas, ROW_MarkDeleted,FALSE)
.head 7 +  Else
.head 8 +  If SalTblQueryRowFlags( hWndTabla,nFilas,ROW_New)
.head 9 -  Call SalTblDeleteRow( hWndTabla, nFilas, TBL_Adjust )
.head 8 +  Else
.head 9 -  Call SalTblSetRowFlags( hWndTabla,nFilas, ROW_MarkDeleted,TRUE)
.head 9 -  Call SalTblSetFocusCell( hWndTabla, nFilas, hWndFila, 0, 1 )
.head 3 +  Pushbutton Class: pbGrabar
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\filesave.bmp
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Con este botón me permite verificar para tres tipos de pantalla como
validar los datos, estos son:
1) Solo datafield, combobox,multiline
2) Solo childtablewindow
3) Ambos anteriores
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndTabla
.head 5 -  Number: nOpcion
.head 5 -  String: sTitulo
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If nOpcion=1
.head 7 +  If RevisarFormaLlena()
.head 8 +  If SalMessageBox("Desea Grabar "||sTitulo,"ADVERTENCIA",MB_YesNo)=IDYES
.head 9 -  Call SalSendMsg(hWndForm,MU_GRABAR,0,0)
.head 9 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 9 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 9 -  Return TRUE
.head 6 +  Else
.head 7 +  If nOpcion=2
.head 8 +  If RevisarTablas(hWndTabla)
.head 9 +  If SalMessageBox("Desea Aplicar los Cambios","CONFIRMACION",MB_YesNo)=IDYES
.head 10 -  Call SalSendMsg(hWndForm,MU_GRABAR,0,0)
.head 10 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 10 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 10 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If RevisarFormaLlena() and RevisarTablas(hWndTabla)
.head 9 +  If SalMessageBox("Desea Aplicar los Cambios","CONFIRMACION",MB_YesNo)=IDYES
.head 10 -  Call SalSendMsg(hWndForm,MU_GRABAR,0,0)
.head 10 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 10 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 10 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 3 +  Pushbutton Class: pbSalir
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\Logout.bmp
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Cierra una ventana ya sea si es Form ó Dialog
.head 4 +  Derived From
.head 5 -  Class: pbBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalGetType( hWndForm )=TYPE_DialogBox
.head 7 -  Call SalEndDialog(hWndForm,TRUE)
.head 7 -  Call SalBringWindowToTop(hWndForm)
.head 6 +  Else
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 7 -  Call SalBringWindowToTop(hWndForm)
.head 3 -  ! los anteriores son botones mas graficos
.head 3 -  ! estos van a ser los pushbotton base y a continuacion para los FORM's
.head 3 +  ! Pushbutton Class: pbGrabar
.winattr
.head 4 -  Title: &Grabar
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.49"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: C:\CENTURA\BITMAPS\SAVE1.ICO
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.end
.head 4 -  Description: 
.head 4 +  Derived From 
.head 5 -  Class: pbBase
.head 4 -  Class Variables 
.head 4 +  Instance Variables 
.head 5 -  String: sMensaje
.head 4 -  Functions 
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 +  If RevisarFormaLlena()
.head 7 +  If SalMessageBox("Desea Grabar "||sMensaje,"ADVERTENCIA",MB_YesNo)=IDYES
.head 8 +  If SalSendMsg(hWndForm,MU_GRABAR,0,0)
.head 9 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 9 -  Return TRUE
.head 8 +  Else 
.head 9 -  Return FALSE
.head 3 -  ! este es para los combos de los FORM's
.head 3 +  Combo Box Class: cmbBaseCodigoFiltrado
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  2.071"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.104"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Clase generica usada para combo box  incluye ambos NUMERICOS Y CARACTER, esto se
hace inicializando el valor del nCaso de la siguiente forma
Este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER

Se debe de inicializar en el SAM_Create lo siguiente:
sTabla: el nombre de la tabla (AXL_DEPTOS)
sNombre: nombre del campo de la tabla de tipo string con el que deseo popular
	esa tabla (NOMBRE)
sCodigo: nombre del campo de la tabla de donde voy a extraer el valor del codigo (COD_DEPTO)

Los valores se almacenarán en, dependiendo de si son NUMEROS ó CARACTERES
nCodigo	NUMERICOS
sCodigos	CARACTER

NOTA: EL nCaso no es necesario inicializarlo cuando es numerico
.head 4 +  Derived From
.head 5 -  Class: cFlatComboBox
.head 4 +  Class Variables
.head 5 -  String: sComboActual
.head 5 -  Number: nTerp
.head 5 -  String: sTerp
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  !
.head 5 -  ! este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 5 -  !
.head 5 -  ! -------------Esto fue agregado en que caso de que se desee filtrar un campo entero
.head 5 -  String: sNombreFiltro
.head 5 -  Number: nValorFiltro
.head 4 +  Functions
.head 5 +  Function: Actualizar
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nCaso=1	! es numerico
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 +  Else ! es caracter
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  !
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro order by "||sNombre)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  ! On MU_ACTUALIZAR
.head 6 +  If nCaso=1	! es numerico
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 +  Else ! es caracter
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 -  !
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  !
.head 7 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 8 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 8 -  Call SalSetFocus(hWndItem)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  On SAM_Click
.head 6 -  ! aqui es para NUMERICOS
.head 6 +  If nCaso=1
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro and "||sNombre||"=:MyValue into :nTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set nCodigo=nTerp
.head 6 -  ! aqui es para CARACTER
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro and "||sNombre||"=:MyValue into :sTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set sCodigos=sTerp
.head 6 -  Call SalSendMsg(hWndItem,SAM_Validate,0,0)
.head 3 +  Combo Box Class: cmbBaseCodigoFiltradoChar
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  2.071"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.104"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Clase generica usada para combo box  incluye ambos NUMERICOS Y CARACTER, esto se
hace inicializando el valor del nCaso de la siguiente forma
Este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER

Se debe de inicializar en el SAM_Create lo siguiente:
sTabla: el nombre de la tabla (AXL_DEPTOS)
sNombre: nombre del campo de la tabla de tipo string con el que deseo popular
	esa tabla (NOMBRE)
sCodigo: nombre del campo de la tabla de donde voy a extraer el valor del codigo (COD_DEPTO)

Los valores se almacenarán en, dependiendo de si son NUMEROS ó CARACTERES
nCodigo	NUMERICOS
sCodigos	CARACTER

NOTA: EL nCaso no es necesario inicializarlo cuando es numerico
.head 4 +  Derived From
.head 5 -  Class: cFlatComboBox
.head 4 +  Class Variables
.head 5 -  String: sComboActual
.head 5 -  Number: nTerp
.head 5 -  String: sTerp
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  !
.head 5 -  ! este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 5 -  !
.head 5 -  ! -------------Esto fue agregado en que caso de que se desee filtrar un campo entero
.head 5 -  String: sNombreFiltro
.head 5 -  String: sValorFiltro
.head 4 +  Functions
.head 5 +  Function: Actualizar
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nCaso=1	! es numerico
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 +  Else ! es caracter
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  !
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla||" where "||sNombreFiltro||" = :sValorFiltro order by "||sNombre)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  ! On MU_ACTUALIZAR
.head 6 +  If nCaso=1	! es numerico
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 +  Else ! es caracter
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 -  !
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  !
.head 7 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 8 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 8 -  Call SalSetFocus(hWndItem)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  On SAM_Click
.head 6 -  ! aqui es para NUMERICOS
.head 6 +  If nCaso=1
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :sValorFiltro and "||sNombre||"=:MyValue into :nTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set nCodigo=nTerp
.head 6 -  ! aqui es para CARACTER
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :sValorFiltro and "||sNombre||"=:MyValue into :sTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set sCodigos=sTerp
.head 6 -  Call SalSendMsg(hWndItem,SAM_Validate,0,0)
.head 3 -  ! este es para los datafield
.head 3 +  Data Field Class: dfBase
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  2.271"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cFlatDataField
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 -  ! este es para los multiline
.head 3 +  Multiline Field Class: mlBase
.head 4 -  Data
.head 5 -  Maximum Data Length: 30000
.head 5 -  String Type: Long String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  5.686"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.036"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cFlatMultilineField
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 -  ! este es para los df de Numeros,fecha
.head 3 +  Data Field Class: dfNumero
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  0.788"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Class Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: dfBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Data Field Class: dfFecha
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  0.943"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Class Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Black
.head 5 -  Background Color: 3D Highlight Color
.head 5 -  Input Mask: 99/99/9999
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: dfBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 -  ! esto es para las columnas
.head 3 +  Column Class: clsNumero
.head 4 -  Title: numero
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.763"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: #0
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column Class: clsDatos
.head 4 -  Title: datos
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Left
.head 4 -  Width:  2.083"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column Class: clsLong
.head 4 -  Title: long
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 30000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  3.717"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Popup Edit
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column Class: clsFecha
.head 4 -  Title:
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Class Default
.head 4 -  Input Mask: 99/99/9999
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column Class: clsCbCodigoFiltrado
.head 4 -  Title:
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description: esta es una columna tipo combo box, usada para todas las table window,
como sabemos no puede procesar el mensaje de SAM_Click, dado que es columna,
por lo que en el SAM_Validate, efectuó la valdación de las columnas,

La documentación completa de esta clase, puede leerse en esta misma libreria, en la
parte de combo box
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  Number: nTerp
.head 5 -  String: sComboActual
.head 5 -  String: sTerp
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  !
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 5 -  !
.head 5 -  ! -------------Esto fue agregado en que caso de que se desee filtrar un campo entero
.head 5 -  String: sNombreFiltro
.head 5 -  Number: nValorFiltro
.head 4 -  Functions
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro order by sNombre")
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On MU_ACTUALIZAR
.head 6 +  If nCaso=1	! es numerico
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:hWndItem")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 +  Else ! es caracter
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :hWndItem")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  !
.head 7 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 8 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 8 -  Call SalSetFocus(hWndItem)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  ! aqui es para NUMERICOS
.head 8 +  If nCaso=1
.head 9 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro and "||sNombre||"=:MyValue into :nTerp")
.head 9 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 9 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 9 -  Set nCodigo=nTerp
.head 8 -  ! aqui es para CARACTER
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombreFiltro||" = :nValorFiltro and "||sNombre||"=:MyValue into :sTerp")
.head 9 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 9 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 9 -  Set sCodigos=sTerp
.head 8 -  Return TRUE
.head 3 -  ! ESTO ES PARA LAS CHILD TABLE's
.head 3 +  Pushbutton Class: pbChBaseChiquito
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.629"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cFlatPushbutton
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: pbChAgregarChiquito
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\edit_add15.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pbChBaseChiquito
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndTabla
.head 5 -  Window Handle: hWndFila
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSetFocus(hWndTabla)
.head 6 -  Call SalTblSetFocusCell( hWndTabla, SalTblInsertRow( hWndTabla, TBL_MaxRow ), hWndFila, 0, 1 )
.head 6 -  Call SalStatusSetText(hWndForm,'			')
.head 3 +  Pushbutton Class: pbChBorrarChiquito
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\edit_remove15.bmp
.head 4 -  Picture Transparent Color: Black
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pbChBaseChiquito
.head 4 +  Class Variables
.head 5 -  Number: nFilaChild
.head 4 +  Instance Variables
.head 5 -  Window Handle: hWndFila
.head 5 -  Window Handle: hWndTabla
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalStatusSetText(hWndForm,'			')
.head 6 -  Call SalTblQueryFocus(  hWndTabla,nFilaChild,hWndFila)
.head 6 +  If SalTblQueryRowFlags( hWndTabla,nFilaChild,ROW_MarkDeleted)
.head 7 -  Call SalTblSetRowFlags( hWndTabla,nFilaChild, ROW_MarkDeleted,FALSE)
.head 6 +  Else
.head 7 +  If SalTblQueryRowFlags( hWndTabla,nFilaChild,ROW_New)
.head 8 -  Call SalTblDeleteRow( hWndTabla, nFilaChild, TBL_Adjust )
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags( hWndTabla,nFilaChild, ROW_MarkDeleted,TRUE)
.head 6 -  Call SalTblSetFocusCell( hWndTabla, nFilaChild, hWndFila, 0, 1 )
.head 3 +  Pushbutton Class: pbChBuscarChiquito
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: F3
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\CENTURA\BITMAPS\PBITEMS.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pbChBaseChiquito
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Pushbutton Class: pbBase
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cFlatPushbutton
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 -  ! Estas son para las formas estandares
.head 3 +  Form Window Class: frmSoloNombre
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accesories Enabled? Yes
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? No
.head 5 -  Initial State: Normal
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:   
.head 6 -  Width:  6.825"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.146"
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 40
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Esta es un tipo de forma que sirve para trabajar con las tablas auxiliares
que solo contenga codigo y nombre, es decir para solo agregar los nombres
.head 4 -  Derived From
.head 4 +  Menu
.head 5 +  Popup Menu: Tablita
.head 6 -  Resource Id: 50175
.head 6 -  Enabled when:
.head 6 -  Status Text:
.head 6 -  Menu Item Name:
.head 6 +  Menu Item: (Inserta Fila)
.head 7 -  Resource Id: 57871
.head 7 -  Keyboard Accelerator: Ins
.head 7 -  Status Text:
.head 7 +  Menu Settings
.head 8 -  Enabled when:
.head 8 -  Checked when:
.head 7 +  Menu Actions
.head 8 -  Call SalSendMsg(pbAgregar,SAM_Click,0,0)
.head 7 -  Menu Item Name:
.head 6 +  Menu Item: (Marca para Borrar Fila)
.head 7 -  Resource Id: 50177
.head 7 -  Keyboard Accelerator: -
.head 7 -  Status Text:
.head 7 +  Menu Settings
.head 8 -  Enabled when:
.head 8 -  Checked when:
.head 7 +  Menu Actions
.head 8 -  Call SalSendMsg(pbBorrar,SAM_Click,0,0)
.head 7 -  Menu Item Name:
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: 0.677"
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 +  Contents
.head 6 +  ! Pushbutton: pb5
.winattr
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 24
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left: 4.088"
.head 8 -  Top:    0.073"
.head 8 -  Width:  0.8"
.head 8 -  Width Editable? Yes
.head 8 -  Height: 0.5"
.head 8 -  Height Editable? Yes
.head 7 -  Visible? Yes
.head 7 -  Keyboard Accelerator: (none)
.head 7 -  Font Name: Default
.head 7 -  Font Size: Default
.head 7 -  Font Enhancement: Default
.head 7 -  Picture File Name: C:\GUPTA\BITMAPS\PRINTER.ICO
.head 7 -  Picture Transparent Color: None
.head 7 -  Image Style: Single
.head 7 -  Text Color: Default
.head 7 -  Background Color: Default
.end
.head 7 +  Message Actions
.head 8 +  On SAM_Click
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  Call ArmarTabla()
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  ! If clsImpresora.Iniciare(DMORIENT_PORTRAIT,2800,3556)
.head 9 +  If ImprimirReporteSencillo(frmSoloNombre.sTitulos,"C:\\GUPTA\\PENAL\\REPORTES\\AXL_S.QRP",
			":n1,:s1","CODIGO,NOMBRE","select CODIGO,NOMBRE from AXL_TEMPORAL order by NOMBRE
			into :n1,:s1",frmSoloNombre.sObservaciones)
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  Return FALSE
.head 6 +  Pushbutton: pbAgregar
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 29
.head 7 -  Class: pbMas
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left: 0.188"
.head 8 -  Top:    0.073"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Enter
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set pbAgregar.nOpcionh=2
.head 9 -  Set pbAgregar.hWndFila=tbl1.colNombrer
.head 8 +  On SAM_Click
.head 9 -  Call SalTblSetFocusCell( hWndTabla, SalTblInsertRow( hWndTabla, TBL_MaxRow ), hWndFila, 0, 1 )
.head 9 -  Set tbl1.colCodigor=Identity(nNumeroTabla)
.head 9 -  Call SalStatusSetText(hWndForm,'                                                      ')
.head 6 +  Pushbutton: pbBorrar
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 30
.head 7 -  Class: pbMenos
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left: 1.388"
.head 8 -  Top:    0.073"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set pbBorrar.nOpcionh=2
.head 9 -  Set pbBorrar.hWndFila=tbl1.colNombrer
.head 6 +  Pushbutton: pbGrabar
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 34
.head 7 -  Class: pbGrabar
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left: 2.588"
.head 8 -  Top:    0.073"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 +  Message Actions
.head 8 +  On SAM_Create
.head 9 -  Set pbGrabar.nOpcion=2
.head 8 +  ! On SAM_Click
.head 9 +  If RevisarTablas(hWndTabla)
.head 10 +  If SalMessageBox("Desea Aplicar los Cambios","CONFIRMACION",MB_YesNo)=IDYES
.head 11 -  Call SalSendMsg(hWndForm,MU_GRABAR,0,0)
.head 11 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 11 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 11 -  Return TRUE
.head 6 +  Pushbutton: pbSalir
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 39
.head 7 -  Class: pbSalir
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title:
.head 7 -  Window Location and Size
.head 8 -  Left: 6.588"
.head 8 -  Top:    0.073"
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Height: Class Default
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Keyboard Accelerator: Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Picture File Name:
.head 7 -  Picture Transparent Color: Class Default
.head 7 -  Image Style: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  Message Actions
.head 4 +  Contents
.head 5 +  Child Table: tbl1
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 5
.head 6 -  Class: cFlatChildTable
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Display Settings
.head 7 -  Window Location and Size
.head 8 -  Left: 0.488"
.head 8 -  Top:    0.156"
.head 8 -  Width:  6.9"
.head 8 -  Width Editable? Class Default
.head 8 -  Height: 3.333"
.head 8 -  Height Editable? Class Default
.head 7 -  Visible? Class Default
.head 7 -  Font Name: Class Default
.head 7 -  Font Size: Class Default
.head 7 -  Font Enhancement: Class Default
.head 7 -  Text Color: Class Default
.head 7 -  Background Color: Class Default
.head 7 -  View: Class Default
.head 7 -  Allow Row Sizing? Class Default
.head 7 -  Lines Per Row: Class Default
.head 6 -  Memory Settings
.head 7 -  Maximum Rows in Memory: Class Default
.head 7 -  Discardable? Class Default
.head 6 +  Contents
.head 7 +  Column: colCodigor
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 25
.head 8 -  Class: clsNumero
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title:
.head 8 -  Visible? No
.head 8 -  Editable? No
.head 8 -  Maximum Data Length: Class Default
.head 8 -  Data Type: Class Default
.head 8 -  Justify: Class Default
.head 8 -  Width:  Class Default
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Class Default
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 -  Message Actions
.head 7 +  Column: colNombrer
.head 8 -  Class Child Ref Key: 0
.head 8 -  Class ChildKey: 26
.head 8 -  Class: clsDatos
.head 8 -  Property Template:
.head 8 -  Class DLL Name:
.head 8 -  Title:
.head 8 -  Visible? Class Default
.head 8 -  Editable? Class Default
.head 8 -  Maximum Data Length: 50
.head 8 -  Data Type: Class Default
.head 8 -  Justify: Class Default
.head 8 -  Width:  6.8"
.head 8 -  Width Editable? Class Default
.head 8 -  Format: Uppercase
.head 8 -  Country: Class Default
.head 8 -  Input Mask: Class Default
.head 8 -  Cell Options
.head 9 -  Cell Type? Class Default
.head 9 -  Multiline Cell? Class Default
.head 9 -  Cell DropDownList
.head 10 -  Sorted? Class Default
.head 10 -  Vertical Scroll? Class Default
.head 10 -  Auto Drop Down? Class Default
.head 10 -  Allow Text Editing? Class Default
.head 9 -  Cell CheckBox
.head 10 -  Check Value:
.head 10 -  Uncheck Value:
.head 10 -  Ignore Case? Class Default
.head 8 -  List Values
.head 8 +  Message Actions
.head 9 +  On SAM_Validate
.head 10 -  Call SalStatusSetText( hWndForm,"Verificando Unicidad de nombre ...... Por Favor espere")
.head 10 -  Call SalWaitCursor(TRUE)
.head 10 +  If Validar_Unico_EnTablitas(hWndTabla,2,sMensajes_Otros)
.head 11 -  Call SalStatusSetText( hWndForm,"                                                                                             ")
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Return TRUE
.head 10 +  Else
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalStatusSetText( hWndForm,"                                                                                             ")
.head 11 -  Return FALSE
.head 6 -  Functions
.head 6 -  Window Variables
.head 6 +  Message Actions
.head 7 +  On SAM_CreateComplete
.head 8 -  Set pbAgregar.hWndTabla=tbl1
.head 8 -  Set pbBorrar.hWndTabla=tbl1
.head 8 -  Set pbGrabar.hWndTabla=tbl1
.head 8 -  Call SalTblSetColumnTitle( tbl1.colNombrer,sTitulos)
.head 4 +  Class Variables
.head 5 -  Window Handle: hWndColumna
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  String: sImprimir
.head 5 -  String: sTitulos
.head 5 -  String: sMensajes_Otros
.head 5 -  Number: nNumeroTabla
.head 5 -  Window Handle: hWndTabla
.head 4 +  Functions
.head 5 +  Function: ArmarTabla
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: s11
.head 7 -  String: sConsulta
.head 7 -  Number: n11
.head 6 +  Actions
.head 7 -  Set sConsulta="select "||sCodigo||",NOMBRE from "||sTabla||" into :n11,:s11"
.head 7 -  Call SqlImmediate("delete from AXL_TEMPORAL")
.head 7 -  Call SqlClearImmediate( )
.head 7 -  Call SqlPrepareAndExecute(hSql1,sConsulta)
.head 7 +  While SqlFetchNext(hSql1,nSiguiente)
.head 8 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 8 -  Call SqlImmediate("insert into AXL_TEMPORAL(CODIGO,NOMBRE) values(:n11,:s11)")
.head 8 -  Call SqlClearImmediate( )
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblPopulate(hWndTabla,hSql6,"select "||sCodigo||","||sNombre||" from "||sTabla||" 
order by NOMBRE",TBL_FillAll)
.head 6 -  Call SqlPrepareAndExecute(hSql6,"commit")
.head 6 -  Call SalSendMsg(hWndTabla,SAM_CreateComplete,0,0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On MU_GRABAR
.head 6 -  Call SalSetFocus(hWndTabla)
.head 6 -  ! !!!!!!!!!!!!!!!!!!
.head 6 -  Call SqlPrepare(hSql1,"insert into "||sTabla||"("||sCodigo||","||sNombre||")
		values(:hWndTabla.colCodigor,:hWndTabla.colNombrer)")
.head 6 -  Call SalTblDoInserts( hWndTabla,hSql1,TRUE)
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  ! !!!!!!!!!!!!!!!!!!
.head 6 -  Call SqlPrepare(hSql1,"update "||sTabla||" set "||sNombre||"=:hWndTabla.colNombrer
			where "||sCodigo||"=:hWndTabla.colCodigor")
.head 6 -  Call SalTblDoUpdates( hWndTabla,hSql1,TRUE)
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  ! !!!!!!!!!!!!!!!!!!
.head 6 -  Call SqlPrepare(hSql1,"delete from "||sTabla||" where "||sCodigo||"=:hWndTabla.colCodigor")
.head 6 -  Call SalTblDoDeletes( hWndTabla, hSql1, ROW_MarkDeleted )
.head 6 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 6 -  ! !!!!!!!!!!!!!!!!!!
.head 6 -  Call SalStatusSetText(hWndForm,'Datos Actualizados')
.head 5 +  On MU_ACTUALIZAR
.head 6 -  Call SalSendMsg(hWndForm,SAM_CreateComplete,0,0)
.head 5 +  On SAM_Destroy
.head 6 -  Call SalBringWindowToTop( hWndForm)
.head 3 +  List Box Class: clsList
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  3.288"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.813"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 4 +  Functions
.head 5 +  Function: Actualizar
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call SalListClear(MyValue)
.head 7 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Call SalWaitCursor(FALSE)
.head 5 +  Function: Leer_ListBox
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  ! Window Handle: lbGenerico
.head 7 -  String: sTablaVarias
.head 7 -  String: sTablaAxl
.head 7 -  String: sCodigoVarias
.head 7 -  String: sCodigoAxl
.head 7 -  Number: nUnicoValor
.head 7 -  String: sUnicoValor
.head 7 -  Receive Sql Handle: hSqlInsertar
.head 7 -  Number: nCaso
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nBuscando
.head 7 -  Number: nActual
.head 7 -  Number: nEntradas
.head 7 -  String: sBuscar
.head 7 -  String: sBuscar2
.head 7 -  Window Handle: lbGenerico
.head 6 +  Actions
.head 7 -  Set lbGenerico=hWndItem
.head 7 +  Select Case nCaso
.head 8 +  Case 1	! este es para el caso que sean Entero,Entero
.head 9 +  If not SqlPrepareAndExecute(hSqlInsertar,"select "||sCodigoAxl||" from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor into :nBuscando")
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 9 +  While SqlFetchNext(hSqlInsertar,nSiguiente)
.head 10 -  Call SqlPrepareAndExecute(hSqlInsertar,"commit")
.head 10 +  If not SqlImmediate("select NOMBRE  from "||sTablaAxl||" where "||sCodigoAxl||"=:nBuscando into :sBuscar")
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 10 -  Call SqlClearImmediate( )
.head 10 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 10 -  Set nActual=0
.head 10 +  While nActual<nEntradas
.head 11 +  If not SalListQueryState( lbGenerico, nActual )
.head 12 -  Set sBuscar2=SalListQueryTextX( lbGenerico,nActual)
.head 11 +  Else
.head 12 -  ! Call SalListSetSelect( lbGenerico, nActual)
.head 12 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 11 +  If sBuscar2=sBuscar
.head 12 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 11 -  Set nActual=nActual+1
.head 9 -  Return TRUE
.head 9 -  Break
.head 8 +  Case 2		! este es para el caso que sean Entero,Caracter
.head 9 +  If not SqlPrepareAndExecute(hSqlInsertar,"select "||sCodigoAxl||" from "||sTablaVarias||"
		where "||sCodigoVarias||"=:sUnicoValor into :nBuscando")
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 9 +  While SqlFetchNext(hSqlInsertar,nSiguiente)
.head 10 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 10 +  If not SqlImmediate("select NOMBRE  from "||sTablaAxl||" where "||sCodigoAxl||"=:nBuscando into :sBuscar")
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 11 -  Return FALSE
.head 10 -  Call SqlClearImmediate( )
.head 10 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 10 -  Set nActual=0
.head 10 +  While nActual<nEntradas
.head 11 +  If not SalListQueryState( lbGenerico, nActual )
.head 12 -  Set sBuscar2=SalListQueryTextX( lbGenerico,nActual)
.head 11 +  Else
.head 12 -  ! Call SalListSetSelect( lbGenerico, nActual)
.head 12 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 11 +  If sBuscar2=sBuscar
.head 12 -  Call SalListSetMultiSelect( lbGenerico, nActual,TRUE)
.head 11 -  Set nActual=nActual+1
.head 9 -  Return TRUE
.head 9 -  Break
.head 5 +  Function: Actualizar_ListBox
.head 6 -  Description: Actualiza una tabla que sea de tipo N-->N
	Ejemplo:
	
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  ! Window Handle: lbGenerico
.head 7 -  String: sTablaVarias
.head 7 -  String: sTablaAxl
.head 7 -  String: sCodigoVarias
.head 7 -  String: sCodigoAxl
.head 7 -  Number: nUnicoValor
.head 7 -  String: sUnicoValor
.head 7 -  Receive Sql Handle: hSqlInsertar
.head 7 -  Number: nCaso
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nActual
.head 7 -  Number: nEntradas
.head 7 -  Number: nCod
.head 7 -  String: sBuscar
.head 7 -  Window Handle: lbGenerico
.head 6 +  Actions
.head 7 -  Set lbGenerico=hWndItem
.head 7 +  Select Case nCaso
.head 8 +  Case 1	! este es para el caso que sean Entero,Entero
.head 9 +  If SqlExists("select * from "||sTablaVarias||" where "||sCodigoVarias||"=:nUnicoValor",bExists)
.head 10 -  Call SqlClearImmediate( )
.head 10 +  If bExists
.head 11 +  If not SqlPrepareAndExecute(hSqlInsertar,"delete from "||sTablaVarias||"
		where "||sCodigoVarias||"=:nUnicoValor")
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 12 -  Return FALSE
.head 10 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 10 -  Set nActual=0
.head 10 +  While nActual<nEntradas
.head 11 +  If SalListQueryState( lbGenerico, nActual )
.head 12 -  Set sBuscar=SalListQueryTextX( lbGenerico,nActual)
.head 12 +  If not SqlImmediate("select "||sCodigoAxl||" from "||sTablaAxl||" where NOMBRE=:sBuscar into :nCod")
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 13 -  Return FALSE
.head 12 -  Call SqlClearImmediate( )
.head 12 +  If not SqlPrepareAndExecute(hSqlInsertar,"insert into "||sTablaVarias||
		"("||sCodigoVarias||","||sCodigoAxl||")"||
		"values(:nUnicoValor,:nCod)")
		
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call SalMessageBox("No se pudo grabar informacion en tabla de varias","ERROR",MB_Ok)
.head 13 -  Return FALSE
.head 12 -  Call SqlPrepareAndExecute(hSqlInsertar,"commit")
.head 11 -  Set nActual=nActual+1
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo sacar la información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 9 -  Break
.head 8 +  Case 2	! este es para el caso que sean Entero,Caracter
.head 9 +  If SqlExists("select * from "||sTablaVarias||" where "||sCodigoVarias||"=:sUnicoValor",bExists)
.head 10 -  Call SqlClearImmediate( )
.head 10 +  If bExists
.head 11 +  If not SqlPrepareAndExecute(hSqlInsertar,"delete from "||sTablaVarias||"
		where "||sCodigoVarias||"=:sUnicoValor")
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call SalMessageBox("No se pudo borrar cierta información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 12 -  Return FALSE
.head 11 -  Call SqlPrepareAndExecute(hSqlInsertar,"commit")
.head 10 -  Set nEntradas=SalListQueryCount(lbGenerico )
.head 10 -  Set nActual=0
.head 10 +  While nActual<nEntradas
.head 11 +  If SalListQueryState( lbGenerico, nActual )
.head 12 -  Set sBuscar=SalListQueryTextX( lbGenerico,nActual)
.head 12 +  If not SqlImmediate("select "||sCodigoAxl||" from "||sTablaAxl||" where NOMBRE=:sBuscar into :nCod")
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call SalMessageBox("No se pudo sacar la información de la tabla sencilla","ERROR",MB_Ok)
.head 13 -  Return FALSE
.head 12 -  Call SqlClearImmediate( )
.head 12 +  If not SqlPrepareAndExecute(hSqlInsertar,"insert into "||sTablaVarias||
		"("||sCodigoVarias||","||sCodigoAxl||")"||
		"values(:sUnicoValor,:nCod)")
		
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call SalMessageBox("No se pudo grabar informacion en tabla de varias","ERROR",MB_Ok)
.head 13 -  Return FALSE
.head 12 -  Call SqlPrepareAndExecute(hSqlInsertar,"commit")
.head 11 -  Set nActual=nActual+1
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call SalMessageBox("No se pudo sacar la información de la tabla de "||sTablaVarias,"ERROR",MB_Ok)
.head 10 -  Return FALSE
.head 9 -  Break
.head 5 +  Function: HaySeleccionadosListBox
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  ! Window Handle: lbGenerico
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nActual
.head 7 -  Number: nEntradas
.head 7 -  Window Handle: lbGenerico
.head 6 +  Actions
.head 7 -  Set lbGenerico=hWndItem
.head 7 -  Set nEntradas=SalListQueryCount(lbGenerico)
.head 7 -  Set nActual=0
.head 7 +  While nActual<nEntradas
.head 8 +  If SalListQueryState( lbGenerico, nActual )
.head 9 -  Return TRUE
.head 8 -  Set nActual=nActual+1
.head 7 -  Return FALSE
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Combo Box Class: cmbBaseCodigo
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:   
.head 5 -  Width:  2.071"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.938"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description: Clase generica usada para combo box  incluye ambos NUMERICOS Y CARACTER, esto se
hace inicializando el valor del nCaso de la siguiente forma
Este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER

Se debe de inicializar en el SAM_Create lo siguiente:
sTabla: el nombre de la tabla (AXL_DEPTOS)
sNombre: nombre del campo de la tabla de tipo string con el que deseo popular
	esa tabla (NOMBRE)
sCodigo: nombre del campo de la tabla de donde voy a extraer el valor del codigo (COD_DEPTO)

Los valores se almacenarán en, dependiendo de si son NUMEROS ó CARACTERES
nCodigo	NUMERICOS
sCodigos	CARACTER

NOTA: EL nCaso no es necesario inicializarlo cuando es numerico
.head 4 +  Derived From
.head 5 -  Class: cFlatComboBox
.head 4 +  Class Variables
.head 5 -  String: sComboActual
.head 5 -  Number: nTerp
.head 5 -  String: sTerp
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  !
.head 5 -  ! este caso que se agrega a continuación es para aquellos combox box, que los codigos a extraer
no solo son NUMERICOS, sino tambien CARACTER,
1 es NUMERICO, 2 es CARACTER
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 5 -  !
.head 4 +  Functions
.head 5 +  Function: Actualizar
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nCaso=1	! es numerico
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 +  Else ! es caracter
.head 8 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 8 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  !
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla||" order by "||sNombre)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  ! On MU_ACTUALIZAR
.head 6 +  If nCaso=1	! es numerico
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 +  Else ! es caracter
.head 7 -  ! Call SalListPopulate(hWndItem,hSql1,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos")
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :MyValue")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 6 -  !
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  !
.head 7 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 8 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 8 -  Call SalSetFocus(hWndItem)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  On SAM_Click
.head 6 -  ! aqui es para NUMERICOS
.head 6 +  If nCaso=1
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombre||"=:MyValue into :nTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set nCodigo=nTerp
.head 6 -  ! aqui es para CARACTER
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombre||"=:MyValue into :sTerp")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 7 -  Set sCodigos=sTerp
.head 6 -  Call SalSendMsg(hWndItem,SAM_Validate,0,0)
.head 3 +  Column Class: clsCbCodigo
.head 4 -  Title:
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: 400
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Left
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description: esta es una columna tipo combo box, usada para todas las table window,
como sabemos no puede procesar el mensaje de SAM_Click, dado que es columna,
por lo que en el SAM_Validate, efectuó la valdación de las columnas,

La documentación completa de esta clase, puede leerse en esta misma libreria, en la
parte de combo box
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  Number: nTerp
.head 5 -  String: sComboActual
.head 5 -  String: sTerp
.head 4 +  Instance Variables
.head 5 -  String: sTabla
.head 5 -  String: sNombre
.head 5 -  String: sCodigo
.head 5 -  !
.head 5 -  Number: nCaso
.head 5 -  !
.head 5 -  Number: nCodigo
.head 5 -  String: sCodigos
.head 4 -  Functions
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DropDown
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If MyValue!=''
.head 7 -  Set sComboActual=MyValue
.head 6 -  !
.head 6 -  Call SalListClear(MyValue)
.head 6 -  Call SalListPopulate(MyValue,hSql5,"select "||sNombre||" from "||sTabla)
.head 6 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 6 +  If sComboActual!=''
.head 7 -  Call SalListSelectString( hWndItem, -1,sComboActual)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On MU_ACTUALIZAR
.head 6 +  If nCaso=1	! es numerico
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:nCodigo"||"  into	:hWndItem")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 +  Else ! es caracter
.head 7 -  Call SqlPrepareAndExecute(hSql5,"select "||sNombre||" from "||sTabla||"
		where	"||sCodigo||"=:sCodigos"||"  into :hWndItem")
.head 7 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 7 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 6 -  !
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 +  If not SalIsNull(hWndItem)
.head 7 -  !
.head 7 +  If SalListSelectString(hWndItem,-1,MyValue)=LB_Err
.head 8 -  Call SalMessageBox("Dato no existe en la lista","ERROR",MB_Ok)
.head 8 -  Call SalSetFocus(hWndItem)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  ! aqui es para NUMERICOS
.head 8 +  If nCaso=1
.head 9 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombre||"=:MyValue into :nTerp")
.head 9 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 9 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 9 -  Set nCodigo=nTerp
.head 8 -  ! aqui es para CARACTER
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute(hSql5,"select "||sCodigo||" from "||sTabla||" where "||sNombre||"=:MyValue into :sTerp")
.head 9 -  Call SqlFetchNext(hSql5,nSiguiente)
.head 9 -  Call SqlPrepareAndExecute(hSql5,"commit")
.head 9 -  Set sCodigos=sTerp
.head 8 -  Return TRUE
.head 3 +  Functional Class: lcConfiguration
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: LoadConfiguration
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalFileGetCurrentDirectory( strIniPath )
.head 7 -  Set strIniPath = strIniPath || "\\SGH_Configuracion.ini"
.head 7 -  Call SalUseRegistry( FALSE, "" )
.head 7 +  If SalGetProfileString( "Reportes", "Path", "", strRepPath, strIniPath ) = 0
.head 8 -  Call SalMessageBox( "Error al cargar las opciones de Reportes en el archivo " || strIniPath, "ERROR", MB_Ok )
.head 8 -  Call SalQuit()
.head 7 +  If SalGetProfileString( "Ciudad", "Nombre", "", strCiudad, strIniPath ) = 0
.head 8 -  Call SalMessageBox( "Error al cargar la opcion de Ciudad en el archivo " || strIniPath, "Advertencia", MB_Ok )
.head 8 -  Call SalQuit()
.head 7 +  If SalGetProfileString( "LabODBC", "DataSourceName", "", strODBCLab, strIniPath ) = 0
.head 8 -  Call SalMessageBox( "Error al cargar la opcion de LabODBC en el archivo " || strIniPath, "Advertencia", MB_Ok )
.head 8 -  Call SalQuit()
.head 7 +  If SalGetProfileString( "DataSource", "Name", "", sGlobalDB, strIniPath ) = 0
.head 8 -  Call SalMessageBox( "Error al cargar la opcion de DataSource en el archivo " || strIniPath, "Advertencia", MB_Ok )
.head 8 -  Call SalQuit()
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field: cQuickMLField
.head 3 -  Pushbutton: pbChAgregarChiquito
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  ActiveX:
.head 3 -  Check Box:
.head 3 -  Child Table: cQuickTable
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cQuickGraph
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 1 +  Dialog Box: dlgLogin
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Entrada al Sistema
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left: 1.525"
.head 4 -  Top:    0.917"
.head 4 -  Width:  4.563"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.896"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: White
.head 2 -  Description: Standard Login screen.
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Usuario
.head 4 -  Resource Id: 4533
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.525"
.head 5 -  Top:    1.0"
.head 5 -  Width:  1.363"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfUserId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFlatDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.975"
.head 6 -  Top:    0.979"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Clave
.head 4 -  Resource Id: 4534
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.5"
.head 5 -  Top:    1.271"
.head 5 -  Width:  1.388"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Black
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfPassword
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cFlatDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.975"
.head 6 -  Top:    1.25"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Invisible
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalStrUpperX( dfPassword)
.head 3 +  Pushbutton: pbAceptar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Aceptar
.head 4 -  Window Location and Size
.head 5 -  Left: 1.488"
.head 5 -  Top:    1.656"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\22x22\apply.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: White
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsNull ( dfUserId )
.head 7 -  Call SalMessageBox ('Introduzca el nombre del usuario', "ERROR",MB_Ok | MB_IconHand )
.head 7 -  Call SalSetFocus ( dfUserId )
.head 7 -  Return FALSE
.head 6 +  If SalIsNull ( dfPassword )
.head 7 -  Call SalMessageBox ('Introduzca la contrasena',"ERROR", MB_Ok | MB_IconHand )
.head 7 -  Call SalSetFocus ( dfPassword )
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Set SqlDatabase = dfDatabase
.head 6 -  Set SqlUser = 'sa'
.head 6 -  Set SqlPassword = 'asaber'
.head 6 -  ! Set SqlDatabase = dfDatabase
.head 6 -  ! Set SqlUser = dfUserId
.head 6 -  ! Set SqlPassword = dfPassword
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SalStatusSetText ( hWndForm, 'Conectandose a la Base de Datos ==> ' || dfDatabase || '...' )
.head 6 +  If ConectarCursores(hSql1) and ConectarCursores(hSql2) and
ConectarCursores(hSql3) and ConectarCursores(hSql4) and
ConectarCursores(hSql5) and ConectarCursores(hSql6)
.head 7 +  If EsUsuario(dfUserId,dfPassword,nUsuario)
.head 8 -  Set bMeConecte=TRUE
.head 8 -  Set sNombreUsuario=dfUserId
.head 8 -  Call SqlGetParameter( hSql1, DBP_BRAND, nBaseEs,sVersion)
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  Call SalEndDialog( hWndForm, TRUE )
.head 7 +  Else
.head 8 -  Call SalMessageBox("No existe tal Usuario","ERROR",MB_Ok)
.head 8 -  Call SalWaitCursor( FALSE )
.head 3 +  Pushbutton: pbCancelar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbBase
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Cancelar
.head 4 -  Window Location and Size
.head 5 -  Left: 2.388"
.head 5 -  Top:    1.656"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\22x22\cancel.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: 3D Highlight Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 -  Background Text: &Database:
.head 4 -  Resource Id: 4535
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.829"
.head 5 -  Top:    0.512"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfDatabase
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.986"
.head 6 -  Top:    0.488"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfDatabase=sDatabaseMandan
.head 3 -  Frame
.head 4 -  Resource Id: 39373
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top:    0.073"
.head 5 -  Width:  4.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 8
.head 4 -  Border Color: Dark Green
.head 4 -  Background Color: White
.head 3 -  Line
.head 4 -  Resource Id: 59057
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.388"
.head 5 -  Begin Y:  1.573"
.head 5 -  End X:  4.188"
.head 5 -  End Y:  1.573"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Dark Green
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.388"
.head 5 -  Top:    0.24"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: C:\Centura\BITMAPS\LOGO_FINAL_BETESDA_S.bmp
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sDatabaseMandan
.head 2 +  Window Variables
.head 3 -  String: sVersion
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalSetFocus(dfUserId)
.head 4 -  Set bMeConecte=0
.head 3 +  On SAM_Help
.head 4 -  Call SalWinHelp( hWndForm,'c:\\centura\\chsa\\ayuda\\contrato.hlp',
	HELP_Key,0,'login' )
.head 1 +  Form Window: frmImprimir
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ventana de Reportes
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: 0.0"
.head 4 -  Top:    0.75"
.head 4 -  Width:  7.125"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.563"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: System Text Color
.head 3 -  Background Color: System Window Color
.head 2 -  Description: la funcion para imprimir debe recibir lo que se explica aqui: 
1) el título del reporte
2) el nombre del reporte(*.qrp) 
3) el nombre de las bind variables :s1,:n1
4) el nombre de los campos select nombre,edad ,...
5) el comando a ejecutar (SELECT)
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: &Reporte
.head 4 -  Resource Id: 4537
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Primera Página
.head 5 -  Resource Id: 4538
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdFirstPage)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Ultima página
.head 5 -  Resource Id: 4539
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdLastPage)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Siguiente página
.head 5 -  Resource Id: 4540
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdNextPage)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Página &Anterior
.head 5 -  Resource Id: 4541
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdPrevPage)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Ir a página...
.head 5 -  Resource Id: 4542
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdGoToPage)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Cerrar Reporte
.head 5 -  Resource Id: 4543
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportClose(hWndForm)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Menu Item Name:
.head 3 +  Popup Menu: &Impresión
.head 4 -  Resource Id: 4544
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Imprimir
.head 5 -  Resource Id: 4545
.head 5 -  Keyboard Accelerator: Ctrl+P
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdPrint)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Configurar impresora
.head 5 -  Resource Id: 4546
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalReportCmd(hWndForm, RPT_CmdPrinterSetup)
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.49"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 7.188"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 -  Contents
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sTituloListado	
.head 3 -  String: sReporte		
.head 3 -  String: sVarsEnlace	
.head 3 -  String: sVarsEntrada	
.head 3 -  String: sCmdSelect	
.head 3 -  String: sObservaciones
.head 3 -  Boolean: bPrint
.head 2 +  Window Variables
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 3 -  String: s5
.head 3 -  String: s6
.head 3 -  String: s7
.head 3 -  String: s8
.head 3 -  String: s9
.head 3 -  String: s10
.head 3 -  String: s11
.head 3 -  String: s12
.head 3 -  String: s13
.head 3 -  String: s14
.head 3 -  String: s15
.head 3 -  String: s16
.head 3 -  String: s17
.head 3 -  String: s18
.head 3 -  String: s19
.head 3 -  String: s20
.head 3 -  String: s21
.head 3 -  !
.head 3 -  Number: n1
.head 3 -  Number: n2
.head 3 -  Number: n3
.head 3 -  Number: n4
.head 3 -  Number: n5
.head 3 -  Number: n6
.head 3 -  Number: n7
.head 3 -  Number: n8
.head 3 -  Number: n9
.head 3 -  Number: n10
.head 3 -  Number: n11
.head 3 -  Number: n12
.head 3 -  Number: n13
.head 3 -  Number: n14
.head 3 -  Number: n15
.head 3 -  Number: n16
.head 3 -  Number: n17
.head 3 -  Number: n18
.head 3 -  Number: n19
.head 3 -  Number: n20
.head 3 -  Number: n21
.head 3 -  Number: n22
.head 3 -  Number: n23
.head 3 -  Number: n24
.head 3 -  Number: n25
.head 3 -  Number: n26
.head 3 -  Number: n27
.head 3 -  Number: n28
.head 3 -  Number: n29
.head 3 -  Number: n30
.head 3 -  Number: n31
.head 3 -  Number: n32
.head 3 -  Number: n33
.head 3 -  Number: n34
.head 3 -  Number: n35
.head 3 -  Number: n36
.head 3 -  Number: n37
.head 3 -  Number: n38
.head 3 -  Number: n39
.head 3 -  Number: n40
.head 3 -  Number: n41
.head 3 -  Number: n42
.head 3 -  Number: n43
.head 3 -  Number: n44
.head 3 -  Number: n45
.head 3 -  Number: n46
.head 3 -  Number: n47
.head 3 -  Number: n48
.head 3 -  Number: n49
.head 3 -  Number: n50
.head 3 -  Number: n51
.head 3 -  Number: n52
.head 3 -  Number: n53
.head 3 -  Number: n54
.head 3 -  Number: n55
.head 3 -  Number: n56
.head 3 -  Number: n57
.head 3 -  Number: n58
.head 3 -  Number: n59
.head 3 -  Number: n60
.head 3 -  !
.head 3 -  Date/Time: dt1
.head 3 -  Date/Time: dt2
.head 3 -  Date/Time: dt3
.head 3 -  Date/Time: dt4
.head 3 -  Date/Time: dt5
.head 3 -  Date/Time: dt6
.head 3 -  Date/Time: dt7
.head 3 -  !
.head 3 -  Long String: ls1
.head 3 -  Long String: ls2
.head 3 -  Long String: ls3
.head 3 -  Long String: ls4
.head 3 -  Long String: ls5
.head 3 -  Long String: ls6
.head 3 -  !
.head 3 -  Number: nError
.head 3 -  Boolean: bBien
.head 3 -  Sql Handle: hSqlReport
.head 3 -  Window Handle: hWndReporte
.head 3 -  !
.head 3 -  String: sDispositivo
.head 3 -  String: sDriver
.head 3 -  String: sPuerto
.head 3 -  !
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SqlConnect( hSqlReport )
.head 4 -  ! Call SalMessageBox(sVarsEnlace,sVarsEnlace,MB_Ok)
.head 4 -  ! Call SalMessageBox(sVarsEntrada,sVarsEntrada,MB_Ok)
.head 4 -  ! Call SqlSetParameter( hSqlReport, DBP_PRESERVE, TRUE, '' )
.head 4 -  ! Call SqlSetIsolationLevel( hSqlReport, 'RO' )
.head 4 -  ! Call SqlSetResultSet( hSqlReport, TRUE )
.head 4 -  Set bBien=TRUE
.head 4 -  !
.head 4 -  ! aqui estoy haciendo la pantalla que despliega el reporte en modo previo, y guardo en una variable de tipo
handle, el "handle" de este reporte, para luego utilizar al:
1) Utilizarlo al momento de querer inicializar cualquier variable que envio al reporte
2) Utilizarlo en la funcion de SalReportDlgOptions
.head 4 -  !
.head 4 +  If bPrint
.head 5 -  !
.head 5 -  Call SalReportPrint( frmImprimir, sReporte, sVarsEnlace, sVarsEntrada, 1, RPT_PrintAll, 0, 0, nError )
.head 4 +  Else
.head 5 -  !
.head 5 -  Set hWndReporte=SalReportView( frmImprimir,frmImprimir, sReporte,sVarsEnlace, sVarsEntrada, nError )
.head 4 -  !
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  !
.head 4 -  ! ahora proceso los diferentes errores que me retorna en el nError
.head 4 -  !
.head 4 +  If nError = RPT_ErrFileOpen
.head 5 -  Call SalMessageBox( 'No se pudo encontrar la plantilla: ' ||sReporte, sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 +  If nError = RPT_ErrMaxRpts
.head 5 -  Call SalMessageBox( 'El número de reportes ha llegado al máximo!  ', sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 +  If nError = RPT_ErrRptOpen
.head 5 -  Call SalMessageBox( 'El reporte no se pudo abrir para impresión.', sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 +  If nError = RPT_ErrRptWindow
.head 5 -  Call SalMessageBox( 'No se pudo abrir la ventana de reportes. ', sTituloListado,MB_Ok|MB_IconQuestion )
.head 5 -  Set bBien=FALSE
.head 4 -  !
.head 4 -  ! si hubo algún de estos errores entonces no se podrá imprimir nada, por lo que termino
.head 4 -  !
.head 4 +  If NOT bBien
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 3 +  On SAM_ReportStart
.head 4 -  !
.head 4 -  ! aqui estoy obteniendo el handle de esa ventana, para luego utilizarlo al momento de querer inicializar
cualquier variable que envio al reporte
.head 4 -  !
.head 4 -  !
.head 4 -  ! aqui estoy inicializando las opciones de la pantalla que aparecerá al momento de la impresion
.head 4 -  !
.head 4 -  Call SalReportDlgOptions( hWndReporte,sTituloListado, sReporte, 'Se está imprimiendo...',sTituloListado )
.head 4 -  Call SalPrtSetup( sDispositivo, sDriver, sPuerto, FALSE )
.head 3 +  On SAM_ReportFetchInit
.head 4 -  Call SalReportSetStringVar( hWndReporte, 'sTitulo', sTituloListado )
.head 4 -  Call SalReportSetStringVar( hWndReporte, 'sObservaciones', sObservaciones )
.head 4 -  ! ROGGER: Agregue esta linea para no bloquear por reportes algunas otras pantallas
.head 4 -  Call SqlPrepareAndExecute(hSqlReport,"set transaction isolation level 0")
.head 4 +  If NOT SqlPrepare( hSqlReport, sCmdSelect )
.head 5 -  Return FALSE
.head 4 +  Else
.head 5 +  If NOT SqlExecute( hSqlReport )
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  Return TRUE
.head 3 +  On SAM_ReportFetchNext
.head 4 +  If SqlFetchNext( hSqlReport, nSiguiente )
.head 5 -  Return TRUE
.head 4 +  Else
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_Destroy
.head 4 -  ! ROGGER: Restaurar el Isolation level a 1, aunque no es necesario ya que se desconectara
.head 4 -  Call SqlPrepareAndExecute(hSqlReport,"set transaction isolation level 1")
.head 4 -  Call SqlDisconnect( hSqlReport )
.head 4 -  Call SalBringWindowToTop( hWndForm )
.head 1 +  Form Window: frmUsuarios
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Mantenimiento de Nuevos Usuarios
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.1"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.417"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 +  Menu
.head 3 +  Popup Menu: Tablita
.head 4 -  Resource Id: 31747
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: (Inserta Fila)
.head 5 -  Resource Id: 31748
.head 5 -  Keyboard Accelerator: Ins
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(pbAgregar,SAM_Click,0,0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: (Marca para Borrar Fila)
.head 5 -  Resource Id: 31749
.head 5 -  Keyboard Accelerator: -
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(pbBorrar,SAM_Click,0,0)
.head 5 -  Menu Item Name:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.656"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Charcoal
.head 3 +  Contents
.head 4 +  ! pbMas: pb2
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMas
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.688"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: C:\CENTURA\BITMAPS\ICONS\PLUS.ICO
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set pb2.hWndTabla=tbl1
.head 7 -  Set pb2.hWndFila=tbl1.colUsuario
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 7 -  Set tbl1.colCodUsuario=Identity(1)
.head 4 +  ! pbMenos: pb6
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbMenos
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.488"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F3
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: C:\CENTURA\BITMAPS\ICONS\MINUS.ICO
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Set pb6.hWndTabla=tbl1
.head 4 +  Pushbutton: pb4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbGrabar
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.088"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.5"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: C:\Centura\BITMAPS\MyIcons\OSIcons\bmp\filesave.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pb4.nOpcion=2
.head 7 -  Set pb4.hWndTabla=tbl1
.head 4 +  Pushbutton: pb7
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 6.988"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.688"
.head 6 -  Top:    0.406"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colCodUsuario
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsNumero
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On MU_REVISAR
.head 8 -  Return TRUE
.head 5 +  Column: colUsuario
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nombre Usuario
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 8
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.575"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Call SalTblQueryFocus( tbl1,nFila,tbl1.colUsuario )
.head 8 +  If NOT RevisarUsuarios(nFila,tbl1.colUsuario)
.head 9 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 5 +  Column: colContrasena
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Contrasena
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 8
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.663"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_Validate
.head 8 +  If tbl1.colContrasena!=tbl1.colReintento
.head 9 -  Call SalMessageBox("La verificacion y la contraseña deben ser iguales","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 +  Else 
.head 9 -  Return TRUE
.head 5 +  Column: colReintento
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: clsDatos
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Verificacion de Contrasena
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.263"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_Validate
.head 8 +  If tbl1.colContrasena!=tbl1.colReintento
.head 9 -  Call SalMessageBox("La verificacion y la contraseña deben ser iguales","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 +  Else 
.head 9 -  Return TRUE
.head 7 +  On MU_REVISAR
.head 8 -  Return TRUE
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbAgregar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChAgregarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top:    0.396"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbAgregar.hWndFila=tbl1.colUsuario
.head 6 -  Set pbAgregar.hWndTabla=tbl1
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click,0,0)
.head 6 -  ! Call SalTblQueryFocus(tbl1,nFila,tbl1.colUsuario)
.head 6 -  ! Call SalTblSetContext(tbl1,nFila)
.head 6 -  Set tbl1.colCodUsuario=Identity(1)
.head 3 +  Pushbutton: pbBorrar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pbChBorrarChiquito
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top:    0.729"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbBorrar.hWndFila=tbl1.colUsuario
.head 6 -  Set pbBorrar.hWndTabla=tbl1
.head 2 +  Functions
.head 3 +  Function: RevisarUsuarios
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nFila
.head 5 -  String: sActual
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFilita
.head 4 +  Actions
.head 5 -  Set nFilita=-1
.head 5 +  While SalTblFindNextRow(tbl1,nFilita,0,0)
.head 6 -  Call SalTblSetContext( tbl1,nFilita)
.head 6 +  Select Case nBaseEs
.head 7 +  Case 1
.head 8 +  If tbl1.colUsuario='SYSADM'
.head 9 -  Call SalMessageBox("Nombre de Usuario no puede ser el mismo que el del Administrador","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 -  Break
.head 7 +  Case 31
.head 8 +  If tbl1.colUsuario='sa' or tbl1.colUsuario='SA'
.head 9 -  Call SalMessageBox("Nombre de Usuario no puede ser el mismo que el del Administrador","ERROR",MB_Ok)
.head 9 -  Return FALSE
.head 8 -  Break
.head 6 +  If nFilita!=nFila
.head 7 +  If tbl1.colUsuario=sActual
.head 8 -  Call SalMessageBox("Nombre de Usuario ya existe, debe de introducir otro nombre","ERROR",MB_Ok)
.head 8 -  Return FALSE
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sInsert
.head 3 -  Sql Handle: hSqlCambiar
.head 3 -  String: sUpdate
.head 3 -  String: sDelete
.head 3 -  String: sSelect
.head 3 -  String: sDba
.head 3 -  Number: nFila
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sInsert="insert into USUARIOS(COD_USU,NOMBRE,CONTRASE)
	values(:tbl1.colCodUsuario,:tbl1.colUsuario,:tbl1.colContrasena)"
.head 4 -  Set sUpdate="update USUARIOS	set	NOMBRE=:tbl1.colUsuario,
					CONTRASE=:tbl1.colContrasena
				where	COD_USU=:tbl1.colCodUsuario"
.head 4 -  Set sDelete="delete from  USUARIOS where COD_USU=:tbl1.colCodUsuario"
.head 4 -  Set sSelect="select COD_USU,NOMBRE,CONTRASE,CONTRASE
		from	USUARIOS
		where	NOMBRE<> 'sa' and nombre <> 'sysadm'"
.head 4 +  ! Select Case nBaseEs
.head 5 +  Case 31
.head 6 -  Set sSelect=sSelect||"sa'"
.head 6 -  Break 
.head 5 +  Case 1
.head 6 -  Set sSelect=sSelect||" 'SYSADM'"
.head 6 -  Break 
.head 3 +  On MU_GRABAR
.head 4 -  !
.head 4 -  Call SqlPrepare( hSql1,sDelete )
.head 4 -  Call SalTblDoDeletes( tbl1, hSql1, ROW_MarkDeleted )
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SqlPrepare( hSql1,sInsert )
.head 4 -  Call SalTblDoInserts( tbl1, hSql1, TRUE )
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SqlPrepare( hSql1,sUpdate )
.head 4 -  Call SalTblDoUpdates( tbl1, hSql1, TRUE )
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  !
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg(hWndForm,MU_ACTUALIZAR,0,0)
.head 3 +  On MU_ACTUALIZAR
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  !
.head 4 -  Call SalTblPopulate(tbl1,hSql1,sSelect,TBL_FillAll)
.head 4 -  Call SqlPrepareAndExecute(hSql1,"commit")
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Dialog Box: dlgError
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ventana de Captura de Mensajes de Errores
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left: 0.0"
.head 4 -  Top:    0.031"
.head 4 -  Width:  7.963"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.31"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.75"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbGrabarArchivo
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: &Copiar a Archivo
.head 5 -  Window Location and Size
.head 6 -  Left: 0.283"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: C:\Centura\BITMAPS\ICONS\DEV2000\Save.ico
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbGrabarPorta
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Copiar a &Portapapeles
.head 5 -  Window Location and Size
.head 6 -  Left: 1.983"
.head 6 -  Top:    0.155"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: C:\Centura\BITMAPS\Checklis.ico
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pb3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: pbSalir
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 6.488"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 -  Background Text: Número
.head 4 -  Resource Id: 30152
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top:    0.345"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfError
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.588"
.head 6 -  Top:    0.321"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #0
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Descripción
.head 4 -  Resource Id: 30153
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top:    0.762"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Error
.head 4 -  Resource Id: 30154
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top:    0.073"
.head 5 -  Width:  7.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlDescripcion
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30000
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 1.588"
.head 6 -  Top:    0.823"
.head 6 -  Width:  6.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Razon
.head 4 -  Resource Id: 30155
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.45"
.head 5 -  Top:    1.952"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlRazon
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 30000
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 1.75"
.head 6 -  Top:    1.929"
.head 6 -  Width:  7.233"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.976"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Por favor anote el número y descripción del error e informe al administrador
.head 4 -  Resource Id: 30156
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top:    2.677"
.head 5 -  Width:  7.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nError
.head 3 -  String: sCadena
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set dfError=nError
.head 4 -  Set mlDescripcion=sCadena
